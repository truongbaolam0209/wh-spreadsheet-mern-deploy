[{"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\index.js":"1","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\App.js":"2","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\reportWebVitals.js":"3","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\contexts\\cellContext.js":"4","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\contexts\\rowContext.js":"5","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\contexts\\projectContext.js":"6","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\PageSpreadsheet.jsx":"7","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\contexts\\_createDataContext.js":"8","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelSetting.jsx":"9","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\CellHeader.jsx":"10","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\Cell.jsx":"11","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelFunction.jsx":"12","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\utils\\index.js":"13","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\constants\\index.js":"14","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelCalendar.jsx":"15","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\ReorderColumnForm.jsx":"16","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\ColorizedForm.jsx":"17","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\TableDrawingDetail.jsx":"18","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\TableCellHistory.jsx":"19","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\InputSearch.jsx":"20","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\IconTable.jsx":"21","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\CellIndex.jsx":"22","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormSort.jsx":"23","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormFilter.jsx":"24","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormGroup.jsx":"25","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\TableActivityHistory.jsx":"26","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormDateAutomation.jsx":"27","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\ButtonStyle.jsx":"28","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\ButtonGroupComp.jsx":"29","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelConfirm.jsx":"30","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormDrawingTypeOrder.jsx":"31","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormCellColorizedCheck.jsx":"32","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\TestTree.jsx":"33","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelCalendarDuration.jsx":"34","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormFilterActivityHistory.jsx":"35","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\PageDashboard.jsx":"36","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\utils\\functionDashboard.js":"37","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\CardPanelProject.jsx":"38","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\assets\\constantDashboard.js":"39","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\CardPanel.jsx":"40","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\PanelRightClick.jsx":"41","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\ChartBarRecordPanel.jsx":"42","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\ChartBarRecord.jsx":"43","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartBarDrawing.jsx":"44","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_TableDrawingList.jsx":"45","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartPieDrawing.jsx":"46","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartProgress.jsx":"47","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_FormPivot.jsx":"48","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartBarDrawingLate.jsx":"49","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartBarStack.jsx":"50","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\ChartBarStack.jsx":"51"},{"size":507,"mtime":1607175136833,"results":"52","hashOfConfig":"53"},{"size":1295,"mtime":1610214056113,"results":"54","hashOfConfig":"53"},{"size":362,"mtime":1606274463595,"results":"55","hashOfConfig":"53"},{"size":1435,"mtime":1609840744275,"results":"56","hashOfConfig":"53"},{"size":582,"mtime":1609148593298,"results":"57","hashOfConfig":"53"},{"size":964,"mtime":1609149456727,"results":"58","hashOfConfig":"53"},{"size":34604,"mtime":1610204990135,"results":"59","hashOfConfig":"53"},{"size":613,"mtime":1604905406752,"results":"60","hashOfConfig":"53"},{"size":32566,"mtime":1610208061329,"results":"61","hashOfConfig":"53"},{"size":530,"mtime":1609861179935,"results":"62","hashOfConfig":"53"},{"size":14048,"mtime":1610166741935,"results":"63","hashOfConfig":"53"},{"size":2057,"mtime":1610009662306,"results":"64","hashOfConfig":"53"},{"size":24517,"mtime":1610096566013,"results":"65","hashOfConfig":"53"},{"size":789,"mtime":1609170899693,"results":"66","hashOfConfig":"53"},{"size":381,"mtime":1608382149906,"results":"67","hashOfConfig":"53"},{"size":5882,"mtime":1609774583397,"results":"68","hashOfConfig":"53"},{"size":1505,"mtime":1609948277172,"results":"69","hashOfConfig":"53"},{"size":6286,"mtime":1610001969913,"results":"70","hashOfConfig":"53"},{"size":2097,"mtime":1610029504347,"results":"71","hashOfConfig":"53"},{"size":4198,"mtime":1609746105036,"results":"72","hashOfConfig":"53"},{"size":2878,"mtime":1610027014056,"results":"73","hashOfConfig":"53"},{"size":758,"mtime":1609775818433,"results":"74","hashOfConfig":"53"},{"size":6079,"mtime":1609942695103,"results":"75","hashOfConfig":"53"},{"size":5678,"mtime":1609774737388,"results":"76","hashOfConfig":"53"},{"size":4325,"mtime":1609900878619,"results":"77","hashOfConfig":"53"},{"size":10964,"mtime":1610097215741,"results":"78","hashOfConfig":"53"},{"size":4393,"mtime":1609251699928,"results":"79","hashOfConfig":"53"},{"size":723,"mtime":1609943027873,"results":"80","hashOfConfig":"53"},{"size":751,"mtime":1608563473295,"results":"81","hashOfConfig":"53"},{"size":715,"mtime":1609771644240,"results":"82","hashOfConfig":"53"},{"size":10810,"mtime":1610028188457,"results":"83","hashOfConfig":"53"},{"size":3121,"mtime":1609251920425,"results":"84","hashOfConfig":"53"},{"size":7279,"mtime":1609736342497,"results":"85","hashOfConfig":"53"},{"size":766,"mtime":1610028181675,"results":"86","hashOfConfig":"53"},{"size":5332,"mtime":1610167043394,"results":"87","hashOfConfig":"53"},{"size":10457,"mtime":1610213811464,"results":"88","hashOfConfig":"53"},{"size":14744,"mtime":1610213520087,"results":"89","hashOfConfig":"53"},{"size":1152,"mtime":1610214083017,"results":"90","hashOfConfig":"53"},{"size":3231,"mtime":1610177200906,"results":"91","hashOfConfig":"53"},{"size":1002,"mtime":1610175003252,"results":"92","hashOfConfig":"53"},{"size":1139,"mtime":1610175167433,"results":"93","hashOfConfig":"53"},{"size":1724,"mtime":1610197653543,"results":"94","hashOfConfig":"53"},{"size":3348,"mtime":1610175605402,"results":"95","hashOfConfig":"53"},{"size":6472,"mtime":1610184143931,"results":"96","hashOfConfig":"53"},{"size":20209,"mtime":1610213506355,"results":"97","hashOfConfig":"53"},{"size":2971,"mtime":1610189356028,"results":"98","hashOfConfig":"53"},{"size":3267,"mtime":1610189080604,"results":"99","hashOfConfig":"53"},{"size":5568,"mtime":1610202412471,"results":"100","hashOfConfig":"53"},{"size":3828,"mtime":1610202387124,"results":"101","hashOfConfig":"53"},{"size":5941,"mtime":1610213542808,"results":"102","hashOfConfig":"53"},{"size":5485,"mtime":1610203560342,"results":"103","hashOfConfig":"53"},{"filePath":"104","messages":"105","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},"utwymk",{"filePath":"107","messages":"108","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"109","messages":"110","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"111","messages":"112","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"113","messages":"114","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"115","messages":"116","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"117","messages":"118","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"119","usedDeprecatedRules":"106"},{"filePath":"120","messages":"121","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"122","usedDeprecatedRules":"106"},{"filePath":"123","messages":"124","errorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"125","usedDeprecatedRules":"106"},{"filePath":"126","messages":"127","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"128","usedDeprecatedRules":"106"},{"filePath":"129","messages":"130","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"131","usedDeprecatedRules":"106"},{"filePath":"132","messages":"133","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"134","messages":"135","errorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"136","usedDeprecatedRules":"106"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"139","messages":"140","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"141","usedDeprecatedRules":"106"},{"filePath":"142","messages":"143","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"144","messages":"145","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"146","messages":"147","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"148","usedDeprecatedRules":"106"},{"filePath":"149","messages":"150","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"151","usedDeprecatedRules":"106"},{"filePath":"152","messages":"153","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"154","messages":"155","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"156","messages":"157","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"158","messages":"159","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"160","messages":"161","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"162","messages":"163","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"164","messages":"165","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"166","usedDeprecatedRules":"106"},{"filePath":"167","messages":"168","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"169","messages":"170","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"171","usedDeprecatedRules":"106"},{"filePath":"172","messages":"173","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"174","messages":"175","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"176","messages":"177","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"178","usedDeprecatedRules":"106"},{"filePath":"179","messages":"180","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"181","usedDeprecatedRules":"106"},{"filePath":"182","messages":"183","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"184","messages":"185","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"186","messages":"187","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"188","messages":"189","errorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"190","usedDeprecatedRules":"106"},{"filePath":"191","messages":"192","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"193","usedDeprecatedRules":"106"},{"filePath":"194","messages":"195","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"196","messages":"197","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"198","messages":"199","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"200","messages":"201","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"202","messages":"203","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"204","messages":"205","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"206","messages":"207","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"208","usedDeprecatedRules":"106"},{"filePath":"209","messages":"210","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"211","usedDeprecatedRules":"106"},{"filePath":"212","messages":"213","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"214","messages":"215","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"216","messages":"217","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"218","messages":"219","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"220","messages":"221","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},{"filePath":"222","messages":"223","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"106"},"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\index.js",[],["224","225"],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\App.js",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\reportWebVitals.js",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\contexts\\cellContext.js",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\contexts\\rowContext.js",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\contexts\\projectContext.js",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\PageSpreadsheet.jsx",["226","227","228","229","230"],"import { Divider, Icon, message, Modal } from 'antd';\r\nimport Axios from 'axios';\r\nimport { debounce } from 'lodash';\r\nimport React, { forwardRef, useContext, useEffect, useRef, useState } from 'react';\r\nimport BaseTable, { AutoResizer, Column } from 'react-base-table';\r\nimport 'react-base-table/styles.css';\r\nimport styled from 'styled-components';\r\nimport { colorType, dimension, SERVER_URL } from '../constants';\r\nimport { Context as CellContext } from '../contexts/cellContext';\r\nimport { Context as ProjectContext } from '../contexts/projectContext';\r\nimport { Context as RowContext } from '../contexts/rowContext';\r\nimport { getActionName, getCurrentAndHistoryDrawings, getDataConvertedSmartsheet, getHeaderWidth, getModalWidth, reorderRowsFnc } from '../utils';\r\nimport Cell from './pageSpreadsheet/Cell';\r\nimport CellHeader from './pageSpreadsheet/CellHeader';\r\nimport CellIndex from './pageSpreadsheet/CellIndex';\r\nimport IconTable from './pageSpreadsheet/IconTable';\r\nimport InputSearch from './pageSpreadsheet/InputSearch';\r\nimport PanelFunction from './pageSpreadsheet/PanelFunction';\r\nimport PanelSetting from './pageSpreadsheet/PanelSetting';\r\n\r\n\r\n\r\n\r\nconst Table = forwardRef((props, ref) => {\r\n   return (\r\n      <AutoResizer>\r\n         {() => <BaseTable\r\n            {...props}\r\n            ref={ref}\r\n            width={window.innerWidth}\r\n            height={window.innerHeight - 99.78}\r\n         />}\r\n      </AutoResizer>\r\n   );\r\n});\r\nlet previousDOMCell = null;\r\nlet currentDOMCell = null;\r\nlet isTyping = false;\r\n\r\n\r\n\r\nconst PageSpreadsheet = (props) => {\r\n\r\n   const { email, role, isAdmin, projectId, projectName } = props;\r\n   const tableRef = useRef();\r\n\r\n   const getCurrentDOMCell = () => {\r\n      if (isTyping) {\r\n         isTyping = false;\r\n      } else {\r\n         isTyping = true;\r\n         setCellActive(currentDOMCell);\r\n      };\r\n   };\r\n   const setPosition = (e) => {\r\n      if (previousDOMCell) {\r\n         previousDOMCell.cell.classList.remove('cell-current');\r\n      };\r\n      currentDOMCell = e;\r\n      currentDOMCell.cell.classList.add('cell-current');\r\n      previousDOMCell = e;\r\n      isTyping = false;\r\n   };\r\n   useEffect(() => {\r\n      window.addEventListener('keydown', EventKeyDown);\r\n      return () => {\r\n         window.removeEventListener('keydown', EventKeyDown);\r\n      };\r\n   }, []);\r\n   const EventKeyDown = (e) => {\r\n      if (e.key === 'ArrowUp') {\r\n         if (isTyping) return;\r\n         let cellTop = currentDOMCell.cell.parentElement.offsetTop;\r\n         if (currentDOMCell.rowIndex === 0) return;\r\n\r\n         currentDOMCell.cell.classList.remove('cell-current');\r\n         let index;\r\n         currentDOMCell.cell.parentElement.childNodes.forEach((dv, i) => {\r\n            if (dv === currentDOMCell.cell) index = i;\r\n         });\r\n         if (!currentDOMCell.cell.parentElement.previousSibling) return; // Scroll out of sight of cell selected\r\n         currentDOMCell.cell = currentDOMCell.cell.parentElement.previousSibling.childNodes[index];\r\n         currentDOMCell.cell.classList.add('cell-current');\r\n         currentDOMCell.rowIndex = currentDOMCell.rowIndex - 1;\r\n\r\n         e.preventDefault();\r\n         if (cellTop <= tableRef.current._scroll.scrollTop) {\r\n            tableRef.current.scrollToTop(currentDOMCell.cell.parentElement.offsetTop);\r\n         };\r\n\r\n      } else if (e.key === 'ArrowRight') {\r\n         if (isTyping) return;\r\n\r\n         if (currentDOMCell.columnIndex < tableRef.current.leftTable.props.columns.length - 1) {\r\n            currentDOMCell.cell.classList.remove('cell-current');\r\n            currentDOMCell.cell = currentDOMCell.cell.nextSibling;\r\n            currentDOMCell.cell.classList.add('cell-current');\r\n            currentDOMCell.columnIndex = currentDOMCell.columnIndex + 1;\r\n\r\n         } else if (\r\n            currentDOMCell.columnIndex >= tableRef.current.leftTable.props.columns.length &&\r\n            currentDOMCell.columnIndex < tableRef.current.columnManager._columns.length - 1\r\n         ) {\r\n            let cellRight = currentDOMCell.cell.offsetLeft + currentDOMCell.cell.offsetWidth;\r\n            let innerTableWidth = window.innerWidth - 15;\r\n\r\n            e.preventDefault();\r\n            if (cellRight > innerTableWidth - 100) {\r\n               tableRef.current.scrollToLeft(cellRight - innerTableWidth + 100);\r\n            };\r\n\r\n            currentDOMCell.cell.classList.remove('cell-current');\r\n            currentDOMCell.cell = currentDOMCell.cell.nextSibling;\r\n            currentDOMCell.cell.classList.add('cell-current');\r\n            currentDOMCell.columnIndex = currentDOMCell.columnIndex + 1;\r\n         };\r\n\r\n      } else if (e.key === 'ArrowDown') {\r\n\r\n         if (isTyping) return;\r\n\r\n         if (currentDOMCell.rowIndex >= Object.keys(tableRef.current._depthMap).length - 1) return;\r\n         let cellTop = currentDOMCell.cell.parentElement.offsetTop;\r\n\r\n         currentDOMCell.cell.classList.remove('cell-current');\r\n         let index;\r\n         currentDOMCell.cell.parentElement.childNodes.forEach((dv, i) => {\r\n            if (dv === currentDOMCell.cell) index = i;\r\n         });\r\n         if (!currentDOMCell.cell.parentElement.nextSibling) return; // Scroll out of sight of cell selected\r\n         currentDOMCell.cell = currentDOMCell.cell.parentElement.nextSibling.childNodes[index];\r\n         currentDOMCell.cell.classList.add('cell-current');\r\n         currentDOMCell.rowIndex = currentDOMCell.rowIndex + 1;\r\n\r\n         e.preventDefault();\r\n         if (\r\n            cellTop < tableRef.current._scroll.scrollTop ||\r\n            cellTop > tableRef.current._scroll.scrollTop + 690\r\n         ) {\r\n            tableRef.current.scrollToTop(currentDOMCell.cell.parentElement.offsetTop - 720);\r\n         };\r\n\r\n      } else if (e.key === 'ArrowLeft') {\r\n\r\n         if (isTyping) return;\r\n\r\n         if (currentDOMCell.columnIndex > 1 &&\r\n            currentDOMCell.columnIndex < tableRef.current.leftTable.props.columns.length\r\n         ) {\r\n            currentDOMCell.cell.classList.remove('cell-current');\r\n            currentDOMCell.cell = currentDOMCell.cell.previousSibling;\r\n            currentDOMCell.cell.classList.add('cell-current');\r\n            currentDOMCell.columnIndex = currentDOMCell.columnIndex - 1;\r\n\r\n         } else if (\r\n            currentDOMCell.columnIndex > tableRef.current.leftTable.props.columns.length &&\r\n            currentDOMCell.columnIndex < tableRef.current.columnManager._columns.length\r\n         ) {\r\n            let cellLeft = currentDOMCell.cell.offsetLeft;\r\n            let innerTableWidth = window.innerWidth - 15;\r\n\r\n            currentDOMCell.cell.classList.remove('cell-current');\r\n            currentDOMCell.cell = currentDOMCell.cell.previousSibling;\r\n            currentDOMCell.cell.classList.add('cell-current');;\r\n            currentDOMCell.columnIndex = currentDOMCell.columnIndex - 1;\r\n\r\n            e.preventDefault();\r\n\r\n            if (cellLeft <= tableRef.current.columnManager._cached.columnsWidth - innerTableWidth + 820) {\r\n               tableRef.current.scrollToLeft(cellLeft - 820 - currentDOMCell.cell.offsetWidth);\r\n            };\r\n         };\r\n\r\n      } else if (e.key === 'Enter') {\r\n         if (isTyping) {\r\n            isTyping = false;\r\n         } else {\r\n            isTyping = true;\r\n            setCellActive(currentDOMCell);\r\n         };\r\n      };\r\n   };\r\n\r\n\r\n\r\n\r\n   const { state: stateCell, setCellActive, OverwriteCellsModified } = useContext(CellContext);\r\n   const { state: stateRow, getSheetRows } = useContext(RowContext);\r\n   const { state: stateProject, fetchDataOneSheet, setUserData } = useContext(ProjectContext);\r\n\r\n   useEffect(() => console.log('STATE-CELL...', stateCell), [stateCell]);\r\n   useEffect(() => console.log('STATE-ROW...', stateRow), [stateRow]);\r\n   useEffect(() => console.log('STATE-PROJECT...', stateProject), [stateProject]);\r\n\r\n   const [cursor, setCursor] = useState(null);\r\n   const [panelType, setPanelType] = useState(null);\r\n   const [panelSettingType, setPanelSettingType] = useState(null);\r\n   const [panelFunctionVisible, setPanelFunctionVisible] = useState(false);\r\n   const [panelSettingVisible, setPanelSettingVisible] = useState(false);\r\n\r\n   const buttonPanelFunction = (btn) => {\r\n      const { rowsAll, rowsUpdatePreRowOrParentRow } = stateRow;\r\n      setPanelFunctionVisible(false);\r\n\r\n\r\n      if (btn === 'Move Drawing') {\r\n         getSheetRows({ ...stateRow, rowsToMoveId: panelType.cellProps.rowData.id });\r\n\r\n      } else if (btn === 'Paste Drawing') {\r\n\r\n         const rowToMove = rowsAll.find(r => r.id === stateRow.rowsToMoveId);\r\n\r\n         const rowBelowPrevious = rowsAll.find(r => r._preRow === stateRow.rowsToMoveId);\r\n         if (rowBelowPrevious) {\r\n            rowBelowPrevious._preRow = rowToMove._preRow;\r\n            rowsUpdatePreRowOrParentRow[rowBelowPrevious.id] = {\r\n               _preRow: rowBelowPrevious._preRow, _parentRow: rowBelowPrevious._parentRow, id: rowBelowPrevious.id\r\n            };\r\n         };\r\n         const rowBelowNext = rowsAll.find(r => r._preRow === panelType.cellProps.rowData.id);\r\n         if (rowBelowNext) {\r\n            rowBelowNext._preRow = stateRow.rowsToMoveId;\r\n            rowsUpdatePreRowOrParentRow[rowBelowNext.id] = {\r\n               _preRow: rowBelowNext._preRow, _parentRow: rowBelowNext._parentRow, id: rowBelowNext.id\r\n            };\r\n         };\r\n\r\n         rowToMove._preRow = panelType.cellProps.rowData.id;\r\n         rowToMove._parentRow = panelType.cellProps.rowData._parentRow;\r\n         rowsUpdatePreRowOrParentRow[rowToMove.id] = {\r\n            _preRow: rowToMove._preRow, _parentRow: rowToMove._parentRow, id: rowToMove.id\r\n         };\r\n\r\n         getSheetRows({\r\n            ...stateRow,\r\n            rowsAll: reorderRowsFnc(rowsAll),\r\n            rowsAllInit: reorderRowsFnc(rowsAll),\r\n            rowsUpdatePreRowOrParentRow,\r\n            rowsToMoveId: null\r\n         });\r\n\r\n      } else {\r\n         setPanelSettingType(btn);\r\n         setPanelSettingVisible(true);\r\n      };\r\n   };\r\n   const onMouseDownColumnHeader = (e, header) => {\r\n      setCursor({ x: e.clientX, y: e.clientY });\r\n      setPanelType({ type: 'column', header });\r\n      setPanelFunctionVisible(true);\r\n   };\r\n   const onRightClickCell = (e, cellProps) => {\r\n      setCursor({ x: e.clientX, y: e.clientY });\r\n      setPanelType({ type: 'cell', cellProps });\r\n      setPanelFunctionVisible(true);\r\n   };\r\n   const commandAction = (update) => {\r\n\r\n      if (update.type === 'sort-data-drawing-type') {\r\n         getSheetRows({ ...stateRow, rowsAll: update.data });\r\n      } else if (update.type === 'sort-data-project') {\r\n         getSheetRows({ ...stateRow, rowsAll: update.data, showDrawingsOnly: 'sort-data-project' });\r\n\r\n      } else if (update.type === 'filter-by-columns') {\r\n         if (update.data.length > 0) {\r\n            getSheetRows({ ...stateRow, rowsAll: update.data });\r\n         } else message.info('There is no drawing found', 1.5);\r\n\r\n      } else if (update.type === 'reset-filter-sort') {\r\n         getSheetRows({\r\n            ...stateRow,\r\n            rowsAll: stateRow.rowsAllInit,\r\n            showDrawingsOnly: false\r\n         });\r\n         setExpandedRows(getRowsKeyExpanded(stateRow.drawingTypeTree));\r\n         setSearchInputShown(false);\r\n         setCellSearchFound(null);\r\n         setCellHistoryFound(null);\r\n         setUserData({ ...stateProject.userData, nosColumnFixed: stateProject.userData.nosColumnFixed + 1 });\r\n         setUserData({ ...stateProject.userData, nosColumnFixed: stateProject.userData.nosColumnFixed });\r\n\r\n      } else if (update.type === 'reorder-columns') {\r\n         setUserData({\r\n            ...stateProject.userData,\r\n            headersHidden: update.data.headersHidden,\r\n            headersShown: update.data.headersShown,\r\n            nosColumnFixed: update.data.nosColumnFixed,\r\n         });\r\n\r\n      } else if (update.type === 'insert-drawings') {\r\n         getSheetRows({\r\n            ...stateRow,\r\n            rowsAll: update.data.rowsAll,\r\n            rowsAllInit: update.data.rowsAll,\r\n            idRowsNew: update.data.idRowsNew\r\n         });\r\n\r\n      } else if (update.type === 'insert-drawings-by-folder') {\r\n         getSheetRows({\r\n            ...stateRow,\r\n            rowsAll: update.data.rowsAll,\r\n            rowsAllInit: update.data.rowsAll,\r\n            idRowsNew: update.data.idRowsNew\r\n         });\r\n      } else if (update.type === 'drawing-data-automation') {\r\n         getSheetRows({\r\n            ...stateRow,\r\n            rowsAll: update.data,\r\n            rowsAllInit: update.data\r\n         });\r\n\r\n      } else if (update.type === 'create-new-drawing-revisions') {\r\n         getSheetRows({\r\n            ...stateRow,\r\n            rowsAll: update.data.rowsAll,\r\n            rowsAllInit: update.data.rowsAll,\r\n            rowsVersionsToSave: update.data.rowsVersionsToSave\r\n         });\r\n\r\n      } else if (update.type === 'group-columns') {\r\n         getSheetRows({ ...stateRow, rowsAll: update.data.rows, showDrawingsOnly: 'group-columns' });\r\n         setExpandedRows(update.data.expandedRows);\r\n\r\n      } else if (update.type === 'drawing-colorized') {\r\n         setUserData({\r\n            ...stateProject.userData,\r\n            colorization: update.data\r\n         });\r\n\r\n      } else if (update.type === 'highlight-cell-history') {\r\n         setCellHistoryFound(update.data);\r\n         setUserData({ ...stateProject.userData, nosColumnFixed: 1 });\r\n         setUserData({ ...stateProject.userData, nosColumnFixed: stateProject.userData.nosColumnFixed });\r\n\r\n      } else if (update.type === 'drawing-folder-organization') {\r\n         getSheetRows({\r\n            ...stateRow,\r\n            rowsAll: update.data.rowsAll,\r\n            rowsAllInit: update.data.rowsAll,\r\n            drawingTypeTree: update.data.drawingTypeTree,\r\n            rowsDeleted: update.data.rowsDeleted,\r\n            idRowsNew: update.data.idRowsNew\r\n         });\r\n         setExpandedRows(getRowsKeyExpanded(update.data.drawingTypeTree));\r\n\r\n      } else if (update.type === 'delete-drawing') {\r\n\r\n         getSheetRows({\r\n            ...stateRow,\r\n            rowsAll: update.data.rowsAll,\r\n            rowsAllInit: update.data.rowsAll,\r\n            rowsDeleted: update.data.rowsDeleted,\r\n            idRowsNew: update.data.idRowsNew\r\n         });\r\n\r\n      } else if (update.type === 'save-data-successfully') {\r\n         message.success('Save Data Successfully', 1.5);\r\n      } else if (update.type === 'save-data-failure') {\r\n         message.error('Network Error', 1.5);\r\n\r\n      } else if (update.type === 'reload-data-from-server') {\r\n\r\n         fetchDataOneSheet({\r\n            ...update.data,\r\n            email, projectId, projectName, role\r\n         });\r\n         setUserData(getHeadersData(update.data));\r\n         getSheetRows(getInputDataInitially(update.data));\r\n         setExpandedRows(getRowsKeyExpanded(update.data.publicSettings.drawingTypeTree));\r\n         OverwriteCellsModified({});\r\n         setCellActive(null);\r\n\r\n         setLoading(false);\r\n      };\r\n\r\n      setPanelSettingVisible(false);\r\n      setPanelSettingType(null);\r\n      setPanelType(null);\r\n   };\r\n\r\n   const onScroll = () => {\r\n      if (stateCell.cellActive) setCellActive(null);\r\n   };\r\n\r\n\r\n\r\n\r\n\r\n   // SAVE DATA TO SMART SHEET\r\n   const [state, setstate] = useState(null);\r\n   const saveSmartSheetDataSumang = async () => {\r\n      try {\r\n         await Axios.post(  // SAVE ROWS TO SERVER ...\r\n            `${SERVER_URL}/sheet/update-rows/${projectId}`,\r\n            { rows: state['Sumang'].rows }\r\n         );\r\n         await Axios.post(  // SAVE ROWS HISTORY TO SERVER ...\r\n            `${SERVER_URL}/row/history/${projectId}?userId=${email}`,\r\n            state['Sumang'].historyRows\r\n         );\r\n         await Axios.post(`${SERVER_URL}/sheet/update-setting-public/${projectId}?userId=${email}`,\r\n            { drawingTypeTree: state['Sumang'].drawingTypeTree }\r\n         );\r\n      } catch (err) {\r\n         console.log(err);\r\n      };\r\n   };\r\n   const saveSmartSheetDataHandy = async () => {\r\n      try {\r\n         await Axios.post(  // SAVE ROWS TO SERVER ...\r\n            `${SERVER_URL}/sheet/update-rows/${projectId}`,\r\n            { rows: state['Handy'].rows }\r\n         );\r\n         await Axios.post(  // SAVE ROWS HISTORY TO SERVER ...\r\n            `${SERVER_URL}/row/history/${projectId}?userId=${email}`,\r\n            state['Handy'].historyRows\r\n         );\r\n         await Axios.post(`${SERVER_URL}/sheet/update-setting-public/${projectId}?userId=${email}`,\r\n            { drawingTypeTree: state['Handy'].drawingTypeTree }\r\n         );\r\n      } catch (err) {\r\n         console.log(err);\r\n      };\r\n   };\r\n   const deleteAllRowsInCurrentProject = async () => {\r\n      try {\r\n         await Axios.delete(`${SERVER_URL}/sheet/delete-rows-project/${projectId}`);\r\n      } catch (err) {\r\n         console.log(err);\r\n      };\r\n   };\r\n   const deleteAllDataInAllCollections = async () => {\r\n      try {\r\n\r\n         await Axios.delete(`${SERVER_URL}/cell/history/delete-all`);\r\n         await Axios.delete(`${SERVER_URL}/row/history/delete-all`);\r\n         await Axios.delete(`${SERVER_URL}/sheet/delete-all`);\r\n         await Axios.delete(`${SERVER_URL}/settings/delete-all`);\r\n\r\n      } catch (err) {\r\n         console.log(err);\r\n      };\r\n   };\r\n\r\n\r\n   \r\n\r\n\r\n\r\n\r\n\r\n\r\n   const [loading, setLoading] = useState(true);\r\n   useEffect(() => {\r\n      const fetchOneProject = async () => {\r\n\r\n         try {\r\n            setLoading(true);\r\n            const res = await Axios.get(`${SERVER_URL}/sheet/${projectId}?userId=${email}`);\r\n            console.log('MONGO ...', res.data);\r\n\r\n\r\n            const resultSmartsheet = await Axios.post( // SMART SHEETTTTTTTTTTTTTTTT\r\n                'https://bim.wohhup.com/api/smartsheet/get-sheets-dashboard',\r\n                { listSheetId: [4758181617395588, 8919906142971780] }\r\n            );\r\n            console.log('SMARTSHEET...', resultSmartsheet.data);\r\n            const rowsAllSmartSheet = getDataConvertedSmartsheet(resultSmartsheet.data);\r\n            const dataToSave = getCurrentAndHistoryDrawings(rowsAllSmartSheet, res.data.publicSettings.headers);\r\n            console.log('dataToSave', dataToSave);\r\n            setstate(dataToSave);\r\n\r\n\r\n\r\n\r\n            fetchDataOneSheet({\r\n               ...res.data,\r\n               email, projectId, projectName, role\r\n            });\r\n            setUserData(getHeadersData(res.data));\r\n            getSheetRows(getInputDataInitially(res.data));\r\n            setExpandedRows(getRowsKeyExpanded(res.data.publicSettings.drawingTypeTree));\r\n\r\n\r\n            setLoading(false);\r\n         } catch (err) {\r\n            console.log(err);\r\n         };\r\n      };\r\n      fetchOneProject();\r\n   }, []);\r\n\r\n   useEffect(() => {\r\n      const interval = setInterval(() => {\r\n\r\n         setPanelFunctionVisible(false);\r\n         setPanelSettingType('save-every-20min');\r\n         setPanelSettingVisible(true);\r\n      }, 1000 * 60 * 15);\r\n\r\n      return () => clearInterval(interval);\r\n   }, []);\r\n\r\n   const askBeforeClose = (e) => {\r\n      console.log('aaaaaaaaaaaaaaaaaa', e);\r\n      e.preventDefault();\r\n      setPanelFunctionVisible(false);\r\n      setPanelSettingType('save-ICON');\r\n      setPanelSettingVisible(true);\r\n   };\r\n\r\n   // useEffect(() => {\r\n   //    window.addEventListener('beforeunload', e => askBeforeClose(e));\r\n   //    return () => window.removeEventListener('beforeunload', e => askBeforeClose(e));\r\n   // }, []);\r\n\r\n\r\n\r\n\r\n\r\n   // const [columns, setColumns] = useState(null);\r\n   const [expandedRows, setExpandedRows] = useState([]);\r\n   const [expandColumnKey, setExpandColumnKey] = useState('Drawing Number');\r\n   const [cellSearchFound, setCellSearchFound] = useState(null);\r\n   const [cellHistoryFound, setCellHistoryFound] = useState(null);\r\n\r\n   const onRowExpand = (props) => {\r\n      const { rowKey, expanded } = props;\r\n      let arr = [...expandedRows];\r\n      if (expanded) {\r\n         arr.push(rowKey);\r\n      } else {\r\n         arr.splice(arr.indexOf(rowKey), 1);\r\n      };\r\n      setExpandedRows(arr);\r\n   };\r\n   const ExpandIcon = (props) => {\r\n      const { expanding, expandable, onExpand, depth } = props;\r\n      const indent = (depth * 15).toString() + 'px';\r\n      if (!expandable) return null;\r\n      return (\r\n         <div style={{\r\n            marginLeft: indent,\r\n            paddingLeft: 10,\r\n            paddingRight: 10,\r\n            background: 'transparent'\r\n         }}>\r\n            <Icon\r\n               type={expanding ? 'plus-square' : 'minus-square'}\r\n               onClick={() => onExpand(expanding)}\r\n               style={{\r\n                  color: 'black',\r\n                  transform: 'translate(0, -1px)'\r\n               }}\r\n            />\r\n         </div>\r\n      );\r\n   };\r\n   const expandIconProps = (props) => {\r\n      return ({\r\n         expanding: !props.expanded,\r\n      });\r\n   };\r\n   const rowProps = (props) => {\r\n      const { rowData } = props;\r\n      return {\r\n         tagName: rowData._rowLevel < 1 ? RowStyled : undefined\r\n      };\r\n   };\r\n   const onColumnResize = () => {\r\n   };\r\n   const rowClassName = (props) => {\r\n      const { rowData } = props;\r\n      const { colorization } = stateProject.userData;\r\n\r\n      if (colorization !== null && colorization !== 'No Colorization') {\r\n         return `colorization-${colorization}-${rowData[colorization]}-styled`;\r\n      };\r\n   };\r\n\r\n\r\n   const [searchInputShown, setSearchInputShown] = useState(false);\r\n   const searchGlobal = (found) => {\r\n      setCellSearchFound(found);\r\n      setUserData({ ...stateProject.userData, nosColumnFixed: stateProject.userData.nosColumnFixed + 1 });\r\n      setUserData({ ...stateProject.userData, nosColumnFixed: stateProject.userData.nosColumnFixed });\r\n   };\r\n   const closeSearchInput = debounce(() => {\r\n      setSearchInputShown(false);\r\n      setCellSearchFound(null);\r\n      setUserData({ ...stateProject.userData, nosColumnFixed: stateProject.userData.nosColumnFixed + 1 });\r\n      setUserData({ ...stateProject.userData, nosColumnFixed: stateProject.userData.nosColumnFixed });\r\n   }, 7);\r\n\r\n\r\n   const renderColumns = (arr, nosColumnFixed) => {\r\n\r\n      let headersObj = [{\r\n         key: 'Index', dataKey: 'Index', title: '', width: 50,\r\n         frozen: Column.FrozenDirection.LEFT,\r\n         cellRenderer: <CellIndex />,\r\n         style: { padding: 0, margin: 0 }\r\n      }];\r\n      arr.forEach((hd, index) => {\r\n         headersObj.push({\r\n            key: hd, dataKey: hd, title: hd,\r\n            width: getHeaderWidth(hd),\r\n            resizable: true,\r\n            frozen: index < nosColumnFixed ? Column.FrozenDirection.LEFT : undefined,\r\n            headerRenderer: (\r\n               <CellHeader\r\n                  onMouseDownColumnHeader={onMouseDownColumnHeader}\r\n               />\r\n            ),\r\n            cellRenderer: (\r\n               <Cell\r\n                  setPosition={setPosition}\r\n                  onRightClickCell={onRightClickCell}\r\n                  getCurrentDOMCell={getCurrentDOMCell}\r\n               />\r\n            ),\r\n            className: (props) => {\r\n               const { rowData: { id }, column: { key } } = props;\r\n               return (cellSearchFound && id in cellSearchFound && cellSearchFound[id].indexOf(key) !== -1)\r\n                  ? 'cell-found'\r\n                  : (cellHistoryFound && cellHistoryFound.find(cell => cell.rowId === id && cell.header === key))\r\n                     ? 'cell-history-highlight'\r\n                     : ''\r\n            }\r\n         });\r\n      });\r\n      return headersObj;\r\n   };\r\n\r\n\r\n   return (\r\n      <PageSpreadsheetStyled\r\n         // onContextMenu={(e) => e.preventDefault()}\r\n      >\r\n         <ButtonBox>\r\n            <IconTable type='save' onClick={() => buttonPanelFunction('save-ICON')} />\r\n            <DividerRibbon />\r\n            <IconTable type='layout' onClick={() => buttonPanelFunction('reorderColumn-ICON')} />\r\n            <IconTable type='filter' onClick={() => buttonPanelFunction('filter-ICON')} />\r\n            <IconTable type='apartment' onClick={() => buttonPanelFunction('group-ICON')} />\r\n            <IconTable type='sort-ascending' onClick={() => buttonPanelFunction('sort-ICON')} />\r\n\r\n            {searchInputShown ? (\r\n               <InputSearch searchGlobal={searchGlobal} closeSearchInput={closeSearchInput} />\r\n            ) : <IconTable type='search' onClick={() => setSearchInputShown(true)} />}\r\n\r\n            <IconTable type='rollback' onClick={() => buttonPanelFunction('rollback-ICON')} />\r\n            <DividerRibbon />\r\n            <IconTable type='folder-add' onClick={() => buttonPanelFunction('addDrawingType-ICON')} />\r\n\r\n            <IconTable type='highlight' onClick={() => buttonPanelFunction('colorized-ICON')} />\r\n            <DividerRibbon />\r\n            <IconTable type='history' onClick={() => buttonPanelFunction('history-ICON')} />\r\n            <IconTable type='heat-map' onClick={() => buttonPanelFunction('color-cell-history-ICON')} />\r\n\r\n            <DividerRibbon />\r\n            {isAdmin && (\r\n               <div style={{ display: 'flex' }}>\r\n                  <IconTable type='fullscreen-exit' onClick={saveSmartSheetDataSumang} />\r\n                  <IconTable type='fall' onClick={saveSmartSheetDataHandy} />\r\n                  <IconTable type='delete' onClick={deleteAllRowsInCurrentProject} />\r\n                  <IconTable type='stock' onClick={deleteAllDataInAllCollections} />\r\n               </div>\r\n            )}\r\n         </ButtonBox>\r\n\r\n\r\n         {!loading ? (\r\n            <TableStyled\r\n               dataForStyled={{stateRow, stateProject} }\r\n               ref={tableRef}\r\n               fixed\r\n               columns={renderColumns(\r\n                  stateProject.userData.headersShown,\r\n                  stateProject.userData.nosColumnFixed\r\n               )}\r\n               data={arrangeDrawingTypeFinal(stateRow)}\r\n               expandedRowKeys={expandedRows}\r\n\r\n               expandColumnKey={expandColumnKey}\r\n\r\n               expandIconProps={expandIconProps}\r\n               components={{ ExpandIcon }}\r\n               rowHeight={30}\r\n               overscanRowCount={0}\r\n               onScroll={onScroll}\r\n               rowProps={rowProps}\r\n               rowClassName={rowClassName}\r\n               onColumnResize={onColumnResize}\r\n               onRowExpand={onRowExpand}\r\n            />\r\n         ) : <LoadingIcon />}\r\n\r\n\r\n         <ModalStyleFunction\r\n            visible={panelFunctionVisible}\r\n            footer={null}\r\n            onCancel={() => setPanelFunctionVisible(false)}\r\n            destroyOnClose={true}\r\n            style={{ position: 'fixed', left: cursor && cursor.x, top: cursor && cursor.y }}\r\n            mask={false}\r\n            width={250}\r\n         >\r\n            <PanelFunction\r\n               panelType={panelType}\r\n               buttonPanelFunction={buttonPanelFunction}\r\n            />\r\n         </ModalStyleFunction>\r\n\r\n\r\n         <ModalStyledSetting\r\n            title={getActionName(panelSettingType)}\r\n            visible={panelSettingVisible}\r\n            footer={null}\r\n            onCancel={() => {\r\n               setPanelSettingVisible(false);\r\n               setPanelSettingType(null);\r\n               setPanelType(null);\r\n            }}\r\n            destroyOnClose={true}\r\n            centered={true}\r\n            width={getModalWidth(panelSettingType)}\r\n         >\r\n            <PanelSetting\r\n               panelType={panelType}\r\n               panelSettingType={panelSettingType}\r\n               commandAction={commandAction}\r\n               onClickCancelModal={() => {\r\n                  setPanelSettingVisible(false);\r\n                  setPanelSettingType(null);\r\n                  setPanelType(null);\r\n               }}\r\n               setLoading={setLoading}\r\n            />\r\n         </ModalStyledSetting>\r\n\r\n      </PageSpreadsheetStyled>\r\n   );\r\n};\r\nexport default PageSpreadsheet;\r\n\r\n\r\n\r\nconst getColumnsValueForColorization = (rows, header) => {\r\n   let valueArr = [];\r\n   rows.forEach(row => {\r\n      valueArr.push(row[header] || '');\r\n   });\r\n   return valueArr;\r\n};\r\nconst DividerRibbon = () => {\r\n   return (\r\n      <Divider type='vertical' style={{\r\n         height: 32,\r\n         marginLeft: 8,\r\n         marginRight: 8,\r\n         background: 'white'\r\n      }} />\r\n   );\r\n};\r\nconst RowStyled = styled.a`\r\n    background-color: ${colorType.grey3};\r\n    font-weight: bold;\r\n    cursor: default;\r\n    &:hover {\r\n        background-color: ${colorType.grey3};\r\n    }\r\n`;\r\nconst PageSpreadsheetStyled = styled.div`\r\n    padding-top: ${dimension.navBarHeight};\r\n`;\r\n\r\n\r\nconst TableStyled = styled(Table)`\r\n\r\n   \r\n   ${({dataForStyled}) => {\r\n      const { stateRow, stateProject } = dataForStyled;\r\n      const classArr = getColumnsValueForColorization(stateRow.rowsAll, stateProject.userData.colorization).map(n => {\r\n         return `.colorization-${stateProject.userData.colorization}-${n}-styled {\r\n            background-color: yellow;\r\n         }`;\r\n      });\r\n      const output = [...new Set(classArr)].join('\\n');\r\n      return output;\r\n   }}\r\n\r\n\r\n\r\n\r\n\r\n    .cell-found {\r\n        background-color: #7bed9f;\r\n    }\r\n    .cell-history-highlight {\r\n        background-color: #f6e58d;\r\n    }\r\n    .row-color-categorized {\r\n        background-color: #9ACD32;\r\n    }\r\n    .cell-current {\r\n        background-color: ${colorType.cellHighlighted}\r\n    };\r\n\r\n\r\n    \r\n\r\n    .BaseTable__table .BaseTable__body {\r\n        -webkit-touch-callout: none;\r\n        -webkit-user-select: none;\r\n        -khtml-user-select: none;\r\n        -moz-user-select: none;\r\n        -ms-user-select: none;\r\n        user-select: none;\r\n\r\n        ::-webkit-scrollbar {\r\n            -webkit-appearance: none;\r\n            background-color: #e3e3e3;\r\n        }\r\n        ::-webkit-scrollbar:vertical {\r\n            width: 15px;\r\n        }\r\n        ::-webkit-scrollbar:horizontal {\r\n            height: 15px;\r\n        }\r\n        ::-webkit-scrollbar-thumb {\r\n            border-radius: 10px;\r\n            border: 2px solid #e3e3e3;\r\n            background-color: #999;\r\n            &:hover {\r\n                background-color: #666;\r\n            }\r\n        }\r\n        ::-webkit-resizer {\r\n            display: none;\r\n        }\r\n    }\r\n    .BaseTable__header-cell {\r\n        padding: 5px;\r\n        border-right: 1px solid #DCDCDC;\r\n        background: ${colorType.primary};\r\n        color: white\r\n    }\r\n    .BaseTable__row-cell {\r\n        padding: 0;\r\n        border-right: 1px solid #DCDCDC;\r\n        overflow: visible !important;\r\n    }\r\n    .BaseTable__table-frozen-left {\r\n        border-right: 4px solid #DCDCDC;\r\n        box-shadow: none;\r\n    }\r\n`;\r\nconst ModalStyleFunction = styled(Modal)`\r\n   .ant-modal-close, .ant-modal-header {\r\n      display: none;\r\n   }\r\n   .ant-modal-body {\r\n      padding: 0;\r\n   }\r\n`;\r\nconst ModalStyledSetting = styled(Modal)`\r\n    .ant-modal-content {\r\n        border-radius: 0;\r\n    }\r\n   .ant-modal-close {\r\n      display: none;\r\n   }\r\n   .ant-modal-header {\r\n      padding: 10px;\r\n   }\r\n   .ant-modal-title {\r\n        padding-left: 10px;\r\n        font-size: 20px;\r\n        font-weight: bold;\r\n   }\r\n   .ant-modal-body {\r\n      padding: 0;\r\n      display: flex;\r\n      justify-content: center;\r\n   }\r\n`;\r\nconst ButtonBox = styled.div`\r\n    width: ${`${window.innerWidth}px`};\r\n    display: flex;\r\n    padding-top: 7px;\r\n    padding-bottom: 7px;\r\n    padding-left: 7px;\r\n    background: ${colorType.grey4};\r\n`;\r\nconst LoadingIcon = () => {\r\n   return (\r\n      <SpinStyled>\r\n         <Icon type='loading' style={{ fontSize: 40, textAlign: 'center', margin: 'auto' }} />\r\n      </SpinStyled>\r\n   );\r\n};\r\nconst SpinStyled = styled.div`\r\n    background: rgba(0, 0, 0, 0.05);\r\n    opacity: 0.7;\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    width: ${`${window.innerWidth}px`};\r\n    height: ${`${window.innerHeight}px`};\r\n    display: flex;\r\n    justify-content: center;\r\n    z-index: 1000;\r\n`;\r\n\r\nexport const reorderDrawingsByDrawingTypeTree = (rows, drawingTypeTree) => {\r\n   let rowsReordered = [];\r\n   drawingTypeTree.forEach(tr => {\r\n      if (tr._rowLevel === 0) {\r\n         rowsReordered = [...rowsReordered, ...rows.filter(r => r._parentRow === tr.id)];\r\n      };\r\n   });\r\n   return rowsReordered;\r\n};\r\nconst getInputDataInitially = (data) => {\r\n\r\n   const { drawingTypeTree } = data.publicSettings;\r\n   const { rows } = data;\r\n   console.log('rows', rows);\r\n   const rowsReordered = reorderDrawingsByDrawingTypeTree(rows, drawingTypeTree);\r\n\r\n   const rowsAllInitToCompareBeforeSave = rows.map(r => ({ ...r }));\r\n\r\n   return {\r\n      rowsAll: rowsReordered,\r\n      rowsAllInit: rowsReordered,\r\n      rowsAllInitToCompareBeforeSave,\r\n      rowsVersionsToSave: [],\r\n      showDrawingsOnly: false,\r\n      drawingTypeTree,\r\n      drawingTypeTreeInit: drawingTypeTree,\r\n      rowsDeleted: [],\r\n      idRowsNew: [],\r\n      rowsUpdatePreRowOrParentRow: {},\r\n      rowsToMoveId: null\r\n   };\r\n};\r\n\r\nconst arrangeDrawingTypeFinal = (stateRow) => {\r\n\r\n   const { rowsAll, showDrawingsOnly, drawingTypeTree } = stateRow;\r\n\r\n   if (showDrawingsOnly === 'sort-data-project') return rowsAll;\r\n   if (showDrawingsOnly === 'group-columns') return rowsAll;\r\n\r\n\r\n   let data = drawingTypeTree.map(e => {\r\n      let obj = { ...e };\r\n      if (obj._rowLevel === 0) {\r\n         let rowsChildren = rowsAll.filter(r => r._parentRow === e.id).map(x => ({ ...x }));\r\n         obj.children = rowsChildren;\r\n      };\r\n      return { ...obj };\r\n   });\r\n\r\n   // currently applied for level 0 only ...\r\n\r\n   return data;\r\n};\r\n\r\nconst getRowsKeyExpanded = (drawingTypeTree) => {\r\n   return drawingTypeTree.map(x => {\r\n      if (x._rowLevel === 0) return x.id;\r\n   });\r\n};\r\n\r\n\r\nconst getHeadersData = (projectData) => {\r\n\r\n   const { publicSettings, userSettings } = projectData;\r\n   let { headers } = publicSettings;\r\n\r\n   let headersShown, headersHidden, colorization, nosColumnFixed;\r\n\r\n   if (!userSettings) {\r\n      headersShown = headers.map(hd => hd.text);\r\n      headersHidden = [];\r\n      colorization = null;\r\n      nosColumnFixed = 0;\r\n   } else {\r\n      headersShown = userSettings.headersShown.map(hd => headers.find(h => h.key === hd).text);\r\n      headersHidden = userSettings.headersHidden.map(hd => headers.find(h => h.key === hd).text);\r\n      colorization = userSettings.colorization;\r\n      nosColumnFixed = userSettings.nosColumnFixed;\r\n   };\r\n\r\n   return {\r\n      headersShown,\r\n      nosColumnFixed,\r\n      headersHidden,\r\n      colorization,\r\n   };\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\contexts\\_createDataContext.js",["231"],"import React, { createContext, useReducer } from 'react';\r\n\r\n\r\nexport default (reducer, actions, initValue) => {\r\n\r\n    const Context = createContext();\r\n\r\n    const Provider = ({ children }) => {\r\n        const [state, dispatch] = useReducer(reducer, initValue);\r\n\r\n        const boundActions = {};\r\n        for (let key in actions) {\r\n            boundActions[key] = actions[key](dispatch);\r\n        };\r\n\r\n        return (\r\n            <Context.Provider value={{ state, ...boundActions }}>\r\n                {children}\r\n            </Context.Provider>\r\n        );\r\n    };\r\n    return { Context, Provider };\r\n};\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelSetting.jsx",["232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249"],"import { Button, Input } from 'antd';\r\nimport Axios from 'axios';\r\nimport _, { debounce } from 'lodash';\r\nimport moment from 'moment';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport { SERVER_URL } from '../../constants';\r\nimport { Context as CellContext } from '../../contexts/cellContext';\r\nimport { Context as ProjectContext } from '../../contexts/projectContext';\r\nimport { Context as RowContext } from '../../contexts/rowContext';\r\nimport { convertCellTempToHistory, convertDrawingVersionToHistory, extractCellInfo, mongoObjectId, reorderRowsFnc } from '../../utils';\r\nimport { reorderDrawingsByDrawingTypeTree } from '../PageSpreadsheet';\r\nimport ColorizedForm from './ColorizedForm';\r\nimport FormCellColorizedCheck from './FormCellColorizedCheck';\r\nimport FormDateAutomation from './FormDateAutomation';\r\nimport FormDrawingTypeOrder from './FormDrawingTypeOrder';\r\nimport FormFilter from './FormFilter';\r\nimport FormGroup from './FormGroup';\r\nimport FormSort from './FormSort';\r\nimport PanelConfirm from './PanelConfirm';\r\nimport ReorderColumnForm from './ReorderColumnForm';\r\nimport TableActivityHistory from './TableActivityHistory';\r\nimport TableCellHistory from './TableCellHistory';\r\nimport TableDrawingDetail from './TableDrawingDetail';\r\n\r\nconst genId = (xxx) => {\r\n   let arr = [];\r\n   for (let i = 0; i < xxx; i++) {\r\n      arr.push(mongoObjectId());\r\n   };\r\n   return arr;\r\n};\r\n\r\n\r\nconst PanelSetting = (props) => {\r\n\r\n   const { state: stateRow, getSheetRows } = useContext(RowContext);\r\n   const { state: stateProject } = useContext(ProjectContext);\r\n   const { state: stateCell, getCellModifiedTemp, OverwriteCellsModified } = useContext(CellContext);\r\n\r\n   const { panelType, panelSettingType, commandAction, onClickCancelModal, setLoading } = props;\r\n\r\n   useEffect(() => {\r\n      if (panelSettingType === 'save-every-20min') {\r\n         saveDataToServer();\r\n      };\r\n   }, []);\r\n\r\n\r\n   const applyReorderColumns = (data) => {\r\n      commandAction({ type: 'reorder-columns', data });\r\n   };\r\n   const applyFilter = (data) => {\r\n      commandAction({ type: 'filter-by-columns', data });\r\n   };\r\n   const applySort = ({ type, rowsOutput: data }) => {\r\n      commandAction({\r\n         type: type === 'Sort Rows In Drawing Type' ? 'sort-data-drawing-type' : 'sort-data-project',\r\n         data,\r\n      });\r\n   };\r\n   const applyResetFilter = debounce(() => {\r\n      commandAction({ type: 'reset-filter-sort' });\r\n   }, 7);\r\n\r\n\r\n   const applyGroup = (data) => {\r\n      commandAction({ type: 'group-columns', data });\r\n   };\r\n\r\n\r\n\r\n   const [nosOfRows, setNosOfRows] = useState(1);\r\n   const onClickInsertRow = () => {\r\n      let { rowsAll, idRowsNew, rowsUpdatePreRowOrParentRow } = stateRow;\r\n\r\n      let idsArr = genId(nosOfRows);\r\n\r\n      idRowsNew = [...idRowsNew, ...idsArr];\r\n\r\n      let newRows = [];\r\n      let rowBelow;\r\n      if (panelSettingType === 'Insert Drawings Below') {\r\n         let rowAbove = panelType.cellProps.rowData;\r\n         newRows = idsArr.map((id, i) => {\r\n            return ({\r\n               id,\r\n               _rowLevel: 1,\r\n               _parentRow: rowAbove._parentRow,\r\n               _preRow: i === 0 ? rowAbove.id : idsArr[i - 1]\r\n            });\r\n         });\r\n\r\n         rowBelow = rowsAll.find(r => r._preRow === rowAbove.id);\r\n         if (rowBelow) {\r\n            rowBelow._preRow = idsArr[idsArr.length - 1];\r\n         };\r\n\r\n      } else if (panelSettingType === 'Insert Drawings Above') {\r\n         let rowBelow = panelType.cellProps.rowData;\r\n         newRows = idsArr.map((id, i) => {\r\n            return ({\r\n               id,\r\n               _rowLevel: 1,\r\n               _parentRow: rowBelow._parentRow,\r\n               _preRow: i === 0 ? rowBelow._preRow : idsArr[i - 1]\r\n            });\r\n         });\r\n         rowBelow._preRow = idsArr[idsArr.length - 1];\r\n      };\r\n\r\n      if (rowBelow) {\r\n         rowsUpdatePreRowOrParentRow[rowBelow.id] = {\r\n            _preRow: rowBelow._preRow, _parentRow: rowBelow._parentRow, id: rowBelow.id\r\n         };\r\n      };\r\n      newRows.forEach(r => {\r\n         rowsUpdatePreRowOrParentRow[r.id] = {\r\n            _preRow: r._preRow, _parentRow: r._parentRow, id: r.id\r\n         };\r\n      });\r\n\r\n      rowsAll = [...rowsAll, ...newRows];\r\n\r\n      commandAction({\r\n         type: 'insert-drawings',\r\n         data: {\r\n            rowsAll: reorderRowsFnc(rowsAll),\r\n            rowsUpdatePreRowOrParentRow,\r\n            idRowsNew\r\n         }\r\n      });\r\n   };\r\n\r\n   const [nosOfRowsSub, setNosOfRowsSub] = useState(1);\r\n   const onClickFolderInsertSubRows = () => {\r\n      let { rowsAll, idRowsNew, rowsUpdatePreRowOrParentRow } = stateRow;\r\n\r\n      let idsArr = genId(nosOfRowsSub);\r\n      idRowsNew = [...idRowsNew, ...idsArr];\r\n\r\n      let newRows = idsArr.map((id, i) => {\r\n         return ({\r\n            id,\r\n            _rowLevel: 1,\r\n            _parentRow: panelType.cellProps.rowData.id,\r\n            _preRow: i === 0 ? null : idsArr[i - 1]\r\n         });\r\n      });\r\n      newRows.forEach(r => {\r\n         rowsUpdatePreRowOrParentRow[r.id] = {\r\n            _preRow: r._preRow, _parentRow: r._parentRow, id: r.id\r\n         };\r\n      });\r\n      let rowBelow = rowsAll.find(r => r._parentRow === panelType.cellProps.rowData.id && r._preRow === null);\r\n      if (rowBelow) {\r\n         rowBelow._preRow = idsArr[idsArr.length - 1];\r\n         rowsUpdatePreRowOrParentRow[rowBelow.id] = {\r\n            _preRow: rowBelow._preRow, _parentRow: rowBelow._parentRow, id: rowBelow.id\r\n         };\r\n      };\r\n      rowsAll = [...rowsAll, ...newRows];\r\n\r\n      commandAction({\r\n         type: 'insert-drawings-by-folder',\r\n         data: {\r\n            rowsAll: reorderRowsFnc(rowsAll),\r\n            rowsUpdatePreRowOrParentRow,\r\n            idRowsNew\r\n         }\r\n      });\r\n   };\r\n\r\n   const applyDateAutomation = (dateAutomation) => {\r\n      let { rowsAll } = stateRow;\r\n      const rowId = panelType.cellProps.rowData.id;\r\n      let row = rowsAll.find(r => r.id === rowId);\r\n\r\n      Object.keys(dateAutomation).forEach(key => {\r\n         const cellTempId = `${rowId}-${key}`;\r\n         const dateConverted = moment(dateAutomation[key]).format('DD/MM/YY');\r\n         getCellModifiedTemp({ [cellTempId]: dateConverted });\r\n         row[key] = dateConverted;\r\n      });\r\n\r\n      commandAction({\r\n         type: 'drawing-data-automation',\r\n         data: rowsAll\r\n      });\r\n   };\r\n\r\n   const createNewDrawingRevision = () => {\r\n      const arrHeadersGoBlank = [\r\n         'Model Start (T)', 'Model Start (A)', 'Model Finish (T)', 'Model Finish (A)', 'Drawing Start (T)', 'Drawing Start (A)',\r\n         'Drawing Finish (T)', 'Drawing Finish (A)', 'Drg To Consultant (T)', 'Drg To Consultant (A)', 'Consultant Reply (T)',\r\n         'Consultant Reply (A)', 'Get Approval (T)', 'Get Approval (A)', 'Construction Issuance Date', 'Construction Start', 'Rev', 'Status'\r\n      ];\r\n\r\n      let { rowsAll } = stateRow;\r\n      const rowId = panelType.cellProps.rowData.id;\r\n      let row = rowsAll.find(r => r.id === rowId);\r\n      let rowOldVersiontoSave = { ...row };\r\n\r\n      arrHeadersGoBlank.forEach(hd => {\r\n         const cellTempId = `${rowId}-${hd}`;\r\n         getCellModifiedTemp({ [cellTempId]: '' });\r\n         row[hd] = '';\r\n      });\r\n\r\n      commandAction({\r\n         type: 'create-new-drawing-revisions',\r\n         data: {\r\n            rowsAll,\r\n            rowsVersionsToSave: [...stateRow.rowsVersionsToSave || [], rowOldVersiontoSave]\r\n         }\r\n      });\r\n   };\r\n\r\n   const setCellHistoryArr = debounce((data) => {\r\n      commandAction({ type: 'highlight-cell-history', data });\r\n   }, 7);\r\n\r\n   const deleteDrawing = () => {\r\n      let { rowsAll, idRowsNew, rowsUpdatePreRowOrParentRow, rowsDeleted } = stateRow;\r\n      const { cellsModifiedTemp } = stateCell;\r\n      const rowId = panelType.cellProps.rowData.id;\r\n\r\n      let rowBelow = rowsAll.find(r => r._preRow === rowId);\r\n      if (rowBelow) {\r\n         rowBelow._preRow = panelType.cellProps.rowData._preRow;\r\n         rowsUpdatePreRowOrParentRow[rowBelow.id] = {\r\n            _preRow: rowBelow._preRow, _parentRow: rowBelow._parentRow, id: rowBelow.id\r\n         };\r\n      };\r\n\r\n      if (rowId in rowsUpdatePreRowOrParentRow) delete rowsUpdatePreRowOrParentRow[rowId];\r\n      rowsAll = rowsAll.filter(r => r.id !== rowId);\r\n\r\n      if (idRowsNew.indexOf(rowId) === -1) {\r\n         rowsDeleted = [...rowsDeleted, panelType.cellProps.rowData];\r\n      } else {\r\n         idRowsNew.splice(idRowsNew.indexOf(rowId), 1);\r\n      };\r\n      \r\n      Object.keys(cellsModifiedTemp).forEach(key => {\r\n         if (key.slice(0, 24) === rowId) {  // deleted cells modified temporary...\r\n            delete cellsModifiedTemp[key];\r\n         };\r\n      });\r\n      OverwriteCellsModified({ ...cellsModifiedTemp });\r\n\r\n      commandAction({\r\n         type: 'delete-drawing',\r\n         data: {\r\n            rowsAll,\r\n            rowsUpdatePreRowOrParentRow,\r\n            rowsDeleted,\r\n            idRowsNew,\r\n         }\r\n      });\r\n   };\r\n\r\n   const applyFolderOrganize = (drawingTypeTreeNew) => {\r\n      let { drawingTypeTree, rowsAll, rowsDeleted, idRowsNew, rowsUpdatePreRowOrParentRow } = stateRow;\r\n\r\n      drawingTypeTree.forEach(r => { // find deleted folder\r\n         let folder = drawingTypeTreeNew.find(row => row.id === r.id);\r\n         if (!folder && r._rowLevel === 0) { // save to deleted rows\r\n            let rowsChildren = rowsAll.filter(row => row._parentRow === r.id);\r\n            rowsChildren.forEach(rrr => {\r\n               if (idRowsNew.indexOf(rrr.id) === -1) {\r\n                  rowsDeleted = [...rowsDeleted, rrr];\r\n               } else {\r\n                  idRowsNew.splice(idRowsNew.indexOf(rrr.id), 1);\r\n               };\r\n               if (rrr.id in rowsUpdatePreRowOrParentRow) delete rowsUpdatePreRowOrParentRow[rrr.id];\r\n            });\r\n            rowsAll = rowsAll.filter(r => r._parentRow !== r.id);\r\n         };\r\n      });\r\n\r\n      // new drawings\r\n      const drawingTypeL0New = drawingTypeTreeNew.filter(r => !drawingTypeTree.find(row => row.id === r.id));\r\n\r\n      drawingTypeL0New.forEach(row => {\r\n         let idsArr = genId(5);\r\n         idRowsNew = [...idRowsNew, ...idsArr];\r\n         const newRows = idsArr.map((id, i) => {\r\n            return ({\r\n               id,\r\n               _rowLevel: 1,\r\n               _parentRow: row.id,\r\n               _preRow: i === 0 ? null : idsArr[i - 1]\r\n            });\r\n         });\r\n         newRows.forEach(r => {\r\n            rowsUpdatePreRowOrParentRow[r.id] = {\r\n               _preRow: r._preRow, _parentRow: r._parentRow, id: r.id\r\n            };\r\n         });\r\n         rowsAll = [...rowsAll, ...newRows];\r\n      });\r\n\r\n      commandAction({\r\n         type: 'drawing-folder-organization',\r\n         data: {\r\n            rowsAll: reorderDrawingsByDrawingTypeTree(rowsAll, drawingTypeTreeNew),\r\n            rowsUpdatePreRowOrParentRow,\r\n            rowsDeleted,\r\n            idRowsNew,\r\n            drawingTypeTree: drawingTypeTreeNew,\r\n         }\r\n      });\r\n   };\r\n\r\n\r\n\r\n   const saveDataToServer = async () => {\r\n\r\n      const { email, projectId } = stateProject.allDataOneSheet;\r\n      const { headers } = stateProject.allDataOneSheet.publicSettings;\r\n      let { cellsModifiedTemp } = stateCell;\r\n      let {\r\n         rowsVersionsToSave,\r\n         rowsUpdatePreRowOrParentRow,\r\n         rowsAll,\r\n         drawingTypeTreeInit,\r\n         drawingTypeTree,\r\n         rowsDeleted,\r\n         rowsAllInitToCompareBeforeSave\r\n      } = stateRow;\r\n\r\n      try {\r\n         setLoading(true);\r\n         commandAction({ type: 'confirm-save-data' });\r\n\r\n         // GET LATEST ROWS FROM DB\r\n         const resDB = await Axios.get(`${SERVER_URL}/sheet/${projectId}?userId=${email}`);\r\n         let {\r\n            publicSettings: publicSettingsFromDB,\r\n            rows: rowsFromDB,\r\n            userSettings: userSettingsFromDB\r\n         } = resDB.data;\r\n\r\n         let {\r\n            drawingTypeTree: drawingTypeTreeFromDB,\r\n            activityRecorded: activityRecordedFromDB\r\n         } = publicSettingsFromDB;\r\n\r\n\r\n         console.log('rowsUpdatePreRowOrParentRow', rowsUpdatePreRowOrParentRow);\r\n\r\n         rowsFromDB = rowsFromDB.map(r => ({ id: r.id, _preRow: r._preRow, _parentRow: r._parentRow }));\r\n         console.log('rowsFromDB ..........', rowsFromDB);\r\n         // check if row deleted by other users\r\n         let rowsUpdatePreRowOrParentRowArray = Object.values(rowsUpdatePreRowOrParentRow)\r\n            .filter(row => !activityRecordedFromDB.find(r => r.id === row.id && r.action === 'Delete Drawing') ||\r\n               !activityRecordedFromDB.find(r => r.id === row._parentRow && r.action === 'Delete Drawing Type'));\r\n         \r\n         let arrID = [];\r\n         rowsFromDB.forEach(r => {\r\n            if (rowsUpdatePreRowOrParentRowArray.find(row => row.id === r.id)) {\r\n               arrID.push(r.id);\r\n               let rowBelow = rowsFromDB.find(rrr => rrr._preRow === r.id);\r\n               if (rowBelow) rowBelow._preRow = r._preRow;\r\n            };\r\n         });\r\n         rowsFromDB = rowsFromDB.filter(r => arrID.indexOf(r.id) === -1);\r\n\r\n         \r\n         let rowsInNewParent = rowsUpdatePreRowOrParentRowArray.filter(r => !drawingTypeTreeFromDB.find(tr => tr.id === r._parentRow && tr._rowLevel === 0));\r\n         let rowsInOldParent = rowsUpdatePreRowOrParentRowArray.filter(r => drawingTypeTreeFromDB.find(tr => tr.id === r._parentRow && tr._rowLevel === 0));\r\n         console.log('rowsInNewParent ..........rowsInOldParent', rowsInNewParent, rowsInOldParent);\r\n         let rowsInOldParentOutput = chainRow(rowsInOldParent);\r\n         console.log('rowsInOldParentOutput ..........', rowsInOldParentOutput);\r\n         rowsInOldParentOutput.forEach(arrChain => {\r\n            let rowFirst = arrChain[0];\r\n            let rowAbove = rowsFromDB.find(r => r.id === rowFirst._preRow);\r\n            let parentRowInDB = drawingTypeTreeFromDB.find(tr => tr.id === arrChain[0]._parentRow && tr._rowLevel === 0);\r\n\r\n            if (rowAbove) {\r\n               if (rowAbove._parentRow !== rowFirst._parentRow) {\r\n                  let lastRowInParent = rowsFromDB.find(r => r._parentRow === parentRowInDB.id && !rowsFromDB.find(x => x._preRow === r.id));\r\n                  rowFirst._preRow = lastRowInParent ? lastRowInParent.id : null;\r\n                  rowsFromDB = [...rowsFromDB, ...arrChain];\r\n               } else {\r\n                  let rowBelowRowAbove = rowsFromDB.find(r => r._preRow === rowAbove.id);\r\n                  if (rowBelowRowAbove) rowBelowRowAbove._preRow = arrChain[arrChain.length - 1].id;\r\n                  rowFirst._preRow = rowAbove.id;\r\n                  rowsFromDB = [...rowsFromDB, ...arrChain];\r\n               };\r\n            } else {\r\n               let lastRowInParent = rowsFromDB.find(r => r._parentRow === parentRowInDB.id && !rowsFromDB.find(x => x._preRow === r.id));\r\n               rowFirst._preRow = lastRowInParent ? lastRowInParent.id : null;\r\n               rowsFromDB = [...rowsFromDB, ...arrChain];\r\n            };\r\n         });\r\n         console.log('rowsFromDBtgttgt ............', rowsFromDB, rowsInNewParent.map(r => r._parentRow));\r\n\r\n         let idsNewParentArray = [...new Set(rowsInNewParent.map(r => r._parentRow))];\r\n         console.log('idsNewParentArray', idsNewParentArray);\r\n\r\n         idsNewParentArray.forEach(idP => {\r\n            let ccc = rowsInNewParent.filter(r => r._parentRow === idP);\r\n            console.log(ccc);\r\n            let rowsChildren = _processRows1(ccc);\r\n            console.log('er', rowsChildren);\r\n            rowsChildren.forEach((r, i) => {\r\n               r._preRow = i === 0 ? null : rowsChildren[i - 1].id;\r\n            });\r\n            rowsFromDB = [...rowsFromDB, ...rowsChildren];\r\n         });\r\n\r\n         console.log('rowsFromDB333333 ............', rowsFromDB);\r\n\r\n         // DELETE ROWS ------------------------------------->>>>> DONE\r\n         let rowDeletedFinal = [];\r\n         rowsDeleted.forEach(row => {\r\n            let rowInDB = rowsFromDB.find(r => r.id === row.id);\r\n            if (rowInDB) {\r\n               let rowBelow = rowsFromDB.find(r => r._preRow === rowInDB.id);\r\n               if (rowBelow) rowBelow._preRow = rowInDB._preRow;\r\n               rowDeletedFinal.push(rowInDB);\r\n            };\r\n         });\r\n\r\n         rowsFromDB = rowsFromDB.filter(r => !rowDeletedFinal.find(x => x.id === r.id));\r\n\r\n         if (rowDeletedFinal.length > 0) {\r\n            await Axios.post(\r\n               `${SERVER_URL}/sheet/delete-rows/${projectId}?userId=${email}`,\r\n               rowDeletedFinal.map(r => r.id)\r\n            );\r\n         };\r\n\r\n\r\n         // SAVE CELL HISTORY\r\n         if (!_.isEmpty(cellsModifiedTemp)) {\r\n            Object.keys(cellsModifiedTemp).forEach(key => {\r\n               let rowId = key.slice(0, 24);\r\n               if (activityRecordedFromDB.find(x => x.id === rowId && x.action === 'Delete Drawing')) {\r\n                  delete cellsModifiedTemp[key];\r\n               };\r\n            });\r\n            await Axios.post(`${SERVER_URL}/cell/history/${projectId}`,\r\n               convertCellTempToHistory(cellsModifiedTemp, stateProject)\r\n            );\r\n         };\r\n\r\n         // SAVE DRAWINGS NEW VERSION ------------------------------------->>>>> DONE\r\n         rowsVersionsToSave = rowsVersionsToSave.filter(row => !activityRecordedFromDB.find(r => r.id === row.id && r.action === 'Delete Drawing'));\r\n         if (rowsVersionsToSave.length > 0) {\r\n            await Axios.post(`${SERVER_URL}/row/history/${projectId}?userId=${email}`,\r\n               convertDrawingVersionToHistory(rowsVersionsToSave, stateProject)\r\n            );\r\n         };\r\n\r\n\r\n\r\n         const headerKeyDrawingNumber = headers.find(hd => hd.text === 'Drawing Number').key;\r\n         const headerKeyDrawingName = headers.find(hd => hd.text === 'Drawing Name').key;\r\n         // SAVE PUBLIC SETTINGS RECORDED\r\n         let activityRecordedArr = [];\r\n         drawingTypeTree.forEach(fd => {   //------------------------------------->>>>> DONE\r\n            if (!drawingTypeTreeInit.find(e => e.id === fd.id)) {\r\n               activityRecordedArr.push({\r\n                  id: fd.id, email, createdAt: new Date(), action: 'Create Drawing Type',\r\n                  [headerKeyDrawingNumber]: fd['Drawing Number'],\r\n               });\r\n            };\r\n         });\r\n         drawingTypeTreeInit.forEach(fd => { //------------------------------------->>>>> DONE\r\n            if (\r\n               !drawingTypeTree.find(e => e.id === fd.id) &&\r\n               !activityRecordedFromDB.find(e => e.id === fd.id && e.action === 'Delete Drawing Type')\r\n            ) {\r\n               activityRecordedArr.push({\r\n                  id: fd.id, email, createdAt: new Date(), action: 'Delete Drawing Type',\r\n                  [headerKeyDrawingNumber]: fd['Drawing Number'],\r\n               });\r\n            };\r\n         });\r\n         rowDeletedFinal.forEach(r => { //------------------------------------->>>>> DONE\r\n            activityRecordedArr.push({\r\n               id: r.id, email, createdAt: new Date(), action: 'Delete Drawing',\r\n               [headerKeyDrawingNumber]: r['Drawing Number'],\r\n               [headerKeyDrawingName]: r['Drawing Name'],\r\n            });\r\n         });\r\n\r\n         // SAVE PUBLIC DRAWING TYPE //------------------------------------->>>>> DONE\r\n         drawingTypeTreeFromDB.forEach(fd => {\r\n            if (!drawingTypeTreeInit.find(e => e.id === fd.id)) {\r\n               drawingTypeTree.push(fd); // new from DB, added by other user ...\r\n            };\r\n         });\r\n         drawingTypeTree.forEach(fd => { // check in recorded if some folder deleted ...\r\n            if (activityRecordedFromDB.find(r => r.id === fd.id && r.action === 'Delete Drawing Type')) {\r\n               drawingTypeTree = drawingTypeTree.filter(e => e.id !== fd.id);\r\n            };\r\n         });\r\n         drawingTypeTree.forEach(tr => {\r\n            headers.forEach(hd => {\r\n               if (hd.text in tr) {\r\n                  tr[hd.key] = tr[hd.text];\r\n                  delete tr[hd.text];\r\n               };\r\n            });\r\n         });\r\n         await Axios.post(`${SERVER_URL}/sheet/update-setting-public/${projectId}?userId=${email}`,\r\n            {\r\n               drawingTypeTree,\r\n               activityRecorded: [...activityRecordedFromDB, ...activityRecordedArr]\r\n            }\r\n         );\r\n\r\n\r\n\r\n\r\n         // SAVE DRAWINGS DATA\r\n         console.log('rowsFromDB .........222.', rowsFromDB);\r\n         rowsFromDB.forEach(row => {\r\n            row.preRow = row._preRow;\r\n            delete row._preRow;\r\n            row.parentRow = row._parentRow;\r\n            delete row._parentRow;\r\n            row._id = row.id;\r\n            delete row.id;\r\n\r\n            Object.keys(cellsModifiedTemp).forEach(key => {\r\n               const { rowId, headerName } = extractCellInfo(key);\r\n               let headerKey = headers.find(hd => hd.text === headerName).key;\r\n               if (rowId === row.id) {\r\n                  row.data = { ...row.data || {}, [headerKey]: cellsModifiedTemp[key] }\r\n               };\r\n            });\r\n         });\r\n\r\n      \r\n         console.log('before saveeee .........222.', rowsFromDB);\r\n         await Axios.post(\r\n            `${SERVER_URL}/sheet/update-rows/${projectId}`,\r\n            { rows: rowsFromDB }\r\n         );\r\n         \r\n\r\n\r\n         await Axios.post( // SAVE SETTINGS ..........................\r\n            `${SERVER_URL}/sheet/update-setting-user/${projectId}?userId=${email}`,\r\n            {\r\n               headersShown: stateProject.userData.headersShown.map(hd => headers.find(h => h.text === hd).key),\r\n               headersHidden: stateProject.userData.headersHidden.map(hd => headers.find(h => h.text === hd).key),\r\n               nosColumnFixed: stateProject.userData.nosColumnFixed,\r\n               colorization: stateProject.userData.colorization,\r\n            }\r\n         );\r\n\r\n\r\n         commandAction({ type: 'save-data-successfully' });\r\n\r\n         const res = await Axios.get(`${SERVER_URL}/sheet/${projectId}?userId=${email}`);\r\n\r\n         commandAction({ type: 'reload-data-from-server', data: res.data });\r\n\r\n      } catch (err) {\r\n         commandAction({ type: 'save-data-failure' });\r\n         console.log(err);\r\n      };\r\n   };\r\n\r\n\r\n\r\n   const applyColorization = (data) => {\r\n      commandAction({ type: 'drawing-colorized', data });\r\n   };\r\n\r\n\r\n\r\n   return (\r\n      <>\r\n         {panelSettingType === 'save-ICON' && (\r\n            <PanelConfirm\r\n               onClickCancel={onClickCancelModal}\r\n               onClickApply={saveDataToServer}\r\n            />\r\n         )}\r\n\r\n         {panelSettingType === 'filter-ICON' && (\r\n            <FormFilter applyFilter={applyFilter} onClickCancelModal={onClickCancelModal} />\r\n         )}\r\n\r\n         {panelSettingType === 'rollback-ICON' && (\r\n            <PanelConfirm\r\n               onClickCancel={onClickCancelModal}\r\n               onClickApply={applyResetFilter}\r\n            />\r\n         )}\r\n\r\n         {panelSettingType === 'reorderColumn-ICON' && (\r\n            <ReorderColumnForm\r\n               applyReorderColumns={applyReorderColumns}\r\n               onClickCancelModal={onClickCancelModal}\r\n            />\r\n         )}\r\n\r\n\r\n\r\n         {panelSettingType === 'sort-ICON' && (\r\n            <FormSort applySort={applySort} onClickCancel={onClickCancelModal} />\r\n         )}\r\n\r\n\r\n         {panelSettingType === 'group-ICON' && (\r\n            <FormGroup applyGroup={applyGroup} onClickCancelModal={onClickCancelModal} />\r\n         )}\r\n\r\n\r\n         {(panelSettingType === 'Insert Drawings Below' || panelSettingType === 'Insert Drawings Above') && (\r\n            <div>\r\n               <Input\r\n                  placeholder='Enter Number Of Drawings...'\r\n                  type='number' min='1'\r\n                  value={nosOfRows}\r\n                  onChange={(e) => setNosOfRows(e.target.value)}\r\n                  style={{\r\n                     marginBottom: 20\r\n                  }}\r\n               />\r\n               <Button onClick={onClickInsertRow}>Apply</Button>\r\n            </div>\r\n         )}\r\n\r\n         {panelSettingType === 'history-ICON' && (\r\n            <TableActivityHistory />\r\n         )}\r\n\r\n         {panelSettingType === 'color-cell-history-ICON' && (\r\n            <FormCellColorizedCheck setCellHistoryArr={setCellHistoryArr} />\r\n         )}\r\n\r\n\r\n         {panelSettingType === 'Date Automation' && (\r\n            <FormDateAutomation applyDateAutomation={applyDateAutomation} />\r\n         )}\r\n\r\n         {panelSettingType === 'Create New Drawing Revision' && (\r\n            <PanelConfirm\r\n               onClickCancel={onClickCancelModal}\r\n               onClickApply={createNewDrawingRevision}\r\n            />\r\n         )}\r\n\r\n         {panelSettingType === 'View Drawing Revision' && (\r\n            <TableDrawingDetail {...panelType.cellProps} />\r\n         )}\r\n\r\n         {panelSettingType === 'addDrawingType-ICON' && (\r\n            <FormDrawingTypeOrder applyFolderOrganize={applyFolderOrganize} onClickCancelModal={onClickCancelModal} />\r\n         )}\r\n\r\n         {panelSettingType === 'View Cell History' && (\r\n            <TableCellHistory {...panelType.cellProps} />\r\n         )}\r\n\r\n\r\n         {panelSettingType === 'Delete Drawing' && (\r\n            <PanelConfirm\r\n               onClickCancel={onClickCancelModal}\r\n               onClickApply={deleteDrawing}\r\n               content={`Are you sure to delete the: ${panelType.cellProps.rowData['Drawing Number'] || ' '}-${panelType.cellProps.rowData['Drawing Name'] || ' '} ?`}\r\n            />\r\n         )}\r\n\r\n         {panelSettingType === 'colorized-ICON' && (\r\n            <ColorizedForm applyColorization={applyColorization} onClickCancelModal={onClickCancelModal} />\r\n         )}\r\n\r\n         {panelSettingType === 'Insert Drawings By Type' && (\r\n            <div>\r\n               <Input\r\n                  placeholder='Enter Number Of Drawings...'\r\n                  type='number' min='1'\r\n                  value={nosOfRowsSub}\r\n                  onChange={(e) => setNosOfRowsSub(e.target.value)}\r\n                  style={{\r\n                     marginBottom: 20\r\n                  }}\r\n               />\r\n               <Button onClick={onClickFolderInsertSubRows}>Apply</Button>\r\n            </div>\r\n         )}\r\n\r\n\r\n      </>\r\n   );\r\n};\r\n\r\nexport default PanelSetting;\r\n\r\n\r\nfunction chainRow(rows) {\r\n   let chains = [];\r\n\r\n   rows.forEach(row => {\r\n      let newChain = [row];\r\n\r\n      chains.forEach((chain, index) => {\r\n         if (chain[0]._preRow == row.id) {\r\n            newChain = newChain.concat(chain);\r\n            chains.splice(index, 1);\r\n         };\r\n\r\n         if (chain[chain.length - 1].id === row._preRow) {\r\n            newChain = chain.concat(newChain);\r\n            chains.splice(index, 1);\r\n         };\r\n      });\r\n\r\n      chains.push(newChain);\r\n   });\r\n\r\n   return chains;\r\n};\r\n\r\n\r\n\r\nlet exampleInputRows = [\r\n   { id: 'id6', _preRow: 'id3' },\r\n   { id: 'id1', _preRow: 'id9' },\r\n   { id: 'id7', _preRow: null },\r\n   { id: 'idrrrr7', _preRow: 'id344444444444' },\r\n   \r\n   \r\n   { id: 'id2', _preRow: 'id99' },\r\n   { id: 'id3', _preRow: 'id1' },\r\n   { id: 'id344444444444', _preRow: 'id4' },\r\n   \r\n   { id: 'id4', _preRow: 'id777' },\r\n   \r\n   { id: 'id8', _preRow: 'id2' },\r\n   { id: 'id10', _preRow: 'id5' },\r\n   { id: 'id10777777777', _preRow: 'id9' },\r\n   \r\n   \r\n   { id: 'id9', _preRow: null },\r\n   { id: 'id5', _preRow: 'id899' },\r\n   { id: 'id5555555', _preRow: 'id3' },\r\n   \r\n   { id: 'id777777777777777', _preRow: 'id10' },\r\n];\r\nlet exampleInputRowsrrrrr = [\r\n   { id: 'uuuuuuuuuuuuuu', _preRow: 'tg9999' },\r\n   { id: 'id6', _preRow: 'id3' },\r\n   { id: 'id1', _preRow: 'id9' },\r\n   { id: 'id7', _preRow: null },\r\n   { id: 'idrrrr7', _preRow: 'id344444444444' },\r\n   { id: 'tg6777', _preRow: 'tttt' },\r\n\r\n\r\n   { id: 'lam111', _preRow: 'lam444' },\r\n\r\n   { id: 'lam111ggg', _preRow: 'lam444777' },\r\n   \r\n   { id: 'gggggggggg', _preRow: null },\r\n   { id: 'tg9999', _preRow: null },\r\n   { id: 'id2', _preRow: 'id99' },\r\n   { id: 'id3', _preRow: 'id1' },\r\n   { id: 'id344444444444', _preRow: 'id4' },\r\n   \r\n   { id: 'id4', _preRow: 'id777' },\r\n   \r\n   { id: 'id8', _preRow: 'id2' },\r\n   { id: 'id10', _preRow: 'id5' },\r\n   { id: 'id10777777777', _preRow: 'id9' },\r\n   \r\n   \r\n   { id: 'id9', _preRow: null },\r\n   { id: 'id5', _preRow: 'id899' },\r\n   { id: 'id5555555', _preRow: 'id3' },\r\n   \r\n   { id: 'id777777777777777', _preRow: 'id10' },\r\n\r\n   { id: 'tttt', _preRow: 'idrrrr7' },\r\n];\r\n\r\nlet ttttttttttttttttt = [\r\n   { id: 'idrrrr7', _preRow: 'id7' },\r\n   { id: 'fgfg', _preRow: 'idrrrr7' },\r\n   { id: 'id1', _preRow: 'id6' },\r\n   { id: 'id7', _preRow: 'id1' },\r\n   { id: 'eeee', _preRow: '6666t' },\r\n   { id: '6666t', _preRow: 'ttt' },\r\n   { id: 'ttt', _preRow: 'fgfg' },\r\n   { id: 'id6', _preRow: 'id3' },\r\n];\r\n\r\n\r\n// console.log('XXXXXXXXXXXXXXXXX444444444', _processRows1([...exampleInputRows]), _processRows1([...ttttttttttttttttt]));\r\n// console.log('XXXXXXXXXXXXXXXXX444444444', _processChainRows2([...exampleInputRows]), _processChainRows2([...ttttttttttttttttt]));\r\n\r\nconsole.log('XXXXXXXXXXXXXXXXX444444444', _processRows1([...exampleInputRowsrrrrr]), _processChainRows2([...exampleInputRowsrrrrr]));\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction _processRows1(rows) {\r\n   let rowsProcessed = []\r\n \r\n   if (!(rows instanceof Array) || !rows.length) {\r\n     return rowsProcessed\r\n   };\r\n \r\n   // sort & format rows\r\n   let firstRowIndex = rows.findIndex((row) => !row._preRow)\r\n   while (firstRowIndex >= 0) {\r\n     let preRow = rows.splice(firstRowIndex, 1)[0]\r\n     while (preRow) {\r\n       rowsProcessed.push(preRow)\r\n \r\n       let nextRowIndex = rows.findIndex(\r\n         (row) => String(row._preRow) == String(preRow.id)\r\n       )\r\n       if (nextRowIndex >= 0) {\r\n         preRow = rows.splice(nextRowIndex, 1)[0]\r\n       } else {\r\n         preRow = null\r\n       }\r\n     }\r\n     firstRowIndex = rows.findIndex((row) => !row._preRow)\r\n   }\r\n   \r\n   _processRowsLossHead1(rows, rowsProcessed)\r\n \r\n   return rowsProcessed\r\n }\r\n function _processRowsLossHead1(rows, rowsProcessed) {\r\n   if (!rows.length) {\r\n     return\r\n   }\r\n \r\n   let firstRowIndex = rows.findIndex((r) => _filterRowLossPreRow1(r, rows))\r\n   while (firstRowIndex >= 0) {\r\n     let preRow = rows.splice(firstRowIndex, 1)[0]\r\n     while (preRow) {\r\n       rowsProcessed.push(preRow)\r\n \r\n       let nextRowIndex = rows.findIndex(\r\n         (row) => String(row._preRow) == String(preRow.id)\r\n       )\r\n       if (nextRowIndex >= 0) {\r\n         preRow = rows.splice(nextRowIndex, 1)[0]\r\n       } else {\r\n         preRow = null\r\n       }\r\n     }\r\n     firstRowIndex = rows.findIndex((r) => _filterRowLossPreRow1(r, rows))\r\n   }\r\n }\r\n function _filterRowLossPreRow1(row, rows) {\r\n   return rows.every(r => String(row._preRow) != String(r.id))\r\n }\r\n\r\n\r\n \r\n\r\nfunction _processChainRows2(rows) {\r\n   let rowsProcessed = []\r\n \r\n   if (!(rows instanceof Array) || !rows.length) {\r\n     return rowsProcessed\r\n   }\r\n \r\n   // sort & format rows\r\n   let firstRowIndex = rows.findIndex((row) => !row._preRow)\r\n   while (firstRowIndex >= 0) {\r\n     let preRow = rows.splice(firstRowIndex, 1)[0]\r\n     let chain = []\r\n     while (preRow) {\r\n       chain.push(preRow)\r\n \r\n       let nextRowIndex = rows.findIndex(\r\n         (row) => String(row._preRow) == String(preRow.id)\r\n       )\r\n       if (nextRowIndex >= 0) {\r\n         preRow = rows.splice(nextRowIndex, 1)[0]\r\n       } else {\r\n         preRow = null\r\n       }\r\n     }\r\n     rowsProcessed.push(chain)\r\n     firstRowIndex = rows.findIndex((row) => !row._preRow)\r\n   }\r\n   \r\n   _processChainRowsLossHead2(rows, rowsProcessed)\r\n \r\n   return rowsProcessed\r\n }\r\n \r\n function _processChainRowsLossHead2(rows, rowsProcessed) {\r\n   if (!rows.length) {\r\n     return\r\n   }\r\n \r\n   let firstRowIndex = rows.findIndex((r) => _filterRowLossPreRow2(r, rows))\r\n   while (firstRowIndex >= 0) {\r\n     let preRow = rows.splice(firstRowIndex, 1)[0]\r\n     let chain = []\r\n     while (preRow) {\r\n       chain.push(preRow)\r\n \r\n       let nextRowIndex = rows.findIndex(\r\n         (row) => String(row._preRow) == String(preRow.id)\r\n       )\r\n       if (nextRowIndex >= 0) {\r\n         preRow = rows.splice(nextRowIndex, 1)[0]\r\n       } else {\r\n         preRow = null\r\n       }\r\n     }\r\n     rowsProcessed.push(chain)\r\n     firstRowIndex = rows.findIndex((r) => _filterRowLossPreRow2(r, rows))\r\n   }\r\n }\r\n \r\n function _filterRowLossPreRow2(row, rows) {\r\n   return rows.every(r => String(row._preRow) != String(r.id))\r\n }","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\CellHeader.jsx",["250","251","252","253","254","255"],"import React from 'react';\r\n\r\n\r\nconst CellHeader = (props) => {\r\n\r\n    const { className, column, columns, columnIndex, onMouseDownColumnHeader, headerIndex, container } = props;\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                height: '100%',\r\n                width: '100%',\r\n                verticalAlign: 'middle',\r\n            }}\r\n            // onMouseDown={(e) => onMouseDownColumnHeader(e, column.title)}\r\n        >\r\n            {column.title}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CellHeader;\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\Cell.jsx",["256","257","258","259","260","261"],"import moment from 'moment';\r\nimport React, { useContext, useEffect, useRef, useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport { colorType } from '../../constants';\r\nimport { Context as CellContext } from '../../contexts/cellContext';\r\nimport { Context as ProjectContext } from '../../contexts/projectContext';\r\nimport { Context as RowContext } from '../../contexts/rowContext';\r\nimport PanelCalendar from './PanelCalendar';\r\n\r\n\r\n\r\nconst Cell = (props) => {\r\n\r\n    const {\r\n        rowData, column, rowIndex, columnIndex,\r\n        onRightClickCell, setPosition, getCurrentDOMCell\r\n    } = props;\r\n\r\n    let cellData = props.cellData;\r\n    \r\n    if ((column.key.includes('(A)') || \r\n        column.key.includes('(T)') || \r\n        column.key === 'Construction Issuance Date' ||\r\n        column.key === 'Construction Start') && cellData && cellData.length === 10 && cellData.includes('-')) {\r\n            cellData = moment(cellData, 'YYYY-MM-DD').format('DD/MM/YY');\r\n    };\r\n\r\n\r\n    const { state: stateCell, getCellModifiedTemp, setCellActive } = useContext(CellContext);\r\n    const { state: stateProject } = useContext(ProjectContext);\r\n    const { state: stateRow, getSheetRows } = useContext(RowContext);\r\n    let { drawingTypeTree, rowsAll, showDrawingsOnly } = stateRow;\r\n\r\n\r\n    const inputRef = useRef();\r\n    const cellRef = useRef();\r\n    const panelRef = useRef();\r\n    const buttonRef = useRef();\r\n\r\n\r\n \r\n\r\n    const [inputRender, setInputRender] = useState(false);\r\n    const [initValue, setInitValue] = useState(cellData || '');\r\n    const [value, setValue] = useState(cellData || '');\r\n    const [btnShown, setBtnShown] = useState(false);\r\n    const [panelData, setPanelData] = useState(false);\r\n\r\n\r\n    // after keydown ENTER to show input ...\r\n    useEffect(() => {\r\n        if (\r\n            !inputRender &&\r\n            stateCell.cellActive &&\r\n            stateCell.cellActive.rowIndex === rowIndex &&\r\n            stateCell.cellActive.columnIndex === columnIndex &&\r\n            !cellLocked(stateProject.allDataOneSheet.role, column.key, showDrawingsOnly)\r\n        ) {\r\n            setInputRender(true);\r\n        };\r\n    }, [stateCell.cellActive]);\r\n\r\n\r\n    const getCellTempId = () => {\r\n        return `${rowData['id']}-${column.key}`;\r\n    };\r\n    const cellEditDone = (value) => {\r\n        if (rowData._rowLevel === 1) {\r\n\r\n            getCellModifiedTemp({ [getCellTempId()]: value });\r\n            let row = rowsAll.find(r => r.id === rowData.id);\r\n            row[column.key] = value;\r\n            getSheetRows({ ...stateRow, rowsAll });\r\n\r\n        } else {\r\n\r\n            let row = drawingTypeTree.find(x => x.id === rowData.id);\r\n            row[column.key] = value;\r\n            getSheetRows({ ...stateRow, drawingTypeTree });\r\n        };\r\n    };\r\n\r\n\r\n    const onDoubleClick = () => {\r\n        setInputRender(true);\r\n        getCurrentDOMCell();\r\n    };\r\n    const onClick = () => {\r\n        setBtnShown(true);\r\n        if (!inputRender) {\r\n            setPosition({ cell: cellRef.current.parentElement, rowIndex, columnIndex });\r\n        };\r\n    };\r\n    useEffect(() => {\r\n        // FOCUS right after press ENTER...\r\n        if (inputRender) {\r\n            inputRef.current.focus();\r\n        };\r\n    }, [inputRender]);\r\n\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('click', EventClickToHidePanelAndInput);\r\n        return () => document.removeEventListener('click', EventClickToHidePanelAndInput);\r\n    }, []);\r\n    const EventClickToHidePanelAndInput = (e) => {\r\n        if (e.target !== cellRef.current && inputRef.current && e.target !== inputRef.current) {\r\n            setInputRender(false);\r\n        } else if (e.target !== cellRef.current && e.target !== panelRef.current && e.target !== buttonRef.current) {\r\n            setPanelData(false);\r\n        };\r\n    };\r\n\r\n\r\n\r\n    const onMouseLeave = () => {\r\n        setBtnShown(false);\r\n    };\r\n    const onMouseDown = (e) => {\r\n        if (e.button === 2) { // check mouse RIGHT CLICK ...\r\n            // onRightClickCell(e, props);\r\n        };\r\n    };\r\n    const pickDataSelect = (value) => {\r\n        setBtnShown(false);\r\n        setPanelData(false);\r\n        setValue(value);\r\n        if (initValue !== value) {\r\n            cellEditDone(value);\r\n        } else {\r\n            setInputRender(false);\r\n        };\r\n    };\r\n    const pickDate = (value) => {\r\n        setBtnShown(false);\r\n        setPanelData(false);\r\n        setValue(moment(value).format('DD/MM/YY'));\r\n        if (initValue !== value) {\r\n            cellEditDone(moment(value).format('DD/MM/YY'));\r\n        } else {\r\n            setInputRender(false);\r\n        };\r\n    };\r\n\r\n\r\n\r\n    const onChange = (e) => {\r\n        setValue(e.target.value);\r\n    };\r\n    const onBlur = () => {\r\n        if (initValue !== value) {\r\n            cellEditDone(value);\r\n        };\r\n        setInputRender(false);\r\n    };\r\n    // ENTER to hide input after finishing typing ...\r\n    const onKeyPress = (e) => {\r\n        if (\r\n            e.key === 'Enter' &&\r\n            inputRender &&\r\n            stateCell.cellActive &&\r\n            stateCell.cellActive.rowIndex === rowIndex &&\r\n            stateCell.cellActive.columnIndex === columnIndex &&\r\n            !cellLocked(stateProject.allDataOneSheet.role, column.key, showDrawingsOnly)\r\n        ) {\r\n            inputRef.current.blur();\r\n            setCellActive(null);\r\n        };\r\n    };\r\n\r\n\r\n\r\n    return (\r\n        <>\r\n            <div\r\n                ref={cellRef}\r\n                onDoubleClick={onDoubleClick}\r\n                onClick={onClick}\r\n                onMouseLeave={onMouseLeave}\r\n                onMouseDown={onMouseDown}\r\n                style={{\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    padding: 5,\r\n                    position: 'relative',\r\n                    color: 'black',\r\n                    pointerEvents: cellLocked(stateProject.allDataOneSheet.role, column.key, showDrawingsOnly) && 'none',\r\n                    // background: cellBackground(stateProject.allDataOneSheet.role, column.key, rowData._rowLevel) ? '#fafafa' : 'transparent'\r\n                }}\r\n            >\r\n                {inputRender ? (\r\n                    <input\r\n                        value={value}\r\n                        onChange={onChange}\r\n                        onBlur={onBlur}\r\n                        onKeyPress={onKeyPress}\r\n                        ref={inputRef}\r\n                        style={{\r\n                            outline: 'none',\r\n                            border: 'none',\r\n                            background: 'transparent',\r\n                            width: column.width - 30\r\n                        }}\r\n                    />\r\n\r\n                ) : (\r\n                        <div style={{\r\n                            textOverflow: 'ellipsis',\r\n                            overflow: 'hidden',\r\n                            whiteSpace: 'nowrap',\r\n                            width: column.width - 30\r\n                        }}>\r\n                            {\r\n                                stateCell.cellsModifiedTemp[getCellTempId()] ||  // there is modified data\r\n                                (getCellTempId() in stateCell.cellsModifiedTemp && ' ') || // there is modified data === empty\r\n                                cellData // there is no modification\r\n                            }\r\n                        </div>\r\n                    )\r\n                }\r\n\r\n\r\n                {btnShown && !cellBtnDisabled(column.key) && (\r\n                    <div style={{\r\n                        cursor: 'pointer',\r\n                        position: 'absolute',\r\n                        right: 5,\r\n                        top: 5,\r\n                        height: 17,\r\n                        width: 17,\r\n                        backgroundImage: `url('./img/btn-${checkIconBtn(column.key) ? 'calendar2' : 'down2'}.png')`,\r\n                        backgroundSize: 17\r\n                    }}\r\n                        onMouseDown={(e) => {\r\n                            e.stopPropagation();\r\n                            setPanelData(!panelData);\r\n                        }}\r\n                        ref={buttonRef}\r\n                    />\r\n                )}\r\n\r\n\r\n                {panelData && (\r\n                    <div style={{\r\n                        position: 'absolute',\r\n                        background: 'white',\r\n                        top: 30,\r\n                        left: 0,\r\n                        minWidth: column.width,\r\n                        zIndex: 999,\r\n                        padding: '3px 5px 3px 7px',\r\n                        boxShadow: 'rgba(0, 0, 0, 0.09) 0px 2px 1px, rgba(0, 0, 0, 0.09) 0px 4px 2px, rgba(0, 0, 0, 0.09) 0px 8px 4px, rgba(0, 0, 0, 0.09) 0px 16px 8px, rgba(0, 0, 0, 0.09) 0px 32px 16px'\r\n                    }}\r\n                        ref={panelRef}\r\n                    >\r\n                        {checkIconBtn(column.key) ? (\r\n                            <PanelCalendar pickDate={pickDate} />\r\n                        ) : getColumnsValue(rowsAll, column.key).map(item => {\r\n                            return (\r\n                                <SelectStyled\r\n                                    key={item}\r\n                                    onMouseDown={(e) => {\r\n                                        e.stopPropagation();\r\n                                        pickDataSelect(item);\r\n                                    }}\r\n                                >{item}</SelectStyled>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                )}\r\n\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Cell;\r\n\r\nconst SelectStyled = styled.div`\r\n    padding: 4px;\r\n    &:hover {\r\n        background-color: ${colorType.grey4};\r\n        cursor: pointer;\r\n    };\r\n    transition: 0.2s;\r\n`;\r\n\r\nconst checkIconBtn = (header) => {\r\n    return header.includes('(A)') || \r\n        header.includes('(T)') || \r\n        header === 'Construction Issuance Date' ||\r\n        header === 'Construction Start';\r\n};\r\n\r\nconst cellBtnDisabled = (headerId) => {\r\n    if (headerId === 'Index' || headerId === 'Drawing Number' || headerId === 'Drawing Name') return true;\r\n};\r\n\r\nconst getColumnsValue = (rows, headerKey) => {\r\n\r\n    let valueArr = [];\r\n    rows.filter(r => r._rowLevel === 1).forEach(row => {\r\n        valueArr.push(row[headerKey]);\r\n    });\r\n    valueArr = [...new Set(valueArr)].filter(e => e);\r\n    valueArr.sort((a, b) => a > b ? 1 : (b > a ? -1 : 0));\r\n\r\n    if (headerKey === 'Status') return [\r\n        'Not Started',\r\n        '1st cut of model in-progress',\r\n        '1st cut of drawing in-progress',\r\n        'Pending design',\r\n        'Consultant reviewing',\r\n        'Reject and resubmit',\r\n        'Approved with comments, to Resubmit',\r\n        'Revise In-Progress',\r\n        'Approved with Comment, no submission Required',\r\n        'Approved for Construction'\r\n    ];\r\n    return valueArr;\r\n};\r\n\r\nconst colors = {\r\n    red: '#FFDAB9',\r\n    blue: '#AFEEEE',\r\n    brown: '#F0E68C',\r\n    green: '#98FB98',\r\n    white: 'white'\r\n};\r\n\r\n\r\nconst colorizedRows = (colorized, rowData) => {\r\n    if (colorized === 'Rev') {\r\n        return rowData[colorized] === '0' ? colors.red :\r\n            rowData[colorized] === 'A' ? colors.blue :\r\n                rowData[colorized] === 'B' ? colors.brown : colors.white\r\n    } else if (colorized === 'Status') {\r\n        return rowData[colorized] === 'Reject And Resubmit' ? colors.red :\r\n            rowData[colorized] === 'Approved for Construction' ? colors.blue :\r\n                rowData[colorized] === 'Not Started' ? colors.white : colors.green\r\n    } else if (colorized === 'Modeller') {\r\n        return rowData[colorized] === 'Anne' ? colors.red :\r\n            rowData[colorized] === 'Judy' ? colors.blue :\r\n                rowData[colorized] === 'Thomas' ? colors.white : colors.green\r\n    } else if (colorized === 'Coordinator In Charge') {\r\n        return rowData[colorized] === 'Hannah' ? colors.red : colors.white\r\n    };\r\n};\r\n\r\nconst ColumnsLockedModeller = [\r\n    'Drg To Consultant (T)',\r\n    'Drg To Consultant (A)',\r\n    'Consultant Reply (T)',\r\n    'Consultant Reply (A)',\r\n    'Get Approval (T)',\r\n    'Get Approval (A)',\r\n    'Construction Issuance Date',\r\n    'Construction Start',\r\n];\r\nconst cellLocked = (title, column, showDrawingsOnly) => {\r\n    // lock in groups columns mode;\r\n    if (showDrawingsOnly === 'group-columns') return true;\r\n    if (title === 'modeller' && ColumnsLockedModeller.includes(column)) return true;\r\n    if (title === 'coordinator' || title === 'document controller') return false;\r\n    if (title === 'manager' || title === 'viewer') return true;\r\n    if (title === 'production' && column !== 'Construction Start') return true;\r\n};\r\nconst cellBackground = (title, column, rowLevel) => {\r\n    if (rowLevel !== 1) return false;\r\n\r\n    if (title === 'modeller' && ColumnsLockedModeller.includes(column)) return true;\r\n    if (title === 'coordinator' || title === 'document controller') return false;\r\n    if (title === 'manager' || title === 'viewer') return true;\r\n    if (title === 'production' && column !== 'Construction Start') return true;\r\n};\r\n\r\nconst checkIfCellsRangeContainsCell = (cellsRangeStart, cellsRangeEnd, rowIndex, columnIndex) => {\r\n\r\n    let rowMin = cellsRangeStart.rowIndex <= cellsRangeEnd.rowIndex ? cellsRangeStart.rowIndex : cellsRangeEnd.rowIndex;\r\n    let rowMax = cellsRangeStart.rowIndex > cellsRangeEnd.rowIndex ? cellsRangeStart.rowIndex : cellsRangeEnd.rowIndex;\r\n\r\n    let columnMin = cellsRangeStart.columnIndex <= cellsRangeEnd.columnIndex ? cellsRangeStart.columnIndex : cellsRangeEnd.columnIndex;\r\n    let columnMax = cellsRangeStart.columnIndex > cellsRangeEnd.columnIndex ? cellsRangeStart.columnIndex : cellsRangeEnd.columnIndex;\r\n\r\n    return (\r\n        rowIndex >= rowMin &&\r\n        rowIndex <= rowMax &&\r\n        columnIndex >= columnMin &&\r\n        columnIndex <= columnMax\r\n    );\r\n};","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelFunction.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\utils\\index.js",["262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279"],"import _ from 'lodash';\r\n\r\n\r\n\r\n\r\nexport const formatStringNameToId = (str) => {\r\n    let mystring = str\r\n        .replace(/ /g, '')\r\n        .replace(/\\(|\\)/g, '')\r\n        .replace(/\\//g, '');\r\n\r\n    return mystring.charAt(0).toLowerCase() + mystring.slice(1);\r\n};\r\n\r\n\r\n\r\nexport const extractCellInfo = (key) => {\r\n    return {\r\n        rowId: key.slice(0, 24),\r\n        headerName: key.slice(25, key.length)\r\n    }\r\n};\r\n\r\n\r\nexport const mongoObjectId = () => {\r\n    var timestamp = (new Date().getTime() / 1000 | 0).toString(16);\r\n    return timestamp + 'xxxxxxxxxxxxxxxx'.replace(/[x]/g, function () {\r\n        return (Math.random() * 16 | 0).toString(16);\r\n    }).toLowerCase();\r\n};\r\n\r\n\r\nexport const getHeadersText = (headers) => {\r\n    if (!headers) return [];\r\n    let arr = [];\r\n    headers.forEach(hd => {\r\n        arr.push(hd.text);\r\n    });\r\n    return arr;\r\n};\r\n\r\nexport const getHeaderKey = (headers, headerText) => {\r\n    if (!headers) return;\r\n\r\n    return headers.find(hd => hd.text === headerText).key;\r\n};\r\n\r\n\r\n\r\nexport const groupRowsBy = (array, key) => {\r\n\r\n    return array.reduce((result, currentValue) => {\r\n        (result[currentValue[key]] = result[currentValue[key]] || []).push(\r\n            currentValue\r\n        );\r\n\r\n        return result;\r\n    }, {});\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const mapSubRows = (rows) => {\r\n\r\n    if (!rows) return;\r\n\r\n    let rowsArr = rows.filter(r => r._rowLevel === 0);\r\n\r\n    if (rowsArr.length < 1) return rows;\r\n\r\n    let rowsSubArr = rows.filter(r => r._rowLevel === 1);\r\n    if (rowsSubArr.length < 1) return rows;\r\n\r\n    const rowsDataOutput = rowsArr.map(r => {\r\n        let subR = rowsSubArr.filter(rSub => rSub._parentRow === r.id);\r\n        return {\r\n            ...r, children: subR\r\n        }\r\n    });\r\n    return rowsDataOutput;\r\n};\r\n\r\n\r\n\r\n\r\nexport const groupByHeaders = (data, headers) => {\r\n    let res = [];\r\n    let _map = {};\r\n    // push all rowIds have children in here\r\n    let parentIdsArr = [];\r\n    let _mapParentIds = {};\r\n\r\n    for (let item of data) {\r\n        let _prevLevelKey = '';\r\n        let _prevLevelParent = null;\r\n        for (let i = 0, level = 2 - headers.length; i < headers.length; i++, level++) {\r\n            let arrayParent = i == 0 ? res : _prevLevelParent.children;\r\n\r\n            let header = headers[i];\r\n            let value = String(item[header]).trim() || '';\r\n\r\n            let levelKey = `${_prevLevelKey}_._${value}`;\r\n            let levelParentIndex = _map[levelKey];\r\n            let levelParent = arrayParent[levelParentIndex];\r\n\r\n            if (!levelParent) {\r\n                let iddd = mongoObjectId();\r\n                levelParent = _newParent(item, header, level, iddd);\r\n\r\n                _map[levelKey] = arrayParent.length;\r\n                arrayParent.push(levelParent);\r\n            };\r\n\r\n            levelParent.count++;\r\n            // levelParent[header] = `${item[header]}: (${levelParent.count} nos)`;\r\n            levelParent['Drawing Number'] = `${String(item[header]).toUpperCase()}: (${levelParent.count} nos)`;\r\n\r\n            if (!_mapParentIds[levelParent.id]) { // levelParent id not yet been push to parentIdsArr\r\n                parentIdsArr.push(levelParent.id);\r\n                _mapParentIds[levelParent.id] = true;\r\n            }\r\n\r\n            if (i == headers.length - 1) {\r\n                levelParent.children.push(item);\r\n            } else {\r\n                _prevLevelKey = levelKey;\r\n                _prevLevelParent = levelParent;\r\n            };\r\n        };\r\n    };\r\n    return {\r\n        rows: res,\r\n        expandedRows: parentIdsArr\r\n    };\r\n};\r\nfunction _newParent(item, header, level, iddd) {\r\n    return {\r\n        id: iddd,\r\n        _rowLevel: level,\r\n        _src_header: item[header],\r\n        count: 0,\r\n        children: []\r\n    };\r\n};\r\n\r\nconst returnDate = (num) => {\r\n    let date = new Date();\r\n    date.setDate(date.getDate() + num);\r\n    return date;\r\n};\r\n\r\n\r\nexport const convertCellTempToHistory = (\r\n    cellsModifiedTemp,\r\n    stateProject\r\n) => {\r\n    const { email, publicSettings } = stateProject.allDataOneSheet;\r\n\r\n    const cellsHistoryData = Object.keys(cellsModifiedTemp).map(key => {\r\n        const { rowId, headerName } = extractCellInfo(key);\r\n\r\n        const dataOut = {\r\n            rowId,\r\n            headerKey: getHeaderKey(publicSettings.headers, headerName),\r\n            history: {\r\n                text: cellsModifiedTemp[key],\r\n                user: email,\r\n                createdAt: new Date(),\r\n            }\r\n        };\r\n        return dataOut;\r\n    });\r\n    return cellsHistoryData;\r\n};\r\n\r\nexport const convertDrawingVersionToHistory = (\r\n    rowsHistory,\r\n    stateProject\r\n) => {\r\n    const { username, publicSettings } = stateProject.allDataOneSheet;\r\n\r\n    const rowsHistoryOutput = rowsHistory.map(rowsH => {\r\n        let obj = {};\r\n        publicSettings.headers.forEach(hd => {\r\n            if (rowsH[hd.text]) obj = { ...obj || {}, [hd.key]: rowsH[hd.text] };\r\n        });\r\n        return {\r\n            row: rowsH.id,\r\n            history: obj,\r\n            username\r\n        };\r\n    });\r\n    return rowsHistoryOutput;\r\n};\r\n\r\n\r\n\r\n\r\nexport const convertHistoryData = (data) => {\r\n    let arr = [];\r\n    data.forEach(ch => {\r\n        const { histories, headerKey, row } = ch;\r\n        histories.forEach(dt => {\r\n            arr.push({\r\n                ...dt,\r\n                headerKey, row\r\n            });\r\n        });\r\n    });\r\n    return arr\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const addZero = (num) => {\r\n    if (num < 10) return '0' + num;\r\n    return num;\r\n};\r\n\r\nconst getRndInteger = (min, max) => {\r\n    return Math.floor(Math.random() * (max - min)) + min;\r\n};\r\n\r\n\r\nconst findHeaderId = (headers, headerName) => {\r\n    let header = headers.find(hd => hd.text === headerName);\r\n    return header.key;\r\n};\r\n\r\n\r\n\r\nexport const convertHeadersTextToKeyArray = (headersText, headers) => {\r\n\r\n    return headersText.map(hdText => {\r\n        let hdObj = headers.find(hd => hd.text === hdText);\r\n\r\n        return hdObj.key\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\nconst _groupSubRowsByParentId = (subRows) => {\r\n    let groups = {};\r\n    for (let subRow of subRows) {\r\n        let parentId = subRow._parentRow;\r\n        let group = groups[parentId] || [];\r\n        groups[parentId] = group;\r\n        group.push(subRow);\r\n    };\r\n    return groups;\r\n};\r\nconst _filterRows = (rowsData) => {\r\n    let rows = [];\r\n    let subRowsLv1 = [];\r\n    let subRowsLv2 = [];\r\n\r\n    for (let rowData of rowsData) {\r\n        let level = rowData._rowLevel;\r\n        if (level === 0) {\r\n            rows.push(rowData);\r\n        } else if (level == 1) {\r\n            subRowsLv1.push(rowData);\r\n        } else if (level == 2) {\r\n            subRowsLv2.push(rowData);\r\n        };\r\n    };\r\n    return [rows, subRowsLv1, subRowsLv2];\r\n};\r\nexport const sortRowsReorder = (rowsData) => {\r\n    let [rows, subRowsLv1, subRowsLv2] = _filterRows(rowsData);\r\n    let rowsProcessed = [];\r\n    let groupSubRowsLv1 = _groupSubRowsByParentId(subRowsLv1);\r\n    let groupSubRowsLv2 = _groupSubRowsByParentId(subRowsLv2);\r\n\r\n    let firstRowIndex = rows.findIndex((row) => row._preRow === null);\r\n    if (firstRowIndex >= 0) {\r\n        let preRow = rows.splice(firstRowIndex, 1)[0];\r\n        while (preRow) {\r\n            rowsProcessed.push(preRow);\r\n\r\n            // sort & format subRowsLv1\r\n            let subRowsLv1 = groupSubRowsLv1[preRow.id] || [];\r\n            let firstSubRowLv1Index = subRowsLv1.findIndex(\r\n                (sr1) => sr1._preRow == null\r\n            );\r\n            if (firstSubRowLv1Index >= 0) {\r\n                let preSubRowLv1 = subRowsLv1.splice(firstSubRowLv1Index, 1)[0];\r\n                while (preSubRowLv1) {\r\n                    rowsProcessed.push(preSubRowLv1);\r\n\r\n                    // sort & format subRowsLv2\r\n                    let subRowsLv2 = groupSubRowsLv2[preSubRowLv1.id] || [];\r\n                    let firstSubRowLv2Index = subRowsLv2.findIndex(\r\n                        (sr2) => sr2._preRow == null\r\n                    );\r\n                    if (firstSubRowLv2Index >= 0) {\r\n                        let preSubRowLv2 = subRowsLv2.splice(firstSubRowLv2Index, 1)[0];\r\n                        while (preSubRowLv2) {\r\n                            rowsProcessed.push(preSubRowLv2);\r\n\r\n                            let nextSubRowLv2Index = subRowsLv2.findIndex(\r\n                                (sr2) => String(sr2._preRow) == String(preSubRowLv2.id)\r\n                            );\r\n                            if (nextSubRowLv2Index >= 0) {\r\n                                preSubRowLv2 = subRowsLv2.splice(nextSubRowLv2Index, 1)[0];\r\n                            } else {\r\n                                preSubRowLv2 = null;\r\n                            };\r\n                        };\r\n                    };\r\n\r\n                    let nextSubRowLv1Index = subRowsLv1.findIndex(\r\n                        (sr1) => String(sr1._preRow) == String(preSubRowLv1.id)\r\n                    );\r\n                    if (nextSubRowLv1Index >= 0) {\r\n                        preSubRowLv1 = subRowsLv1.splice(nextSubRowLv1Index, 1)[0];\r\n                    } else {\r\n                        preSubRowLv1 = null;\r\n                    };\r\n                };\r\n            };\r\n\r\n            let nextRowIndex = rows.findIndex(\r\n                (row) => String(row._preRow) == String(preRow.id)\r\n            );\r\n            if (nextRowIndex >= 0) {\r\n                preRow = rows.splice(nextRowIndex, 1)[0];\r\n            } else {\r\n                preRow = null;\r\n            };\r\n        };\r\n    };\r\n\r\n    return rowsProcessed;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// WORKING WITH SMARTHSHEET ..................................................................\r\n\r\nexport const getDataConvertedSmartsheet = (projectArray) => {\r\n\r\n    let dataOutput = {};\r\n    for (let i = 0; i < projectArray.length; i++) {\r\n\r\n        // get the column header\r\n        const project = projectArray[i];\r\n        const categoryArray = _.map(project.columns, 'title');\r\n        let columnsIndexArray = {};\r\n        categoryArray.forEach(cate => {\r\n            project.columns.forEach(cl => {\r\n                if (cl.title === cate) columnsIndexArray[cate] = cl.index;\r\n            });\r\n        });\r\n\r\n        let allDrawings = [];\r\n\r\n        for (let i = 0; i < project.rows.length; i++) {\r\n            const dwg = project.rows[i];\r\n            allDrawings.push([...dwg.cells]);\r\n        };\r\n\r\n        dataOutput[project.name.slice(0, project.name.length - 17)] = {\r\n            allDrawings,\r\n            allDrawingsSorted: pickDataToTable(allDrawings, columnsIndexArray)\r\n        };\r\n    };\r\n\r\n    return dataOutput;\r\n};\r\n\r\nconst pickDataToTable = (drawings, columnsIndexArray) => {\r\n    let arrayDrw = [];\r\n    drawings.forEach(dwg => {\r\n        let objDwg = {};\r\n        Object.keys(columnsIndexArray).forEach(header => {\r\n            if (header === 'Rev') {\r\n                objDwg[checkSpelling(header)] = dwg[columnsIndexArray[header]].displayValue;\r\n            } else {\r\n                if (dwg[columnsIndexArray[header]].value) {\r\n                    objDwg[checkSpelling(header)] = dwg[columnsIndexArray[header]].value;\r\n                };\r\n            };\r\n        });\r\n        arrayDrw.push(objDwg);\r\n    });\r\n    return arrayDrw;\r\n};\r\n\r\n\r\nconst checkSpelling = (header) => {\r\n    if (header === 'Construction issuance date') return 'Construction Issuance Date';\r\n    if (header === 'Drg to Consultant (T)') return 'Drg To Consultant (T)';\r\n    if (header === 'Drg to Consultant (A)') return 'Drg To Consultant (A)';\r\n    if (header === 'get Approval (A)') return 'Get Approval (A)';\r\n    if (header === 'get Approval (T)') return 'Get Approval (T)';\r\n    return header;\r\n};\r\n\r\n\r\n\r\nexport const getHeaderWidth = (header) => {\r\n\r\n    if (header === 'RFA Ref') return 170;\r\n    else if (\r\n        header === 'Block/Zone' ||\r\n        header === 'Level' || header === 'Unit/CJ' ||\r\n        header === 'Drg Type' || header === 'Use For' ||\r\n        header === 'Coordinator In Charge' || header === 'Modeller' ||\r\n        header === 'Model Progress' || header === 'Drawing Progress' ||\r\n        header === 'Construction Start'\r\n    ) return 100;\r\n    else if (header === 'Construction Issuance Date') return 120;\r\n    else if (header === 'Drawing') return 100;\r\n\r\n    else if (\r\n        header === 'Drg To Consultant (A)' ||\r\n        header === 'Drg To Consultant (T)' ||\r\n        header === 'Get Approval (A)' ||\r\n        header === 'Get Approval (T)'\r\n    ) return 120;\r\n\r\n    else if (header.includes('(A)') || header.includes('(T)')) return 90;\r\n\r\n\r\n\r\n\r\n    else if (header === 'Rev') return 50;\r\n    else if (header === 'Status') return 280;\r\n    else if (header === 'Remark') return 120;\r\n    else if (header === 'Drawing Number') return 350;\r\n    else if (header === 'Drawing Name') return 450;\r\n    else return 300;\r\n\r\n};\r\n\r\nexport const rowClassNameGetColumnsValue = (rows, headers) => {\r\n    let valueObj = {};\r\n    headers.forEach(hd => {\r\n       let valueArr = rows.map(row => row[hd.text] || '');\r\n       valueArr = [...new Set(valueArr)].filter(e => e);\r\n       valueArr.sort((a, b) => a > b ? 1 : (b > a ? -1 : 0));\r\n       if (valueArr.length > 0) valueObj[hd.text] = valueArr;\r\n    });\r\n    return valueObj;\r\n };\r\nexport const getActionName = (type) => {\r\n    if (type === 'filter-ICON') return 'Create New Filter';\r\n    if (type === 'reorderColumn-ICON') return 'Columns Layout';\r\n    if (type === 'group-ICON') return 'Group Data';\r\n    if (type === 'sort-ICON') return 'Sort Data';\r\n    if (type === 'rollback-ICON') return 'Clear Filter/Sort/Group/Search';\r\n    if (type === 'addDrawingType-ICON') return 'Drawing Type Organization';\r\n    if (type === 'color-cell-history-ICON') return 'Check Data Changed';\r\n    if (type === 'View Cell History') return 'Cell History';\r\n    if (type === 'Delete Drawing') return 'Delete Drawing';\r\n    if (type === 'history-ICON') return 'Activity History';\r\n    if (type === 'colorized-ICON') return 'Drawing Colorization';\r\n    else return '';\r\n};\r\nexport const getModalWidth = (type) => {\r\n    if (type === 'history-ICON') return window.innerWidth * 0.8 + 20;\r\n    else return 520;\r\n};\r\n\r\n\r\n\r\n\r\nconst createParentRows = (arr) => {\r\n    let newRows = [];\r\n    arr.forEach((title, i) => {\r\n        newRows.push({\r\n            id: mongoObjectId(),\r\n            _rowLevel: 0,\r\n            expanded: true,\r\n            'Drawing Number': title\r\n        });\r\n    });\r\n    return newRows;\r\n};\r\nconst getParentRowsHandy = () => {\r\n    let arrParentTitle = [\r\n        'COLUMN AND WALL SETTING OUT Keyplan',\r\n        'UNIT TYPE LAYOUT TSO Plan',\r\n        'STAIRCASES and LIFT LOBBIES',\r\n        'ANCILLARY STRUCTURES',\r\n        'No Name 1',\r\n        'No Name 2',\r\n        'PBU Tile layout',\r\n        'Tile layout',\r\n        'Clubhouse',\r\n        'RCP',\r\n        'RCP Unit type',\r\n        'RCP Clubhouse',\r\n        'Swimming Pool',\r\n        'External Sections/ Elevations',\r\n        'Driveway/ Pavement',\r\n        'No Name 3',\r\n        'No Name 4',\r\n        'Carpark Details',\r\n        'M&E Details',\r\n        'FAADE Maintenance',\r\n        'No Name 5',\r\n        'TOILETS Details',\r\n    ];\r\n    let rows = createParentRows(arrParentTitle);\r\n    return rows;\r\n};\r\nconst getParent_IdHandy = (i) => {\r\n    if (i >= 3 && i <= 47) return 0;\r\n    if (i >= 49 && i <= 94) return 1;\r\n    if (i >= 96 && i <= 147) return 2;\r\n    if (i >= 149 && i <= 162) return 3;\r\n    if (i >= 164 && i <= 168) return 4;\r\n\r\n    if (i >= 170 && i <= 175) return 5;\r\n    if (i >= 177 && i <= 191) return 6;\r\n    if (i >= 193 && i <= 202) return 7;\r\n    if (i >= 204 && i <= 209) return 8;\r\n    if (i >= 211 && i <= 224) return 9;\r\n\r\n    if (i >= 226 && i <= 246) return 10;\r\n    if (i >= 248 && i <= 250) return 11;\r\n    if (i >= 252 && i <= 259) return 12;\r\n    if (i >= 261 && i <= 264) return 13;\r\n    if (i >= 266 && i <= 269) return 14;\r\n    \r\n    if (i >= 271 && i <= 274) return 15;\r\n    if (i >= 276 && i <= 279) return 16;\r\n    if (i >= 281 && i <= 283) return 17;\r\n    if (i >= 285 && i <= 289) return 18;\r\n    if (i >= 291 && i <= 292) return 19;\r\n    \r\n    if (i >= 294 && i <= 296) return 20;\r\n    if (i >= 298 && i <= 306) return 21;\r\n};\r\nconst getParentRowsSumang = () => {\r\n    let arrParentTitle = [\r\n        'GRID LINE',\r\n        'PRE-COMPUTATION',\r\n        'SUBSTATION',\r\n        'BASEMENT',\r\n        'EDECK',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 42(11)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 44(12)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 22(1)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 24(3)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 26(4)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 32(6)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 34(7)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 28(5)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 46(13)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 36(8)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 30(2)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 38(9)',\r\n        'WSO (WALL SETTING-OUT PLANS) - BLK 40(10)',\r\n        'OVERALL FINISHING LAYOUT',\r\n        'SSS (STAIRCASE STOREY SHELTER)',\r\n        'REFLECTED CEILING PLAN',\r\n        'LIFT LOBBY',\r\n    ];\r\n    let rows = createParentRows(arrParentTitle);\r\n    return rows;\r\n};\r\nconst getParent_IdSumang = (i) => {\r\n    if (i >= 3 && i <= 4) return 0;\r\n    if (i >= 6 && i <= 6) return 1;\r\n    if (i >= 8 && i <= 9) return 2;\r\n    if (i >= 11 && i <= 20) return 3;\r\n    if (i >= 22 && i <= 35) return 4;\r\n\r\n    if (i >= 38 && i <= 43) return 5;\r\n    if (i >= 45 && i <= 50) return 6;\r\n    if (i >= 52 && i <= 59) return 7;\r\n    if (i >= 61 && i <= 70) return 8;\r\n    if (i >= 72 && i <= 78) return 9;\r\n\r\n    if (i >= 80 && i <= 85) return 10;\r\n    if (i >= 87 && i <= 92) return 11;\r\n    if (i >= 94 && i <= 100) return 12;\r\n    if (i >= 102 && i <= 107) return 13;\r\n    if (i >= 109 && i <= 114) return 14;\r\n    \r\n    if (i >= 116 && i <= 121) return 15;\r\n    if (i >= 123 && i <= 128) return 16;\r\n    if (i >= 130 && i <= 135) return 17;\r\n    if (i >= 137 && i <= 175) return 18;\r\n    if (i >= 177 && i <= 211) return 19;\r\n    \r\n    if (i >= 213 && i <= 213) return 20;\r\n    if (i >= 216 && i <= 254) return 21;\r\n};\r\n\r\nexport const getCurrentAndHistoryDrawings = (allProjects, headers) => {\r\n    let final = {};\r\n    Object.keys(allProjects).forEach(prj => {\r\n\r\n        let drawingTypeTree = prj === 'Sumang' ? getParentRowsSumang() : getParentRowsHandy();\r\n        drawingTypeTree.forEach(r => {\r\n            let headerKeyDrawingNumber = headers.find(hd => hd.text === 'Drawing Number').key;\r\n            r[headerKeyDrawingNumber] = r['Drawing Number'];\r\n            delete r['Drawing Number'];\r\n        });\r\n\r\n        let rows = prj === 'Sumang' ? allProjects['Sumang'].allDrawingsSorted : allProjects['Handy'].allDrawingsSorted;\r\n\r\n        let objChildren = {};\r\n        rows.forEach((r, i) => {\r\n            const parentIndex = prj === 'Sumang' ? getParent_IdSumang(i + 1) : getParent_IdHandy(i + 1);\r\n            objChildren[parentIndex] = [...objChildren[parentIndex] || [], r];\r\n        });\r\n\r\n        let historyOutput = [];\r\n        let rowsAllCurrentOutput = [];\r\n        Object.keys(objChildren).forEach(index => {\r\n            if (index !== 'undefined') {\r\n                let allRowsInEachFolder = objChildren[index];\r\n                let obj = {};\r\n                allRowsInEachFolder.forEach(r => {\r\n                    const key = `${r['Drawing Number'] || ''}-${r['Drawing Name'] || ''}`;\r\n                    obj[key] = [...obj[key] || [], r];\r\n                });\r\n\r\n                let rowCurrentOutput = [];\r\n                Object.keys(obj).forEach((key, i) => {\r\n                    const arr = obj[key];\r\n                    arr.sort((a, b) => ((a['Rev'] || '').toLowerCase() > (b['Rev'] || '').toLowerCase()) ? 1 : (((b['Rev'] || '').toLowerCase() > (a['Rev'] || '').toLowerCase()) ? -1 : 0));\r\n                    let rowsHistory = arr.filter((r, index) => index < arr.length - 1);\r\n                    let rowId = mongoObjectId();\r\n                    if (rowsHistory.length > 0) {\r\n                        let rowsHistoryOutput = rowsHistory.map(r => {\r\n                            let rowDataObj = { row: rowId };\r\n                            headers.forEach(hd => {\r\n                                if (r[hd.text]) rowDataObj.history = { ...rowDataObj.history || {}, [hd.key]: r[hd.text] };\r\n                            });\r\n                            return rowDataObj;\r\n                        });\r\n                        historyOutput = [...historyOutput, ...rowsHistoryOutput];\r\n                    };\r\n            \r\n                    let rowCurrent = arr[arr.length - 1];\r\n                    let rowCurrentObj = {};\r\n            \r\n                    headers.forEach(hd => {\r\n                        if (rowCurrent[hd.text]) rowCurrentObj.data = { ...rowCurrentObj.data || {}, [hd.key]: rowCurrent[hd.text] };\r\n                    });\r\n                    rowCurrentObj._id = rowId;\r\n                    rowCurrentObj.parentRow = drawingTypeTree[parseInt(index)].id;\r\n                    rowCurrentObj.level = 1;\r\n                    rowCurrentOutput.push(rowCurrentObj);\r\n                });\r\n                rowCurrentOutput.forEach((r, i) => {\r\n                    r.preRow = i === 0 ? null : rowCurrentOutput[i - 1]._id;\r\n                });\r\n                rowsAllCurrentOutput = [...rowsAllCurrentOutput, ...rowCurrentOutput];\r\n            };\r\n        });\r\n        final[prj] = {\r\n            rows: rowsAllCurrentOutput,\r\n            historyRows: historyOutput,\r\n            drawingTypeTree\r\n        };\r\n    });\r\n\r\n    return final;\r\n};\r\nconst getParentIdHandy = (i) => {\r\n    if (i >= 1 && i < 20) return 0;\r\n    if (i >= 20 && i < 42) return 1;\r\n    if (i >= 42 && i < 60) return 2;\r\n    if (i >= 60 && i < 76) return 3;\r\n    if (i >= 76 && i < 81) return 4;\r\n    if (i >= 81 && i < 87) return 5;\r\n    if (i >= 87 && i < 99) return 6;\r\n    if (i >= 99 && i < 109) return 7;\r\n    if (i >= 109 && i < 112) return 8;\r\n    if (i >= 112 && i < 126) return 9;\r\n    if (i >= 126 && i < 147) return 10;\r\n    if (i >= 147 && i < 150) return 11;\r\n    if (i >= 150 && i < 155) return 12;\r\n    if (i >= 155 && i < 159) return 13;\r\n    if (i >= 159 && i < 163) return 14;\r\n    if (i >= 163 && i < 167) return 15;\r\n    if (i >= 167 && i < 171) return 16;\r\n    if (i >= 171 && i < 174) return 17;\r\n    if (i >= 174 && i < 179) return 18;\r\n    if (i >= 179 && i < 181) return 19;\r\n    if (i >= 181 && i < 184) return 20;\r\n    if (i >= 184 && i < 193) return 21;\r\n};\r\n\r\nconst returnPreRowNullSumang = (i) => {\r\n    if (\r\n        i === 0 ||\r\n        i === 1 ||\r\n        i === 20 ||\r\n        i === 42 ||\r\n        i === 60 ||\r\n        i === 76 ||\r\n        i === 81 ||\r\n        i === 87 ||\r\n        i === 99 ||\r\n        i === 109 ||\r\n        i === 112 ||\r\n        i === 126 ||\r\n        i === 147 ||\r\n        i === 150 ||\r\n        i === 155 ||\r\n        i === 159 ||\r\n        i === 163 ||\r\n        i === 167 ||\r\n        i === 171 ||\r\n        i === 174 ||\r\n        i === 179 ||\r\n\r\n        i === 181 ||\r\n        i === 184\r\n    ) {\r\n        return true;\r\n    } else return false;\r\n};\r\nconst returnPreRowNullHandy = (i) => {\r\n    if (\r\n        i === 0 ||\r\n        i === 1 ||\r\n        i === 20 ||\r\n        i === 42 ||\r\n        i === 60 ||\r\n        i === 76 ||\r\n        i === 81 ||\r\n        i === 87 ||\r\n        i === 99 ||\r\n        i === 109 ||\r\n        i === 112 ||\r\n        i === 126 ||\r\n        i === 147 ||\r\n        i === 150 ||\r\n        i === 155 ||\r\n        i === 159 ||\r\n        i === 163 ||\r\n        i === 167 ||\r\n        i === 171 ||\r\n        i === 174 ||\r\n        i === 179 ||\r\n\r\n        i === 181 ||\r\n        i === 184\r\n    ) {\r\n        return true;\r\n    } else return false;\r\n};\r\n\r\n\r\n\r\nexport const reorderRowsFnc = (rows) => {\r\n    let rowsProcessed = [];\r\n \r\n    let firstRowIndex = rows.findIndex(row => row._preRow === null);\r\n \r\n    while (firstRowIndex >= 0) {\r\n       let preRow = rows.splice(firstRowIndex, 1)[0];\r\n       while (preRow) {\r\n          rowsProcessed.push(preRow);\r\n          let nextRowIndex = rows.findIndex(row => String(row._preRow) == String(preRow.id));\r\n          if (nextRowIndex >= 0) {\r\n             preRow = rows.splice(nextRowIndex, 1)[0];\r\n          } else {\r\n             preRow = null;\r\n          };\r\n       };\r\n       firstRowIndex = rows.findIndex((row) => row._preRow === null);\r\n    };\r\n    return rowsProcessed;\r\n };","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\constants\\index.js",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelCalendar.jsx",["280","281"],"import { Calendar, Radio } from 'antd';\r\nimport React from 'react';\r\n\r\n\r\nconst { Group, Button } = Radio;\r\n\r\n\r\nconst PanelCalendar = ({ pickDate }) => {\r\n\r\n    return (\r\n        <div style={{ width: 300 }}>\r\n            <Calendar\r\n                fullscreen={false}\r\n                onSelect={pickDate}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PanelCalendar;\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\ReorderColumnForm.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\ColorizedForm.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\TableDrawingDetail.jsx",["282"],"\r\nimport Axios from 'axios';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport BaseTable, { AutoResizer } from 'react-base-table';\r\nimport styled from 'styled-components';\r\nimport { colorType, SERVER_URL } from '../../constants';\r\nimport { Context as ProjectContext } from '../../contexts/projectContext';\r\nimport { Context as RowContext } from '../../contexts/rowContext';\r\nimport { getHeaderWidth, mongoObjectId } from '../../utils';\r\n\r\n\r\nconst Table = (props) => {\r\n    return (\r\n        <AutoResizer>\r\n            {({ width, height }) => {\r\n                return (\r\n                    <BaseTable\r\n                        {...props}\r\n                        width={width}\r\n                        height={height}\r\n                    />\r\n                );\r\n            }}\r\n        </AutoResizer>\r\n    );\r\n};\r\n\r\n\r\nconst TableDrawingDetail = (props) => {\r\n\r\n\r\n    const { rowData } = props;\r\n    const { state: stateProject } = useContext(ProjectContext);\r\n    const { state: stateRow } = useContext(RowContext);\r\n    const { headers } = stateProject.allDataOneSheet.publicSettings;\r\n\r\n    const [rowsHistoryDatabase, setRowsHistoryDatabase] = useState(null);\r\n    const [rowsHistoryPrevious, setRowsHistoryPrevious] = useState([]);\r\n    const [rowCurrent, setRowCurrent] = useState(null);\r\n\r\n\r\n    useEffect(() => {\r\n        const fetchRowsHistory = async () => {\r\n            try {\r\n                const res = await Axios.get(`${SERVER_URL}/row/history/${stateProject.allDataOneSheet._id}/${rowData.id}`);\r\n                let rowsHistory = [];\r\n                res.data.forEach((r, i) => {\r\n                    const { history } = r;\r\n                    if (history) {\r\n                        let data = { id: mongoObjectId() };\r\n                        Object.keys(history).forEach(key => {\r\n                            const hdText = headers.find(hd => hd.key === key).text;\r\n                            data[hdText] = history[key];\r\n                        });\r\n                        rowsHistory.push(data);\r\n                    };\r\n                });\r\n                setRowsHistoryDatabase(rowsHistory);\r\n\r\n\r\n                let rowsHistoryPrevious = [];\r\n                if (stateRow.rowsVersionsToSave) {\r\n                    rowsHistoryPrevious = stateRow.rowsVersionsToSave.filter(r => r.id === rowData.id);\r\n                    rowsHistoryPrevious.forEach((r, i) => {\r\n                        r.id = mongoObjectId();\r\n                    });\r\n                    setRowsHistoryPrevious(rowsHistoryPrevious);\r\n                };\r\n\r\n\r\n                setRowCurrent({\r\n                    ...rowData,\r\n                    key: rowsHistory.length + rowsHistoryPrevious.length + 1\r\n                });\r\n\r\n\r\n\r\n            } catch (err) {\r\n                console.log(err);\r\n            };\r\n        };\r\n        fetchRowsHistory();\r\n    }, []);\r\n\r\n    let data;\r\n    if (rowsHistoryDatabase && rowCurrent) {\r\n        data = [\r\n            ...rowsHistoryDatabase,\r\n            ...rowsHistoryPrevious,\r\n            rowCurrent\r\n        ];\r\n    };\r\n\r\n    const panelWidth = window.innerWidth * 0.8;\r\n    const panelHeight = window.innerHeight * 0.8;\r\n\r\n\r\n    return (\r\n        <div style={{\r\n            height: panelHeight,\r\n            background: 'white',\r\n            padding: 10,\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            flexDirection: 'column',\r\n        }}>\r\n\r\n            {rowsHistoryDatabase && rowCurrent && (\r\n                <>\r\n                    <div style={{\r\n                        width: panelWidth,\r\n                        height: 100 + data.length * 30,\r\n                        margin: '0 auto',\r\n                        textAlign: 'center'\r\n                    }}>\r\n                        <div style={{ fontSize: 20, fontWeight: 'bold' }}>DRAWING HISTORY</div>\r\n                        <TableStyled\r\n                            fixed\r\n                            columns={generateColumns(getHeadersText(stateProject.allDataOneSheet.publicSettings.headers))}\r\n                            data={data}\r\n                            rowHeight={28}\r\n                        />\r\n\r\n                    </div>\r\n\r\n                    <div style={{\r\n                        margin: '0 auto',\r\n                        textAlign: 'center',\r\n                        marginTop: 100\r\n                    }}>\r\n                        <img src='./img/timeline.JPG' alt='visualize' height={panelHeight - (100 + data.length * 30) - 100} />\r\n                    </div>\r\n                </>\r\n            )}\r\n\r\n\r\n\r\n        </div>\r\n\r\n    );\r\n};\r\n\r\nexport default TableDrawingDetail;\r\n\r\n\r\nconst generateColumns = (headers) => headers.map((column, columnIndex) => ({\r\n\r\n    key: column,\r\n    dataKey: column,\r\n    title: column,\r\n    resizable: true,\r\n    width: getHeaderWidth(column),\r\n}));\r\n\r\nconst getHeadersText = (headersData) => {\r\n    return headersData.map(hd => {\r\n        return hd.text;\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\nconst TableStyled = styled(Table)`\r\n\r\n    .BaseTable__table .BaseTable__body {\r\n\r\n        -webkit-touch-callout: none;\r\n        -webkit-user-select: none;\r\n        -khtml-user-select: none;\r\n        -moz-user-select: none;\r\n        -ms-user-select: none;\r\n        user-select: none;\r\n\r\n        ::-webkit-scrollbar {\r\n            -webkit-appearance: none;\r\n            background-color: #e3e3e3;\r\n        }\r\n\r\n        ::-webkit-scrollbar:vertical {\r\n            width: 15px;\r\n        }\r\n\r\n        ::-webkit-scrollbar:horizontal {\r\n            height: 15px;\r\n        }\r\n\r\n        ::-webkit-scrollbar-thumb {\r\n            border-radius: 10px;\r\n            border: 2px solid #e3e3e3;\r\n            background-color: #999;\r\n\r\n            &:hover {\r\n                background-color: #666;\r\n            }\r\n        }\r\n\r\n        ::-webkit-resizer {\r\n            display: none;\r\n        }\r\n\r\n        .BaseTable__row-cell-text {\r\n            color: black\r\n        }\r\n    }\r\n\r\n    .BaseTable__header-cell {\r\n        padding: 10px;\r\n        border-right: 1px solid #DCDCDC;\r\n\r\n        background: ${colorType.grey1};\r\n        color: black\r\n    }\r\n\r\n    .BaseTable__row-cell {\r\n        padding: 10px;\r\n        border-right: 1px solid #DCDCDC;\r\n\r\n        overflow: visible !important;\r\n    }\r\n\r\n\r\n\r\n\r\n`;\r\n\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\TableCellHistory.jsx",["283","284"],"import { List } from 'antd';\r\nimport Axios from 'axios';\r\nimport moment from 'moment';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport { SERVER_URL } from '../../constants';\r\nimport { Context as ProjectContext } from '../../contexts/projectContext';\r\nimport { Context as RowContext } from '../../contexts/rowContext';\r\n\r\n\r\n\r\nconst TableCellHistory = (props) => {\r\n\r\n    const { rowData, column } = props;\r\n\r\n    const {\r\n        state: stateProject\r\n    } = useContext(ProjectContext);\r\n\r\n    const {\r\n        state: stateRow\r\n    } = useContext(RowContext);\r\n\r\n    const projectId = stateProject.allDataOneSheet.projectId;\r\n    const headers = stateProject.allDataOneSheet.publicSettings.headers;\r\n    const headerKey = headers.find(hd => hd.text === column.key).key;\r\n\r\n\r\n    const [history, setHistory] = useState()\r\n\r\n    useEffect(() => {\r\n        const fetchCellHistory = async () => {\r\n            try {\r\n\r\n                const res = await Axios.get(`${SERVER_URL}/cell/history/${projectId}/${rowData.id}/${headerKey}`);\r\n\r\n                setHistory(res.data.histories.reverse());\r\n\r\n            } catch (err) {\r\n                console.log(err);\r\n            };\r\n        };\r\n        fetchCellHistory();\r\n    }, [])\r\n\r\n\r\n    return (\r\n        <div style={{ width: '100%', padding: 15, maxHeight: window.innerHeight * 0.7, overflowY: 'scroll' }}>\r\n            <List\r\n                size='small'\r\n                header={null}\r\n                footer={null}\r\n                bordered\r\n                dataSource={history}\r\n                renderItem={item => (\r\n                    <List.Item>\r\n                        <div>\r\n                            <div>{`${item.user}`}</div>\r\n                            <div style={{ fontSize: 12, color: 'grey' }}>{moment(item.createdAt).format('DD/MM/YY - HH:mm')}</div>\r\n                            <div style={{ fontWeight: 'bold' }}>{item.text}</div>\r\n                        </div>\r\n                    </List.Item>\r\n                )}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TableCellHistory;\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\InputSearch.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\IconTable.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\CellIndex.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormSort.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormFilter.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormGroup.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\TableActivityHistory.jsx",["285","286","287"],"import { Modal } from 'antd';\r\nimport Axios from 'axios';\r\nimport moment from 'moment';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport BaseTable, { AutoResizer } from 'react-base-table';\r\nimport styled from 'styled-components';\r\nimport { colorType, SERVER_URL } from '../../constants';\r\nimport { Context as ProjectContext } from '../../contexts/projectContext';\r\nimport { Context as RowContext } from '../../contexts/rowContext';\r\nimport { convertHistoryData, mongoObjectId } from '../../utils';\r\nimport ButtonStyle from './ButtonStyle';\r\nimport FormFilterActivityHistory from './FormFilterActivityHistory';\r\nimport IconTable from './IconTable';\r\nimport PanelCalendarDuration from './PanelCalendarDuration';\r\n\r\nconst Table = (props) => {\r\n    return (\r\n        <AutoResizer>\r\n            {({ width, height }) => {\r\n                return (\r\n                    <BaseTable\r\n                        {...props}\r\n                        width={width}\r\n                        height={height}\r\n                    />\r\n                );\r\n            }}\r\n        </AutoResizer>\r\n    );\r\n};\r\n\r\nconst panelWidth = window.innerWidth * 0.8;\r\nconst panelHeight = window.innerHeight * 0.8;\r\n\r\nconst TableActivityHistory = (props) => {\r\n\r\n    const { state: stateProject } = useContext(ProjectContext);\r\n    const { state: stateRow } = useContext(RowContext);\r\n    const { allDataOneSheet: { publicSettings: { activityRecorded } } } = stateProject;\r\n\r\n\r\n\r\n    const projectId = stateProject.allDataOneSheet.projectId;\r\n    const headers = stateProject.allDataOneSheet.publicSettings.headers;\r\n\r\n    const [historyAll, setHistoryAll] = useState(null);\r\n\r\n\r\n    const headersShown = [\r\n        'Drawing Number',\r\n        'Drawing Name',\r\n        'Column',\r\n        'Value',\r\n        'User',\r\n        'Created At',\r\n        'Action'\r\n    ];\r\n\r\n    const revKey = headers.find(hd => hd.text === 'Rev').key;\r\n    const statusKey = headers.find(hd => hd.text === 'Status').key;\r\n    const dwgNumber = headers.find(hd => hd.text === 'Drawing Number').key;\r\n    const dwgName = headers.find(hd => hd.text === 'Drawing Name').key;\r\n\r\n    useEffect(() => {\r\n        const fetchRowsAndCellHistory = async () => {\r\n            try {\r\n                const resRows = await Axios.get(`${SERVER_URL}/row/history/${projectId}`);\r\n                const resCells = await Axios.get(`${SERVER_URL}/cell/history/${projectId}`);\r\n\r\n                let rowsOutput = [];\r\n                resRows.data.forEach(row => {\r\n                    const { history } = row;\r\n                    if (history) rowsOutput.push({\r\n                        'Drawing Number': history[dwgNumber],\r\n                        'Drawing Name': history[dwgName],\r\n                        'Column': 'Rev & Status',\r\n                        'Value': `${history[revKey]} - ${history[statusKey]}`,\r\n                        'User': row.userId || 'n/a',\r\n                        'Created At': moment(row.createdAt).format('DD/MM/YY - HH:mm'),\r\n                        'Action': 'Save Drawing Version',\r\n                        id: mongoObjectId()\r\n                    });\r\n                });\r\n\r\n                let cellsOutput = [];\r\n                convertHistoryData(resCells.data).forEach(cell => {\r\n                    const row = stateRow.rowsAll.find(r => r.id === cell.row);\r\n                    if (row) cellsOutput.push({\r\n                        'Drawing Number': row['Drawing Number'],\r\n                        'Drawing Name': row['Drawing Name'],\r\n                        'Column': headers.find(hd => hd.key === cell.headerKey).text,\r\n                        'Value': cell.text,\r\n                        'User': cell.userId || 'n/a',\r\n                        'Created At': moment(cell.createdAt).format('DD/MM/YY - HH:mm'),\r\n                        'Action': 'Edit Cell',\r\n                        id: mongoObjectId()\r\n                    });\r\n                });\r\n\r\n                const activityRecordedData = activityRecorded.map(r => {\r\n                    return {\r\n                        'Drawing Number': r[dwgNumber],\r\n                        'Drawing Name': r[dwgName],\r\n                        'Column': undefined,\r\n                        'Value': undefined,\r\n                        'User': r.email || 'n/a',\r\n                        'Created At': moment(r.createdAt).format('DD/MM/YY - HH:mm'),\r\n                        'Action': r.action,\r\n                        id: mongoObjectId()\r\n                    };\r\n                });\r\n                let outputArr = [...rowsOutput, ...cellsOutput, ...activityRecordedData].sort((b, a) => a['Created At'] > b['Created At'] ? 1 : b['Created At'] > a['Created At'] ? -1 : 0);\r\n\r\n                setHistoryAll(outputArr);\r\n\r\n            } catch (err) {\r\n                console.log(err);\r\n            };\r\n        };\r\n        fetchRowsAndCellHistory();\r\n    }, []);\r\n\r\n\r\n\r\n    const [modalFilter, setModalFilter] = useState(false);\r\n\r\n    const applyFilter = (data) => {\r\n        setHistoryAll(data);\r\n        setModalFilter(false);\r\n    };\r\n\r\n\r\n    const onClick = () => {\r\n  \r\n\r\n    };\r\n\r\n\r\n\r\n    return (\r\n        <>\r\n            {historyAll && (\r\n                <div style={{\r\n                    height: panelHeight,\r\n                    background: 'white',\r\n                    padding: 10,\r\n                    display: 'flex',\r\n                    justifyContent: 'center',\r\n                    flexDirection: 'column',\r\n                }}>\r\n                    <div style={{ display: 'flex', marginBottom: 10 }}>\r\n                        <PanelCalendarDuration />\r\n                        <ButtonStyle\r\n                            onClick={onClick}\r\n                            marginLeft={5}\r\n                            name='Check History'\r\n                        />\r\n                    </div>\r\n                    <div style={{ display: 'flex', marginBottom: 10 }}>\r\n                        <div style={{ marginRight: 10, display: 'flex' }}>\r\n                            <IconTable type='filter' onClick={() => setModalFilter(true)} />\r\n                            <IconTable type='rollback' onClick={() => {}} />\r\n                        </div>\r\n\r\n                        <ButtonStyle\r\n                            onClick={() => { }}\r\n                            marginRight={5}\r\n                            name='Last 7 Days'\r\n                        />\r\n                        <ButtonStyle\r\n                            onClick={() => { }}\r\n                            marginRight={5}\r\n                            name='Last 14 Days'\r\n                        />\r\n                        <ButtonStyle\r\n                            onClick={() => { }}\r\n                            marginRight={5}\r\n                            name='This Month'\r\n                        />\r\n                    </div>\r\n\r\n                    <div style={{\r\n                        width: panelWidth,\r\n                        height: '100%',\r\n                        margin: '0 auto',\r\n                        textAlign: 'center'\r\n                    }}>\r\n                        <TableStyled\r\n                            fixed\r\n                            columns={generateColumns(headersShown)}\r\n                            data={historyAll}\r\n                            rowHeight={28}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {modalFilter && (\r\n                <ModalStyledSetting\r\n                    title='Filter Data Activity History'\r\n                    visible={modalFilter}\r\n                    footer={null}\r\n                    onCancel={() => {\r\n                        setModalFilter(false);\r\n                    }}\r\n                    destroyOnClose={true}\r\n                    centered={true}\r\n                >\r\n                    <FormFilterActivityHistory\r\n                        applyFilter={applyFilter}\r\n                        onClickCancelModal={() => setModalFilter(false)}\r\n                        rowsAll={historyAll}\r\n                        headers={headersShown}\r\n                    />\r\n                </ModalStyledSetting>\r\n            )}\r\n        </>\r\n    );\r\n};\r\n\r\nexport default TableActivityHistory;\r\n\r\n\r\nconst generateColumns = (headers) => headers.map((column, columnIndex) => ({\r\n\r\n    key: column,\r\n    dataKey: column,\r\n    title: column,\r\n    resizable: true,\r\n    width: getHeaderWidth2(column),\r\n}));\r\nconst getHeaderWidth2 = (header) => {\r\n    if (header === 'Drawing Number') return 300;\r\n    if (header === 'Drawing Name') return 300;\r\n    if (header === 'Column') return 200;\r\n    if (header === 'Value') return 300;\r\n    if (header === 'User') return 200;\r\n    if (header === 'Created At') return 200;\r\n    if (header === 'Action') return 200;\r\n};\r\nconst getHeadersText = (headersData) => {\r\n    return headersData.map(hd => {\r\n        return hd.text;\r\n    });\r\n};\r\n\r\nconst getDrawingName = (headers, rowsAll, rowId, headerId) => {\r\n\r\n    let row = rowsAll.find(r => r.id === rowId);\r\n    let headerText = headers.find(hd => hd.key === headerId)['text'];\r\n\r\n    return {\r\n        headerText,\r\n        drawingName: row['Drawing Name'],\r\n        drawingNumber: row['Drawing Number'],\r\n    }\r\n};\r\n\r\nconst ModalStyledSetting = styled(Modal)`\r\n    .ant-modal-content {\r\n        border-radius: 0;\r\n    }\r\n   .ant-modal-close {\r\n      display: none;\r\n   }\r\n   .ant-modal-header {\r\n      padding: 10px;\r\n   }\r\n   .ant-modal-title {\r\n        padding-left: 10px;\r\n        font-size: 20px;\r\n        font-weight: bold;\r\n   }\r\n   .ant-modal-body {\r\n      padding: 0;\r\n      display: flex;\r\n      justify-content: center;\r\n   }\r\n`;\r\nconst TableStyled = styled(Table)`\r\n\r\n    .BaseTable__table .BaseTable__body {\r\n\r\n        -webkit-touch-callout: none;\r\n        -webkit-user-select: none;\r\n        -khtml-user-select: none;\r\n        -moz-user-select: none;\r\n        -ms-user-select: none;\r\n        user-select: none;\r\n\r\n        ::-webkit-scrollbar {\r\n            -webkit-appearance: none;\r\n            background-color: #e3e3e3;\r\n        }\r\n\r\n        ::-webkit-scrollbar:vertical {\r\n            width: 15px;\r\n        }\r\n\r\n        ::-webkit-scrollbar:horizontal {\r\n            height: 15px;\r\n        }\r\n\r\n        ::-webkit-scrollbar-thumb {\r\n            border-radius: 10px;\r\n            border: 2px solid #e3e3e3;\r\n            background-color: #999;\r\n\r\n            &:hover {\r\n                background-color: #666;\r\n            }\r\n        }\r\n\r\n        ::-webkit-resizer {\r\n            display: none;\r\n        }\r\n\r\n        .BaseTable__row-cell-text {\r\n            color: black\r\n        }\r\n    }\r\n\r\n    .BaseTable__header-cell {\r\n        padding: 10px;\r\n        border-right: 1px solid #DCDCDC;\r\n\r\n        background: ${colorType.grey1};\r\n        color: black\r\n    }\r\n\r\n    .BaseTable__row-cell {\r\n        padding: 10px;\r\n        border-right: 1px solid #DCDCDC;\r\n\r\n        overflow: visible !important;\r\n    }\r\n\r\n\r\n\r\n\r\n`;\r\n\r\n\r\n\r\n\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormDateAutomation.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\ButtonStyle.jsx",["288"],"import { Button } from 'antd';\r\nimport React from 'react';\r\n\r\nconst ButtonStyle = ({\r\n    colorText,\r\n    marginRight,\r\n    marginLeft,\r\n    borderColor,\r\n    marginBottom,\r\n    background,\r\n    name,\r\n    onClick\r\n}) => {\r\n\r\n    return (\r\n        <Button \r\n            style={{\r\n                borderRadius: 0,\r\n                background: background,\r\n                color: colorText,\r\n                border: 'none',\r\n                marginRight,\r\n                marginBottom,\r\n                marginLeft,\r\n                border: `1px solid ${borderColor || background}`\r\n            }}\r\n            onClick={onClick}\r\n        >\r\n            {name}\r\n        </Button>\r\n    );\r\n};\r\n\r\nexport default ButtonStyle;\r\n\r\n\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\ButtonGroupComp.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelConfirm.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormDrawingTypeOrder.jsx",["289","290","291","292"],"import { Icon, Input, Modal } from 'antd';\r\nimport React, { useContext, useEffect, useRef, useState } from 'react';\r\nimport SortableTree from 'react-sortable-tree';\r\nimport 'react-sortable-tree/style.css';\r\nimport styled from 'styled-components';\r\nimport { colorType } from '../../constants';\r\nimport { Context as ProjectContext } from '../../contexts/projectContext';\r\nimport { Context as RowContext } from '../../contexts/rowContext';\r\nimport { mongoObjectId } from '../../utils';\r\nimport ButtonGroupComp from './ButtonGroupComp';\r\n\r\n\r\n\r\n\r\n\r\nconst FormDrawingTypeOrder = ({ onClickCancelModal, applyFolderOrganize }) => {\r\n\r\n   const { state: stateRow } = useContext(RowContext);\r\n   const { state: stateProject } = useContext(ProjectContext);\r\n\r\n   const [input, setInput] = useState(addProjectLevel(stateRow.drawingTypeTree, stateProject.allDataOneSheet.projectName));\r\n   const [data, setData] = useState(arrangeDrawingType(input));\r\n\r\n\r\n\r\n   useEffect(() => {\r\n      setData(arrangeDrawingType(input));\r\n   }, [input]);\r\n\r\n   const onClickApply = () => {\r\n      input.splice(0, 1); // remove projectName Row\r\n      applyFolderOrganize(input);\r\n   };\r\n\r\n\r\n   const addFolderBelow = (node) => {\r\n      let nodeIndex;\r\n      input.forEach((nd, i) => {\r\n         if (nd.id === node.id) nodeIndex = i;\r\n      });\r\n\r\n      let newNodeIndex;\r\n      for (let i = 0; i < input.length; i++) {\r\n         if (input[i]._rowLevel - 1 === node._rowLevel && i > nodeIndex) {\r\n            if (!newNodeIndex) newNodeIndex = i;\r\n         };\r\n      };\r\n      for (let i = 0; i < Math.abs(node._rowLevel); i++) {\r\n         input.splice(newNodeIndex + i, 0, {\r\n            id: mongoObjectId(),\r\n            'Drawing Number': 'NEW DRAWING TYPE...',\r\n            _rowLevel: node._rowLevel + i + 1,\r\n            expanded: true,\r\n         });\r\n      };\r\n      setInput([...input]);\r\n   };\r\n\r\n   const [modalShown, setModalShown] = useState(false);\r\n   const [modalTitle, setModalTitle] = useState(null);\r\n   const [value, setValue] = useState(null);\r\n   const [item, setItem] = useState(null);\r\n\r\n   const deleteFolder = (node) => {\r\n      setItem(node);\r\n      setModalTitle('Delete Drawing Type');\r\n      setModalShown(true);\r\n   };\r\n   const editFolderName = (node) => {\r\n      setValue(node.title);\r\n      setItem(node);\r\n      setModalTitle('Edit Drawing Type Name');\r\n      setModalShown(true);\r\n   };\r\n   const onClickApplyModal = () => {\r\n\r\n      if (modalTitle === 'Delete Drawing Type') {\r\n\r\n         let removeArr = [...item.children || [], item];\r\n         const removeIdsArr = removeArr.map(e => e.id);\r\n         let arr = input.filter(e => removeIdsArr.indexOf(e.id) === -1);\r\n         setInput([...arr]);\r\n\r\n         setModalShown(false);\r\n         setModalTitle(null);\r\n         setValue(null);\r\n         setItem(null);\r\n      } else {\r\n         input.find(e => e.id === item.id)['Drawing Number'] = value;\r\n         setInput([...input]);\r\n\r\n         setModalShown(false);\r\n         setModalTitle(null);\r\n         setValue(null);\r\n         setItem(null);\r\n      };\r\n   };\r\n\r\n   const fileAdd = () => {\r\n      let projectLevel = input[0]._rowLevel;\r\n      input[0]._rowLevel = projectLevel - 1;\r\n      input.splice(1, 0, {\r\n         id: mongoObjectId(),\r\n         'Drawing Number': 'NEW DRAWING TYPE...',\r\n         _rowLevel: projectLevel,\r\n         expanded: true,\r\n      });\r\n      setInput([...input]);\r\n   };\r\n\r\n   return (\r\n      <Container>\r\n\r\n         <PanelStyled>\r\n\r\n            <SortableTree\r\n               treeData={data}\r\n               onChange={treeData => {\r\n                  // setData(treeData);\r\n               }}\r\n               canDrop={(props) => {\r\n                  const { nextParent, node } = props;\r\n                  return nextParent && nextParent._rowLevel === node._rowLevel - 1;\r\n               }}\r\n               onMoveNode={({ prevTreeIndex, nextTreeIndex }) => {\r\n                  let item = input[prevTreeIndex];\r\n                  input.splice(prevTreeIndex, 1);\r\n                  input.splice(nextTreeIndex, 0, item);\r\n                  setInput([...input]);\r\n               }}\r\n               isVirtualized={false}\r\n               generateNodeProps={(props) => {\r\n                  const { node, parentNode } = props;\r\n                  return ({\r\n                     buttons: parentNode === null ? [\r\n                        // <IconBtn type='file-add' onClick={() => fileAdd()} />,\r\n                        <IconBtn type='plus' onClick={() => addFolderBelow(node)} />,\r\n                     ] : node._rowLevel !== 0 ? [\r\n                        <IconBtn type='plus' onClick={() => addFolderBelow(node)} />,\r\n                        <IconBtn type='edit' onClick={() => editFolderName(node)} />,\r\n                        <IconBtn type='delete' onClick={() => deleteFolder(node)} />\r\n                     ] : [\r\n                              <IconBtn type='edit' onClick={() => editFolderName(node)} />,\r\n                              <IconBtn type='delete' onClick={() => deleteFolder(node)} />\r\n                           ]\r\n                  })\r\n               }}\r\n            />\r\n         </PanelStyled>\r\n\r\n         <div style={{ padding: 20, display: 'flex', flexDirection: 'row-reverse' }}>\r\n            <ButtonGroupComp\r\n               onClickCancel={onClickCancelModal}\r\n               onClickApply={onClickApply}\r\n            />\r\n         </div>\r\n\r\n         {modalShown && (\r\n            <ModalStyledSetting\r\n               title={modalTitle}\r\n               visible={modalShown}\r\n               footer={null}\r\n               onCancel={() => {\r\n                  setModalShown(false);\r\n                  setValue(null);\r\n                  setModalTitle(null);\r\n               }}\r\n               destroyOnClose={true}\r\n               centered={true}\r\n            >\r\n               <div style={{ padding: 20, width: '100%' }}>\r\n                  {modalTitle === 'Delete Drawing Type' ? (\r\n                     <div>Are you sure ???</div>\r\n                  ) : (\r\n                        <Input\r\n                           placeholder='Enter new name...'\r\n                           style={{ width: '100%' }}\r\n                           value={value}\r\n                           onChange={(e) => setValue(e.target.value)}\r\n                        />\r\n                     )}\r\n\r\n                  <div style={{ padding: 20, display: 'flex', flexDirection: 'row-reverse' }}>\r\n                     <ButtonGroupComp\r\n                        onClickCancel={() => {\r\n                           setModalShown(false);\r\n                           setValue(null);\r\n                           setModalTitle(null);\r\n                        }}\r\n                        onClickApply={onClickApplyModal}\r\n                     />\r\n                  </div>\r\n               </div>\r\n            </ModalStyledSetting>\r\n         )}\r\n      </Container>\r\n   );\r\n};\r\n\r\nexport default FormDrawingTypeOrder;\r\n\r\n\r\nconst IconBtn = ({ type, onClick }) => {\r\n   return (\r\n      <IconStyle type={type} onClick={onClick} />\r\n   );\r\n};\r\n\r\nconst IconStyle = styled(Icon)`\r\n   margin: 3px;\r\n   padding: 5px;\r\n   border-radius: 3px;\r\n   border: 1px solid ${colorType.grey0};\r\n   &:hover {\r\n      background-color: ${colorType.grey0};\r\n   };\r\n`;\r\nconst ModalStyledSetting = styled(Modal)`\r\n    .ant-modal-content {\r\n        border-radius: 0;\r\n    }\r\n   .ant-modal-close {\r\n      display: none;\r\n   }\r\n   .ant-modal-header {\r\n      padding: 10px;\r\n   }\r\n   .ant-modal-title {\r\n        padding-left: 10px;\r\n        font-size: 20px;\r\n        font-weight: bold;\r\n   }\r\n   .ant-modal-body {\r\n      padding: 0;\r\n      display: flex;\r\n      justify-content: center;\r\n   }\r\n`;\r\n\r\nconst addProjectLevel = (drawingTypeTree, projectName) => {\r\n\r\n   let data = drawingTypeTree.map(e => ({ ...e }));\r\n   let levelArray = [...new Set(data.map(r => r._rowLevel))].sort((a, b) => b - a);\r\n\r\n   let projectLevel = levelArray[levelArray.length - 1] - 1;\r\n\r\n   data.unshift({\r\n      'Drawing Number': projectName,\r\n      id: mongoObjectId(),\r\n      _rowLevel: projectLevel,\r\n      expanded: true\r\n   });\r\n   return data;\r\n};\r\n\r\nconst arrangeDrawingType = (xxx) => {\r\n\r\n   let data = xxx.map(e => ({ ...e }));\r\n   let levelArray = [...new Set(data.map(r => r._rowLevel))].sort((a, b) => b - a);\r\n\r\n   levelArray.forEach(lvl => {\r\n      data.forEach((row, index) => {\r\n         if (row._rowLevel === lvl) {\r\n            row.title = row['Drawing Number'];\r\n            delete row['Drawing Number'];\r\n\r\n            let arr = data.filter((r, i) => r._rowLevel === lvl - 1 && i < index);\r\n            let parentRow = arr[arr.length - 1];\r\n            if (parentRow) parentRow.children = [...parentRow.children || [], row];\r\n         };\r\n      });\r\n   });\r\n   return data.filter(r => r._rowLevel === levelArray[levelArray.length - 1]);\r\n};\r\n\r\n\r\n\r\n\r\nconst InputComp = ({ tag, updateFolderName, index }) => {\r\n\r\n   const [value, setValue] = useState(tag.header);\r\n   const [isDoubleClick, setIsDoubleClick] = useState(false);\r\n\r\n   const inputReff = useRef();\r\n\r\n\r\n   useEffect(() => {\r\n      if (isDoubleClick) {\r\n         inputReff.current.focus();\r\n      };\r\n\r\n   }, [isDoubleClick]);\r\n\r\n   return (\r\n      <div\r\n         onDoubleClick={() => setIsDoubleClick(true)}\r\n         onBlur={() => {\r\n            setIsDoubleClick(false);\r\n            updateFolderName(tag, index, value);\r\n         }}\r\n         style={{\r\n            width: '75%',\r\n            overflow: 'hidden',\r\n            textOverflow: 'ellipsis',\r\n            whiteSpace: 'nowrap'\r\n         }}\r\n      >\r\n         {isDoubleClick ? (\r\n            <input\r\n               ref={inputReff}\r\n               value={value}\r\n               onChange={(e) => setValue(e.target.value)}\r\n               style={{\r\n                  width: '100%',\r\n                  border: 'none'\r\n               }}\r\n            />\r\n         ) : (\r\n               <div>{tag.header}</div>\r\n            )\r\n         }\r\n\r\n      </div>\r\n\r\n   );\r\n\r\n};\r\n\r\nconst addZero = (num) => {\r\n   if (num < 10) return '0' + num;\r\n   return num;\r\n};\r\n\r\nconst Container = styled.div`\r\n   height: ${`${window.innerHeight * 0.8}` + 'px'};\r\n   width: 100%;\r\n   display: flex;\r\n   flex-direction: column;\r\n`;\r\n\r\n\r\nconst PanelStyled = styled.div`\r\n\r\n    width: 100%;\r\n    float: right;\r\n    overflow-x: hidden;\r\n    border-bottom: 1px solid ${colorType.grey4};\r\n\r\n    ::-webkit-scrollbar {\r\n        -webkit-appearance: none;\r\n        background-color: #e3e3e3;\r\n    }\r\n\r\n    ::-webkit-scrollbar:vertical {\r\n        width: 15px;\r\n    }\r\n\r\n    ::-webkit-scrollbar:horizontal {\r\n        height: 15px;\r\n    }\r\n\r\n    ::-webkit-scrollbar-thumb {\r\n        border-radius: 10px;\r\n        border: 2px solid #e3e3e3;\r\n        background-color: #999;\r\n\r\n        &:hover {\r\n            background-color: #666;\r\n        }\r\n    }\r\n`;","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormCellColorizedCheck.jsx",["293","294","295"],"import { Button, DatePicker } from 'antd';\r\nimport Axios from 'axios';\r\nimport moment from 'moment';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport { SERVER_URL } from '../../constants';\r\nimport { Context as ProjectContext } from '../../contexts/projectContext';\r\nimport { Context as RowContext } from '../../contexts/rowContext';\r\nimport { convertHistoryData } from '../../utils';\r\n\r\n\r\n\r\n\r\nconst FormCellColorizedCheck = ({ setCellHistoryArr }) => {\r\n\r\n    const {\r\n        state: stateProject\r\n    } = useContext(ProjectContext);\r\n\r\n    const {\r\n        state: stateRow\r\n    } = useContext(RowContext);\r\n\r\n    const projectId = stateProject.allDataOneSheet.projectId;\r\n    const headersArr = stateProject.allDataOneSheet.publicSettings.headers;\r\n\r\n    useEffect(() => {\r\n\r\n        const fetchProjectHistory = async () => {\r\n            try {\r\n                const res = await Axios.get(`${SERVER_URL}/cell/history/${projectId}`);\r\n                setHistoryData(res.data);\r\n\r\n            } catch (err) {\r\n                console.log(err);\r\n            };\r\n        };\r\n        fetchProjectHistory();\r\n    }, []);\r\n\r\n    const [historyData, setHistoryData] = useState([]);\r\n    const [start, setStart] = useState(null);\r\n    const [end, setEnd] = useState(null);\r\n\r\n\r\n    const onClick = () => {\r\n\r\n        if (!start || !end) return;\r\n        \r\n        let startDate = start.toDate();\r\n        let endDate = end.toDate();\r\n\r\n        if (startDate > endDate) return;\r\n\r\n        let filterCells = convertHistoryData(historyData).filter(cell => {\r\n\r\n            let createdAt = moment(cell.createdAt).toDate();\r\n            return createdAt >= startDate && createdAt <= endDate;\r\n        });\r\n\r\n        const cellArr = filterCells.map(ch => {\r\n            const { row: rowId, headerKey } = ch;\r\n            let headerText = headersArr.find(hd => hd.key === headerKey).text;\r\n            return {\r\n                rowId,\r\n                header: headerText\r\n            }\r\n        });\r\n\r\n        let unique = cellArr.reduce((res, itm) => {\r\n            let result = res.find(item => JSON.stringify(item) == JSON.stringify(itm));\r\n            if (!result) return res.concat(itm);\r\n            return res;\r\n        }, []);\r\n\r\n        setCellHistoryArr(unique);\r\n    };\r\n\r\n    return (\r\n        <div style={{\r\n            width: '30vw',\r\n            height: '20vh',\r\n            padding: 15\r\n        }}>\r\n            <div style={{ display: 'flex', marginBottom: 20, marginTop: 20, width: '100%' }}>\r\n                <DatePicker onChange={e => setStart(e)} style={{ width: '100%' }} />\r\n                <DatePicker onChange={e => setEnd(e)} style={{ width: '100%' }} />\r\n            </div>\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 20, width: '100%' }}>\r\n                <Button>Last 7 Days</Button>\r\n                <Button>Last 14 Days</Button>\r\n                <Button>This Month</Button>\r\n            </div>\r\n            <Button type='primary' onClick={onClick}>Check</Button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FormCellColorizedCheck;\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\TestTree.jsx",["296","297"],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\PanelCalendarDuration.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\layouts\\pageSpreadsheet\\FormFilterActivityHistory.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\PageDashboard.jsx",["298","299","300","301","302","303","304","305","306","307"],"import { Col, Divider, Modal, Row, Skeleton } from 'antd';\r\nimport Axios from 'axios';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { SERVER_URL } from './assets/constantDashboard';\r\nimport CardPanelProject from './componentsDashboard/CardPanelProject';\r\nimport _ChartBarDrawing from './componentsDashboard/_ChartBarDrawing';\r\nimport _ChartBarDrawingLate from './componentsDashboard/_ChartBarDrawingLate';\r\nimport _ChartBarStack from './componentsDashboard/_ChartBarStack';\r\nimport _ChartPieDrawing from './componentsDashboard/_ChartPieDrawing';\r\nimport _ChartProgress from './componentsDashboard/_ChartProgress';\r\nimport _FormPivot from './componentsDashboard/_FormPivot';\r\nimport _TableDrawingList from './componentsDashboard/_TableDrawingList';\r\n\r\n\r\n\r\n\r\nconst convertDataFromDB = (data, projectsArray) => {\r\n\r\n    let output = {};\r\n\r\n    data.forEach(projectData => {\r\n        const { publicSettings: { headers }, rows, _id } = projectData;\r\n\r\n        let projectName = projectsArray.find(dt => dt.id === _id).name;\r\n\r\n        let headersArr = headers.map(hd => hd.text);\r\n\r\n        rows.forEach(r => {\r\n            if (!r.Rev) r.Rev = '0';\r\n            if (!r.Status) r.Status = 'Not Started';\r\n        });\r\n\r\n        const getUniqueValueByColumns = (rows, header) => {\r\n            let valueArr = [];\r\n            rows.forEach(row => valueArr.push(row[header]));\r\n            return [...new Set(valueArr)];\r\n        };\r\n        let revArr = getUniqueValueByColumns(rows, 'Rev');\r\n        let inputStack = getUniqueValueByColumns(rows, 'Status');\r\n        let drawingCountSubStatus = [];\r\n        let drawingListSubStatus = {};\r\n        revArr.forEach(rev => {\r\n            let rowsFilter = rows.filter(r => r['Rev'] === rev);\r\n            let obj = {};\r\n            let objDwgs = {};\r\n            rowsFilter.forEach(r => {\r\n                obj[r.Status] = (obj[r.Status] || 0) + 1;\r\n                objDwgs[r.Status] = [...objDwgs[r.Status] || [], r];\r\n            });\r\n            obj.name = rev;\r\n            drawingCountSubStatus.push(obj);\r\n            drawingListSubStatus[rev] = objDwgs;\r\n        });\r\n\r\n\r\n        let drawingCountStatus = {};\r\n        let drawingsListStatus = {};\r\n        inputStack.forEach(stt => {\r\n            let rrrArr = rows.filter(r => r.Status === stt);\r\n            rrrArr.forEach(r => {\r\n                drawingCountStatus[stt] = (drawingCountStatus[stt] || 0) + 1;\r\n            });\r\n            drawingsListStatus[stt] = rrrArr;\r\n        });\r\n        const dataPieChartStatus = Object.keys(drawingCountStatus).map(key => ({ name: key, value: drawingCountStatus[key] }));\r\n\r\n        output[projectName] = {\r\n            rowsAll: rows,\r\n            drawingCountSubStatus,\r\n            drawingListSubStatus,\r\n            inputStack,\r\n            headers: headersArr,\r\n            drawingCountStatus,\r\n            drawingsListStatus,\r\n            dataPieChartStatus,\r\n            projectsCount: data.length\r\n        };\r\n    });\r\n    \r\n    return output;\r\n};\r\n\r\n\r\nconst PageDashboard = ({ projectsArray }) => {\r\n\r\n    const [dataDB, setDataDB] = useState(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [dummy, setDummy] = useState({});\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        const loadData = async () => {\r\n            setLoading(true);\r\n            try {\r\n                // const result = await Axios.post('https://bim.wohhup.com/api/smartsheet/get-sheets-dashboard', { listSheetId: [] });\r\n                setDummy(dummyData);\r\n\r\n                const resDB = await Axios.post(`${SERVER_URL}/sheet/find-many`, { sheetIds: projectsArray.map(x => x.id) });\r\n                setDataDB(convertDataFromDB(resDB.data, projectsArray));\r\n\r\n                setLoading(false);\r\n\r\n            } catch (err) {\r\n                console.log(err);\r\n                setLoading(false);\r\n            };\r\n        };\r\n        loadData();\r\n        // loadRecords();\r\n\r\n    }, []);\r\n\r\n\r\n\r\n    const [_drawingTableVisible, set_DrawingTableVisible] = useState(false);\r\n    const [_drawingTableData, set_DrawingTableData] = useState(null);\r\n    const _openDrawingTable = (projectName, title, drawings, headers, columnsHeaderSorted, isSelectedShownOnly) => {\r\n        set_DrawingTableData({ projectName, title, drawings, headers, columnsHeaderSorted, isSelectedShownOnly });\r\n        set_DrawingTableVisible(true);\r\n    };\r\n    const _closeTableAndReset = () => {\r\n        set_DrawingTableVisible(false);\r\n        set_DrawingTableData(null);\r\n    };\r\n\r\n\r\n\r\n    return (\r\n\r\n        <div style={{ marginTop: 60 }}>\r\n            <Row justify='space-around' style={{ margin: '25px 0 5px 0' }}>\r\n                {dataDB && Object.keys(dataDB).length > 1 && (\r\n                    <>\r\n                        <_ChartBarDrawingLate data={dummy.dummyLateConstruction} title='No Of Drawing Late Construction' />\r\n                        <_ChartBarDrawingLate data={dataDB} title='No Of Drawing Late Approval' />\r\n                        <_ChartBarStack data={dataDB} title='Drawing Status' />\r\n                        <_ChartBarStack data={dummy.productivityDummy} title='Productivity - (days per drawing)' />\r\n                    </>\r\n                )}\r\n            </Row>\r\n\r\n            {!loading && dataDB ? (\r\n                <div style={{ padding: '0 12px' }}>\r\n                    {Object.keys(dataDB).map(projectName => {\r\n                        return (\r\n                            <CardPanelProject\r\n                                title={projectName.toUpperCase()}\r\n                                key={projectName}\r\n                                projectsCount={dataDB[projectName].projectsCount}\r\n                            >\r\n                                <ChartPanel title='Overdue submissions'>\r\n                                    <_ChartProgress\r\n                                        data={dataDB[projectName]}\r\n                                        openDrawingTable={_openDrawingTable}\r\n                                        projectName={projectName}\r\n\r\n                                    />\r\n                                </ChartPanel>\r\n\r\n                                <ChartPanel title='Drawing Status'>\r\n                                    <_ChartPieDrawing\r\n                                        data={dataDB[projectName]}\r\n                                        openDrawingTable={_openDrawingTable}\r\n                                        projectName={projectName}\r\n                                    />\r\n                                </ChartPanel>\r\n\r\n                                <ChartPanel title='Nos of drawing per revision'>\r\n                                    <_ChartBarDrawing\r\n                                        data={dataDB[projectName]}\r\n                                        openDrawingTable={_openDrawingTable}\r\n                                        projectName={projectName}\r\n                                    />\r\n                                </ChartPanel>\r\n\r\n                                <ChartPanel title='Sorted table by category'>\r\n                                    <_FormPivot\r\n                                        data={dataDB[projectName]}\r\n                                        openDrawingTable={_openDrawingTable}\r\n                                        projectName={projectName}\r\n                                    />\r\n                                </ChartPanel>\r\n\r\n                            </CardPanelProject>\r\n                        )\r\n                    })}\r\n\r\n                </div>\r\n            ) : <SkeletonCard />}\r\n\r\n\r\n            {_drawingTableData && (\r\n                <Modal\r\n                    title={_drawingTableData.projectName}\r\n                    visible={_drawingTableVisible}\r\n                    footer={false}\r\n                    onCancel={_closeTableAndReset}\r\n                    width={0.9 * window.innerWidth}\r\n                    height={0.7 * window.innerHeight}\r\n                    // centered={true}\r\n                    style={{\r\n                        // justifyContent: 'center',\r\n                        // alignItems: 'center'\r\n                    }}\r\n                    bodyStyle={{\r\n                        paddingTop: 10\r\n                    }}\r\n                >\r\n                    <div style={{ display: 'flex' }}>\r\n                        <h3 style={{ padding: '0 0 10px 0' }}>{_drawingTableData.title.type}</h3>\r\n                        <Divider type='vertical' style={{ height: 25 }} />\r\n                        <h3 style={{ padding: '0 10px' }}>{_drawingTableData.title.category}</h3>\r\n                        <Divider type='vertical' style={{ height: 25 }} />\r\n                        <h3 style={{ padding: '0 10px' }}>{_drawingTableData.drawings.length + ' drawings'}</h3>\r\n                    </div>\r\n\r\n                    <_TableDrawingList\r\n                        data={_drawingTableData}\r\n                        title={_drawingTableData.title}\r\n                    />\r\n\r\n                </Modal>\r\n            )}\r\n\r\n\r\n        </div>\r\n\r\n    );\r\n};\r\n\r\nexport default PageDashboard;\r\n\r\n\r\n\r\n\r\nconst ChartPanel = ({ title, children }) => {\r\n    return (\r\n        <Col style={{ marginBottom: 10 }} xs={24} md={12} xl={6}>\r\n            <div style={{ fontSize: '18px', textAlign: 'center', fontWeight: 'bold' }}>{title}</div>\r\n            {children}\r\n        </Col>\r\n    );\r\n};\r\n\r\n\r\nconst SkeletonCard = () => {\r\n    return (\r\n        <div style={{ padding: '0 12px' }}>\r\n            <CardPanelProject title='Project loading ...'>\r\n                <div style={{ padding: '0 3px' }}>\r\n                    <Skeleton paragraph={{ rows: 14 }} active />\r\n                </div>\r\n            </CardPanelProject>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\n\r\nconst dummyData = {\r\n    productivityDummy: {\r\n        inputData: [\r\n            {\r\n                'Consultant review and reply': 4,\r\n                'Create update drawing': 3,\r\n                'Create update model': 7,\r\n                'name': 'Sumang'\r\n            },\r\n            {\r\n                'Consultant review and reply': 5,\r\n                'Create update drawing': 4,\r\n                'Create update model': 6,\r\n                'name': 'Handy'\r\n            }\r\n        ],\r\n        inputStack: ['Consultant review and reply', 'Create update drawing', 'Create update model']\r\n    },\r\n    dummyLateConstruction: [\r\n        { name: 'Handy', value: 6 },\r\n        { name: 'Sumang', value: 15 },\r\n    ]\r\n};\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\utils\\functionDashboard.js",["308"],"import Axios from 'axios';\r\nimport _ from 'lodash';\r\nimport moment from 'moment';\r\nimport { _SelectColumnFilter } from '../componentsDashboard/_TableDrawingList';\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const api = Axios.create({\r\n    baseURL: '/api',\r\n    headers: {\r\n        'Content-Type': 'application/json'\r\n    }\r\n});\r\n\r\n\r\n\r\nexport const removeUnwantedHeaders = (columnsIndexArray) => {\r\n\r\n    const unwantedHeader = [\r\n        'Delta_Date',\r\n        'Delta_IT_CT',\r\n        'Delta_Issue',\r\n        'Delta_KTP'\r\n    ];\r\n    unwantedHeader.forEach(hd => {\r\n        delete columnsIndexArray[hd];\r\n    });\r\n    return columnsIndexArray;\r\n};\r\n\r\n\r\n\r\n\r\nexport const getDataConverted = (projectArray) => {\r\n    let dataOutput = {};\r\n    for (let i = 0; i < projectArray.length; i++) {\r\n\r\n        // get the column header\r\n        const project = projectArray[i];\r\n        const categoryArray = _.map(project.columns, 'title');\r\n        let columnsIndexArray = {};\r\n        categoryArray.forEach(cate => {\r\n            project.columns.forEach(cl => {\r\n                if (cl.title === cate) columnsIndexArray[cate] = cl.index;\r\n            });\r\n        });\r\n\r\n        const indexDrawingName = columnsIndexArray['Drawing Name'];\r\n        const indexRev = columnsIndexArray['Rev'];\r\n\r\n        let allDrawings = [];\r\n        let allDrawingsLatestRevision = [];\r\n\r\n        for (let i = 0; i < project.rows.length; i++) {\r\n            const dwg = project.rows[i];\r\n            if (dwg.cells[indexDrawingName].value === undefined) continue; // make sure all drawing name is keyed in\r\n            allDrawings.push([...dwg.cells]);\r\n\r\n            if (dwg.cells[indexRev].value === undefined) {\r\n                allDrawingsLatestRevision.push([...dwg.cells]);\r\n                continue;\r\n            };\r\n\r\n            let found = false;\r\n            for (let j = 0; j < allDrawingsLatestRevision.length; j++) {\r\n                if (allDrawingsLatestRevision[j][indexDrawingName].value === dwg.cells[indexDrawingName].value) {\r\n                    found = true;\r\n                    if (String(allDrawingsLatestRevision[j][indexRev].value) < String(dwg.cells[indexRev].value)) {\r\n                        allDrawingsLatestRevision.splice(j, 1);\r\n                        allDrawingsLatestRevision.push([...dwg.cells]);\r\n                    };\r\n                    break;\r\n                };\r\n            };\r\n            if (!found) allDrawingsLatestRevision.push([...dwg.cells]);\r\n        };\r\n\r\n        dataOutput[project.name.slice(0, project.name.length - 17)] = {\r\n            columnsIndexArray: removeUnwantedHeaders(columnsIndexArray),\r\n            allDrawings,\r\n            allDrawingsLatestRevision\r\n        };\r\n    };\r\n    return dataOutput;\r\n};\r\n\r\n\r\n\r\nexport const getAllDrawingSameValueInOneColumn = (data, column, dataType) => {\r\n\r\n    const { columnsIndexArray, allDrawings, allDrawingsLatestRevision } = data;\r\n\r\n    const drawings = dataType === 'all' ? allDrawings : allDrawingsLatestRevision;\r\n    const indexCategory = columnsIndexArray[column];\r\n\r\n    let drawingCount = {};\r\n    let drawingList = {};\r\n\r\n    drawings.forEach(dwg => {\r\n        const { value } = dwg[indexCategory];\r\n\r\n        drawingCount[value] = (drawingCount[value] || 0) + 1;\r\n        drawingList[value] = [...drawingList[value] || [], dwg];\r\n    });\r\n\r\n    return {\r\n        drawingCount,\r\n        drawingList\r\n    };\r\n};\r\n\r\n\r\n\r\nexport const getDrawingLateNow = (data, type) => {\r\n\r\n    const { allDrawingsLatestRevision, columnsIndexArray } = data;\r\n\r\n    const dwgsLateNow = [];\r\n    const columnHeader = type === 'getApproval' ? 'get Approval'\r\n        : type === 'drgToConsultant' ? 'Drg to Consultant' : null;\r\n\r\n    allDrawingsLatestRevision.forEach(dwg => {\r\n        const status = dwg[columnsIndexArray['Status']].value;\r\n        // make sure drawing is not approved or consultant reviewing\r\n        if (status && (status.includes('Approved') || status === 'Consultant reviewing')) return;\r\n\r\n        const dateT = dwg[columnsIndexArray[`${columnHeader} (T)`]].value;\r\n        const dateA = dwg[columnsIndexArray[`${columnHeader} (A)`]].value;\r\n        if (dateT === undefined || dateA !== undefined) return;\r\n\r\n        const diff = moment(dateT).diff(moment(), 'days');\r\n        if (diff < 0) dwgsLateNow.push([...dwg]);\r\n    });\r\n    return dwgsLateNow;\r\n};\r\n\r\nexport const getDrawingLateNow1 = (drawings, type) => {\r\n\r\n    const dwgsLateNow = [];\r\n    drawings.forEach(dwg => {\r\n        const status = dwg['Status'];\r\n        // make sure drawing is not approved or consultant reviewing\r\n        if (status && (status.includes('Approved') || status === 'Consultant reviewing')) return;\r\n\r\n        const dateT = dwg[`${type} (T)`];\r\n        const dateA = dwg[`${type} (A)`];\r\n        if (dateT === undefined || dateA !== undefined) return;\r\n\r\n        const diff = moment(dateT).diff(moment(), 'days');\r\n        if (diff < 0) dwgsLateNow.push(dwg);\r\n    });\r\n    return dwgsLateNow;\r\n};\r\n\r\n\r\n\r\nexport const mergeUndefined = ({ drawingCount, drawingList }, mergeWith, columnsIndexArray, columnHeader) => {\r\n    if (drawingCount['undefined'] === undefined) return;\r\n\r\n    drawingCount[mergeWith] = (drawingCount[mergeWith] || 0) + drawingCount['undefined'];\r\n    delete drawingCount['undefined'];\r\n\r\n    drawingList[mergeWith] = [...drawingList[mergeWith] || [], ...drawingList['undefined']];\r\n    delete drawingList['undefined'];\r\n\r\n    return {\r\n        drawingCount,\r\n        drawingList\r\n    };\r\n};\r\n\r\n\r\nexport const formatStringNameToId = (str) => {\r\n    let mystring = str.replace(/ /g, '').replace(/\\(|\\)/g, '');\r\n    return mystring.charAt(0).toLowerCase() + mystring.slice(1);\r\n};\r\n\r\n\r\nexport const pickDataToTable = (drawings, columnsIndexArray) => {\r\n    let arr = [];\r\n    drawings.forEach(dwg => {\r\n        let obj = {};\r\n        Object.keys(columnsIndexArray).forEach(header => {\r\n            obj[formatStringNameToId(header)] = dwg[columnsIndexArray[header]].value || '. ';\r\n        });\r\n        arr.push(obj);\r\n    });\r\n    return arr;\r\n};\r\n\r\n\r\nexport const convertDataToStackedChart = (data) => {\r\n    let dataChart = [];\r\n    let allKeys = [];\r\n    data && Object.keys(data).forEach(project => {\r\n        const { drawingCount } = mergeUndefined(getAllDrawingSameValueInOneColumn(data[project], 'Status'), 'Not Started');\r\n        dataChart.push({ ...drawingCount, name: project });\r\n        allKeys = [...allKeys, ...Object.keys(drawingCount)];\r\n    });\r\n    const itemArr = [...new Set(allKeys)];\r\n\r\n    itemArr.forEach(key => {\r\n        dataChart.forEach(projectData => {\r\n            if (key in projectData) return;\r\n            projectData[key] = 0;\r\n        });\r\n    });\r\n\r\n    return {\r\n        dataChart,\r\n        itemArr\r\n    };\r\n};\r\n\r\n\r\n\r\nexport const sortStatusOrder = (data) => {\r\n\r\n    const statusArr = [...data];\r\n    const inputStackData = [\r\n        'Not Started',\r\n        '1st cut of model in-progress',\r\n        '1st cut of drawing in-progress',\r\n        'Pending design',\r\n        'Consultant reviewing',\r\n        'Reject and resubmit',\r\n        'Approved with comments, to Resubmit',\r\n        'Revise In-Progress',\r\n        'Approved with Comment, no submission Required',\r\n        'Approved for Construction',\r\n    ];\r\n    let arr = [];\r\n    inputStackData.forEach(element => {\r\n        statusArr.forEach(e => {\r\n            if (element === e) arr.push(element);\r\n        });\r\n    });\r\n    if (arr.length === 0) return statusArr;\r\n    return arr;\r\n};\r\n\r\n\r\n\r\nexport const randomInteger = (min, max) => {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n\r\nexport const createDummyRecords = () => {\r\n\r\n    let categoryArr = [\r\n        'drawingLateApproval',\r\n        'drawingLateSubmission',\r\n        'drawingLateConstruction',\r\n        'drawingApprovedForConstruction',\r\n        'drawingApprovedWithCommentNoSubmissionRequired',\r\n        'drawingApprovedWithCommentsToResubmit',\r\n        // 'drawingReviseInProgress',\r\n        // 'drawingConsultantReviewing',\r\n        // 'drawing1stCutOfDrawingInProgress',\r\n        // 'drawingNotStarted',\r\n    ];\r\n\r\n    let recordArray = {};\r\n\r\n    categoryArr.forEach(cate => {\r\n        let arr = {};\r\n        for (let i = 0; i < 100; i++) {\r\n            arr[moment(new Date(2020, 6, 21)).add(i, 'day')._d] = randomInteger(1, 15);\r\n        };\r\n        recordArray[cate] = arr;\r\n    });\r\n\r\n    return recordArray;\r\n};\r\n\r\n\r\nconst getColumnWidth = (rows, accessor, headerText) => {\r\n    const maxWidth = 400;\r\n    const magicSpacing = 10;\r\n    const cellLength = Math.max(\r\n        ...rows.map(row => (`${row[accessor]}` || '').length),\r\n        headerText.length,\r\n    );\r\n\r\n    return Math.min(maxWidth, cellLength * magicSpacing);\r\n};\r\n\r\n\r\n\r\n\r\nconst getHeaderWidth = (header) => {\r\n\r\n    if (header === 'RFA Ref') return 270;\r\n    else if (\r\n        header === 'Block/Zone' ||\r\n        header === 'Level' || header === 'Unit/CJ' ||\r\n        header === 'Drg Type' || header === 'Use For' ||\r\n        header === 'Coordinator In Charge' || header === 'Modeller' ||\r\n        header === 'Model Progress' || header === 'Drawing Progress' ||\r\n        header === 'Construction Start'\r\n    ) return 200;\r\n    else if (header === 'Construction Issuance Date') return 220;\r\n    else if (header === 'Drawing') return 200;\r\n\r\n    else if (\r\n        header === 'Drg To Consultant (A)' ||\r\n        header === 'Drg To Consultant (T)' ||\r\n        header === 'Get Approval (A)' ||\r\n        header === 'Get Approval (T)'\r\n    ) return 220;\r\n\r\n    else if (header.includes('(A)') || header.includes('(T)')) return 190;\r\n\r\n\r\n\r\n\r\n    else if (header === 'Rev') return 150;\r\n    else if (header === 'Status') return 380;\r\n    else if (header === 'Remark') return 350;\r\n    else if (header === 'Drawing Number') return 300;\r\n    else if (header === 'Drawing Name') return 350;\r\n    else return 300;\r\n\r\n};\r\n\r\n\r\n\r\n\r\nexport const getColumnsHeader1 = (columnsIndexArray) => {\r\n\r\n    let columnsName = [\r\n        {\r\n            Header: '',\r\n            id: 'index',\r\n            accessor: (row, i) => i + 1,\r\n            width: 50,\r\n        },\r\n    ];\r\n\r\n    const filterSelect = (key) => {\r\n        if (\r\n            key === 'Status' ||\r\n            key === 'Rev' ||\r\n            key === 'Modeller' ||\r\n            key === 'Remark' ||\r\n            key === 'Coordinator In Charge' ||\r\n            key === 'Drg Type' ||\r\n            key === 'Use For' ||\r\n            key === 'Block/Zone' ||\r\n            key === 'Level' ||\r\n            key === 'Unit/CJ' ||\r\n            key === 'RFA Ref'\r\n        ) {\r\n            return true;\r\n        };\r\n    };\r\n\r\n    columnsIndexArray.forEach(hd => {\r\n        const width = getHeaderWidth(hd);\r\n\r\n        // const accessor = formatStringNameToId(hd);\r\n        const accessor = hd;\r\n\r\n        if (filterSelect(hd)) {\r\n            columnsName.push({\r\n                Header: hd,\r\n                Filter: _SelectColumnFilter,\r\n                accessor,\r\n                width,\r\n            });\r\n        } else {\r\n            columnsName.push({\r\n                Header: hd,\r\n                accessor,\r\n                width,\r\n            });\r\n        };\r\n    });\r\n    return columnsName;\r\n};\r\n\r\n\r\n\r\nexport const getHeaderSorted = (columnsData, columnsHeader) => {\r\n\r\n    let arr = [];\r\n    columnsData.forEach(headerData => {\r\n        if (headerData.Header === '') {\r\n            arr.push(headerData);\r\n            return;\r\n        };\r\n        columnsHeader.forEach(header => {\r\n            if (headerData.Header === header) arr.push(headerData);\r\n        });\r\n    });\r\n    return arr;\r\n};\r\nexport const getHeaderSorted1 = (columnsData, columnsHeader) => {\r\n    let arr = [];\r\n    columnsData.forEach(headerData => {\r\n        if (headerData.Header === '') {\r\n            arr.push(headerData);\r\n            return;\r\n        };\r\n        columnsHeader.forEach(header => {\r\n            if (headerData.Header === header) arr.push(headerData);\r\n        });\r\n    });\r\n    return arr;\r\n};\r\n\r\n\r\nexport const countAverage = (nums) => nums.reduce((a, b) => (a + b)) / nums.length;\r\n\r\n\r\nexport const recordGetAllMonth = (data, category) => {\r\n    let arr = [];\r\n    Object.keys(data[category]).forEach(item => {\r\n        arr.push(moment(item).add(-1, 'day').format('MM/YY'));\r\n    });\r\n    return [...new Set(arr)];\r\n};\r\n\r\n\r\n\r\nexport const recordDataToChartDaily = (data, category, month) => {\r\n    let arr = [];\r\n    Object.keys(data[category]).forEach(item => {\r\n        const date = moment(item).add(-1, 'day');\r\n        if (date.format('MM/YY') === month) {\r\n            arr.push({\r\n                date: date.format('DD'),\r\n                value: data[category][item]\r\n            });\r\n        };\r\n    });\r\n    return arr;\r\n};\r\n\r\n\r\nexport const recordDataToChartWeekly = (data, category) => {\r\n    let arr = [];\r\n    Object.keys(data[category]).forEach(item => {\r\n        const date = moment(item).add(-1, 'day');\r\n        arr.push({\r\n            week: date.format('W'),\r\n            month: date.format('MM'),\r\n            year: date.format('YY'),\r\n            value: data[category][item]\r\n        });\r\n    });\r\n    let groups = {};\r\n    for (let i = 0; i < arr.length; i++) {\r\n        let weekName = `W${arr[i].week} ${arr[i].month}/${arr[i].year}`;\r\n        if (!groups[weekName]) {\r\n            groups[weekName] = [];\r\n        };\r\n        groups[weekName].push(arr[i].value);\r\n    };\r\n    let arrOutput = [];\r\n    for (let week in groups) {\r\n        arrOutput.push({ week, value: Math.round(countAverage(groups[week])) });\r\n    };\r\n    return arrOutput;\r\n};\r\n\r\n\r\nexport const recordDataToChartMonthly = (data, category) => {\r\n    let arr = [];\r\n    Object.keys(data[category]).forEach(item => {\r\n        const date = moment(item).add(-1, 'day');\r\n        arr.push({\r\n            week: date.format('W'),\r\n            month: date.format('MM'),\r\n            year: date.format('YY'),\r\n            value: data[category][item]\r\n        });\r\n    });\r\n    let groups = {};\r\n    for (let i = 0; i < arr.length; i++) {\r\n        let monthName = `${arr[i].month}/${arr[i].year}`;\r\n        if (!groups[monthName]) {\r\n            groups[monthName] = [];\r\n        };\r\n        groups[monthName].push(arr[i].value);\r\n    };\r\n    let arrOutput = [];\r\n    for (let month in groups) {\r\n        arrOutput.push({ month, value: Math.round(countAverage(groups[month])) });\r\n    };\r\n    return arrOutput;\r\n};\r\n\r\n\r\n\r\n\r\nexport const changeColumnOrder = (arr, accessor, leftOrRight, to) => {\r\n    const array = [...arr];\r\n    let cl = array.find(item => item.accessor === accessor);\r\n    const index = array.indexOf(cl);\r\n    const f = array.splice(index, 1)[0];\r\n    if (leftOrRight) {\r\n        array.splice(index + leftOrRight, 0, f);\r\n    } else {\r\n        array.splice(to, 0, f);\r\n    };\r\n    return array;\r\n};","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\CardPanelProject.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\assets\\constantDashboard.js",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\CardPanel.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\PanelRightClick.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\ChartBarRecordPanel.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\ChartBarRecord.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartBarDrawing.jsx",["309"],"import { Badge } from 'antd';\r\nimport React, { useState } from 'react';\r\nimport { Bar, BarChart, CartesianGrid, LabelList, Tooltip, XAxis, YAxis } from 'recharts';\r\nimport styled from 'styled-components';\r\nimport { pieChartColors2 } from '../assets/constantDashboard';\r\nimport { getAllDrawingSameValueInOneColumn, sortStatusOrder } from '../utils/functionDashboard';\r\n\r\n\r\n\r\nconst getSubDrawingByStatus = (drawingList, columnsIndexArray) => {\r\n\r\n    let drawingCountSubStatus = [];\r\n    let drawingListSubStatus = {};\r\n    let inputStack = [];\r\n\r\n    for (const key in drawingList) {\r\n        const result = getAllDrawingSameValueInOneColumn({\r\n            allDrawingsLatestRevision: drawingList[key],\r\n            columnsIndexArray\r\n        }, 'Status');\r\n\r\n        const drawingCountArr = result.drawingCount;\r\n        const drawingListArr = result.drawingList;\r\n\r\n\r\n        if ('undefined' in drawingCountArr) {\r\n            drawingCountArr['Not Started'] = drawingCountArr['undefined'] + drawingCountArr['Not Started'] || 0;\r\n            delete drawingCountArr['undefined'];\r\n        };\r\n\r\n        if ('undefined' in drawingListArr) {\r\n            drawingListArr['Not Started'] = [...drawingListArr['undefined'], drawingListArr['Not Started'] || []];\r\n            delete drawingListArr['undefined'];\r\n        };\r\n\r\n        for (const key in drawingCountArr) {\r\n            if (key !== 'undefined') inputStack.push(key);\r\n        };\r\n\r\n        drawingCountArr['name'] = key;\r\n        drawingCountSubStatus.push(drawingCountArr);\r\n        drawingListSubStatus[key] = drawingListArr;\r\n    };\r\n\r\n    return {\r\n        drawingCountSubStatus,\r\n        drawingListSubStatus,\r\n        inputStack: [...new Set(inputStack)]\r\n    };\r\n};\r\n\r\n\r\nconst _ChartBarDrawing = ({ data, openDrawingTable, projectName }) => {\r\n\r\n    const { drawingCountSubStatus, drawingListSubStatus, inputStack, headers } = data;\r\n\r\n\r\n    const onClick = (e, item) => {\r\n        openDrawingTable(\r\n            projectName,\r\n            { type: 'Drawings by revision', category: `Revision: ${e.name} - Status: ${item}` },\r\n            drawingListSubStatus[e.name][item],\r\n            headers\r\n        );\r\n    };\r\n\r\n    const LabelCustomStacked = (props) => {\r\n        const { x, y, value, height } = props;\r\n        const fontSize = 13;\r\n        return (\r\n            <text\r\n                style={{ fontSize: fontSize, boxShadow: '5px 15px 24px 5px black', }}\r\n                x={x + 24}\r\n                y={y + height / 2}\r\n                fill='#2c3e50'\r\n                dominantBaseline='central'\r\n            >\r\n                {height + 3 < fontSize ? null : value}\r\n            </text>\r\n        );\r\n    };\r\n\r\n    const LabelCustomStackedTotal = (props) => {\r\n        const { x, y, value, topBar } = props;\r\n        return (\r\n            <>\r\n                <text\r\n                    style={{ fontSize: 17, fontWeight: 'bold' }}\r\n                    x={x - 2}\r\n                    y={y - 10}\r\n                    fill='black'\r\n                    dominantBaseline='central'\r\n\r\n                >\r\n                    {topBar ? value : null}\r\n                </text>\r\n            </>\r\n        );\r\n    };\r\n    const [tooltip, setTooltip] = useState(false);\r\n    const TooltipCustom = (props) => {\r\n        const { active, payload } = props;\r\n        if (!active || !tooltip) return null;\r\n        for (const bar of payload)\r\n            if (bar.dataKey === tooltip) {\r\n                return (\r\n                    <div style={{\r\n                        backgroundColor: 'white',\r\n                        color: bar.fill,\r\n                        fontSize: 14,\r\n                        border: `1px solid ${bar.fill}`,\r\n                        padding: '3px',\r\n                        maxWidth: '170px'\r\n                    }}>\r\n                        {bar.name}\r\n                        <br />\r\n                        <mark style={{ backgroundColor: bar.fill }}>\r\n                            ({bar.value})\r\n                        </mark>\r\n                    </div>\r\n                );\r\n            };\r\n        return null;\r\n    };\r\n\r\n\r\n    return (\r\n        <div style={{ margin: '0 auto', display: 'table' }}>\r\n            <BarChart\r\n                width={350}\r\n                height={350}\r\n                data={drawingCountSubStatus.sort((a, b) => {\r\n                    if (a.name < b.name) return -1;\r\n                    if (a.name > b.name) return 1;\r\n                    return 0;\r\n                })}\r\n                margin={{ top: 35, right: 15, left: 0, bottom: 20 }}\r\n                padding={{ top: 5 }}\r\n                barSize={23}\r\n            >\r\n                <CartesianGrid strokeDasharray='3 3' />\r\n                <XAxis tickSize={3} dataKey='name' textAnchor='middle' interval={0} scale='point' padding={{ left: 35, right: 35 }} />\r\n                <YAxis />\r\n                <Tooltip content={<TooltipCustom />} />\r\n                {sortStatusOrder(inputStack).map((item, i) => {\r\n                    return (\r\n                        <Bar\r\n                            key={item}\r\n                            dataKey={item}\r\n                            stackId='a'\r\n                            fill={pieChartColors2[item]}\r\n                            isAnimationActive={false}\r\n                            onClick={(e) => onClick(e, item)}\r\n                            onMouseOver={() => setTooltip(item)}\r\n                            label={<LabelCustomStackedTotal topBar={i === inputStack.length - 1} />}\r\n                        >\r\n                            <LabelList dataKey={item} position='left' content={<LabelCustomStacked item={item} />} />\r\n                        </Bar>\r\n                    )\r\n                })}\r\n\r\n            </BarChart>\r\n\r\n            <div style={{ paddingLeft: 50, height: 180 }}>\r\n\r\n                {sortStatusOrder(inputStack).reverse().map((key, i) => (\r\n                    <div key={key} style={{ display: 'flex' }}>\r\n                        <StyledBadge\r\n                            size='small'\r\n                            color={pieChartColors2[key]}\r\n                            text={key}\r\n                        />\r\n                    </div>\r\n                ))}\r\n                \r\n            </div>\r\n        </div>\r\n\r\n    );\r\n};\r\n\r\nexport default _ChartBarDrawing;\r\n\r\nconst StyledBadge = styled(Badge)`\r\n    .ant-badge-status-dot {\r\n        width: 15px;\r\n        height: 15px;\r\n        border-radius: 0;\r\n    }\r\n`;\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_TableDrawingList.jsx",["310","311","312","313"],"import { Button, Icon, Input } from 'antd';\r\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport {\r\n    useBlockLayout,\r\n    useColumnOrder,\r\n    useExpanded,\r\n    useFilters,\r\n    useFlexLayout,\r\n    useGlobalFilter,\r\n    useGroupBy,\r\n    useResizeColumns,\r\n    useRowSelect,\r\n    useSortBy,\r\n    useTable\r\n} from 'react-table';\r\nimport { FixedSizeList } from 'react-window';\r\nimport styled from 'styled-components';\r\nimport { colorType } from '../assets/constantDashboard';\r\nimport { changeColumnOrder, formatStringNameToId, getColumnsHeader1, getHeaderSorted1 } from '../utils/functionDashboard';\r\nimport PanelRightClick from './PanelRightClick';\r\n\r\n\r\n\r\nconst scrollbarWidth = () => {\r\n    const scrollDiv = document.createElement('div');\r\n    scrollDiv.setAttribute(\r\n        'style',\r\n        'width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;'\r\n    );\r\n    document.body.appendChild(scrollDiv);\r\n    const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n    document.body.removeChild(scrollDiv);\r\n    return scrollbarWidth;\r\n};\r\n\r\nconst headerProps = (props, { column }) => {\r\n    return getStyles(props, column.align);\r\n};\r\n\r\nconst checkCellFix = (cell) => (\r\n    !cell.isAggregated &&\r\n    !cell.isGrouped &&\r\n    cell.isRepeatedValue &&\r\n    cell.row.subRows.length !== 0 &&\r\n    // cell.row.depth === 0\r\n    cell.row.groupByID !== cell.column.id\r\n);\r\n\r\nconst cellProps = (props, { cell }) => {\r\n\r\n    const colorFix = checkCellFix(cell) && '#f6e58d';\r\n\r\n    props.style.background = colorFix || (cell.isGrouped ? '#7ed6df' :\r\n        cell.isAggregated ? '#f6e58d' :\r\n            cell.isPlaceholder ? '#ff000042' :\r\n                'white');\r\n    return getStyles(props, cell.column.align);\r\n};\r\n\r\nconst getStyles = (props, align = 'left') => [props,\r\n    {\r\n        style: {\r\n            justifyContent: align === 'right' ? 'flex-end' : 'flex-start',\r\n            alignItems: 'flex-start',\r\n            display: 'flex',\r\n        },\r\n    },\r\n];\r\n\r\nconst headerWithNoGroupFunction = (column) => {\r\n    const arr = [\r\n        'Drawing Number', 'Drawing Name'\r\n    ];\r\n    return arr.indexOf(column) !== -1;\r\n};\r\n\r\nexport const DefaultColumnFilter = ({\r\n    column: { filterValue, preFilteredRows, setFilter },\r\n}) => {\r\n    const count = preFilteredRows.length;\r\n\r\n    const [btnActive, setBtnActive] = useState(false);\r\n    const toggleBtn = () => {\r\n        setBtnActive(!btnActive);\r\n        setFilter(undefined);\r\n    };\r\n\r\n    return (\r\n        <div style={{ display: 'flex' }}>\r\n            <div onClick={toggleBtn} style={{ cursor: 'pointer' }}>\r\n                {btnActive ? <IconTable type='search' color='green' /> : <IconTable type='search' />}\r\n            </div>\r\n            {btnActive && (\r\n                <input\r\n                    value={filterValue || ''}\r\n                    onChange={e => {\r\n                        setFilter(e.target.value || undefined) // Set undefined to remove the filter entirely\r\n                    }}\r\n                    placeholder={`Search ${count} records...`}\r\n                    style={{ height: 21, margin: 0 }}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const _SelectColumnFilter = ({\r\n    column: { filterValue, setFilter, preFilteredRows, id }\r\n}) => {\r\n\r\n    const options = useMemo(() => {\r\n        const options = new Set();\r\n\r\n        preFilteredRows.forEach(row => {\r\n            options.add(row.values[id]);\r\n        });\r\n\r\n        return [...options.values()];\r\n    }, [id, preFilteredRows]);\r\n\r\n    const [btnActive, setBtnActive] = useState(false);\r\n\r\n    const toggleBtn = () => {\r\n        setBtnActive(!btnActive);\r\n        setFilter(undefined);\r\n    };\r\n\r\n    return (\r\n        <div style={{ display: 'flex' }}>\r\n\r\n            <div onClick={toggleBtn} style={{ cursor: 'pointer' }}>\r\n                {btnActive\r\n                    ? <IconTable type='search' color='green' />\r\n                    : <IconTable type='search' />\r\n                }\r\n            </div>\r\n\r\n            {btnActive && (\r\n                <select\r\n                    value={filterValue}\r\n                    onChange={e => setFilter(e.target.value || undefined)}\r\n                    style={{ height: 21, width: 40, margin: 0 }}\r\n                >\r\n                    <option value=''>All</option>\r\n                    {options.map((option, i) => (\r\n                        <option key={i} value={option}>\r\n                            {option}\r\n                        </option>\r\n                    ))}\r\n                </select>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const GlobalFilter = ({ filter, setFilter }) => {\r\n\r\n    const [value, setValue] = useState(filter);\r\n\r\n    const onChange = value => {\r\n        setTimeout(() => {\r\n            setFilter(value || undefined);\r\n        }, 1000);\r\n    };\r\n\r\n    return (\r\n        <Input.Search\r\n            placeholder='Search ...'\r\n            value={value || ''}\r\n            onChange={e => {\r\n                setValue(e.target.value);\r\n                onChange(e.target.value);\r\n            }}\r\n            style={{ width: 200 }}\r\n        />\r\n    );\r\n};\r\n\r\n\r\n\r\nconst _TableDrawingList = ({ data }) => {\r\n\r\n    const [openAllColumn, setOpenAllColumn] = useState(false);\r\n    const { title, drawings, headers, columnsHeaderSorted, isSelectedShownOnly } = data;\r\n\r\n    const tableDataInput = drawings;\r\n    const columnsName = getColumnsHeader1(headers);\r\n\r\n\r\n    const columns = useMemo(() => {\r\n        return columnsHeaderSorted && !openAllColumn && isSelectedShownOnly ?\r\n            getHeaderSorted1(columnsName, columnsHeaderSorted) :\r\n            columnsName;\r\n    }, [columnsHeaderSorted, columnsName, openAllColumn, isSelectedShownOnly]);\r\n\r\n\r\n    const [reorderColumns, setReorderColumns] = useState(false);\r\n    const columnsInput = reorderColumns ? reorderColumns : columns;\r\n\r\n\r\n    const openAllColumnTable = () => {\r\n        setOpenAllColumn(true);\r\n    };\r\n\r\n    const moveColumnLocation = (value, columnActive) => {\r\n        if (value === 1 || value === -1) {\r\n            setReorderColumns(changeColumnOrder(columnsInput, columnActive.id, value));\r\n        };\r\n    };\r\n\r\n\r\n    return (\r\n        <Table\r\n            title={title}\r\n            columns={columnsInput}\r\n            data={tableDataInput}\r\n            openAllColumnTable={openAllColumnTable}\r\n            moveColumnLocation={moveColumnLocation}\r\n            columnsHeaderSorted={columnsHeaderSorted}\r\n            hiddenColumnsArray={columns.filter(\r\n                cl => cl.Header.includes('(A)') ||\r\n                    cl.Header.includes('(T)') ||\r\n                    cl.Header === 'Model Progress' ||\r\n                    cl.Header === 'Drawing Progress'\r\n            ).map(x => x.accessor)}\r\n\r\n        />\r\n    );\r\n};\r\nexport default _TableDrawingList;\r\n\r\n\r\n\r\nconst Table = ({\r\n    columns,\r\n    data,\r\n    hiddenColumnsArray,\r\n    openAllColumnTable,\r\n    title,\r\n    moveColumnLocation,\r\n    columnsHeaderSorted\r\n}) => {\r\n\r\n    const listRef = useRef();\r\n    const defaultColumn = useMemo(() => ({\r\n        // minWidth: 30, // minWidth is only used as a limit for resizing\r\n        // width: 150, // width is used for both the flex-basis and flex-grow\r\n        // maxWidth: 200, // maxWidth is only used as a limit for resizing\r\n        Filter: DefaultColumnFilter,\r\n    }), []);\r\n\r\n    const scrollBarSize = useMemo(() => scrollbarWidth(), []);\r\n\r\n    const reactTable = useTable(\r\n        {\r\n            columns,\r\n            data,\r\n            defaultColumn,\r\n            initialState: {\r\n                hiddenColumns: hiddenColumnsArray\r\n            },\r\n            autoResetExpanded: false,\r\n        },\r\n        useFilters,\r\n        useGlobalFilter,\r\n        useGroupBy,\r\n        useExpanded,\r\n        useSortBy,\r\n        useResizeColumns,\r\n        useFlexLayout,\r\n        useRowSelect,\r\n        useBlockLayout,\r\n        useColumnOrder,\r\n        hooks => {\r\n            hooks.useInstanceBeforeDimensions.push(({ headerGroups }) => {\r\n                // fix the parent group of the selection button to not be resizable\r\n                const selectionGroupHeader = headerGroups[0].headers[0];\r\n                selectionGroupHeader.canResize = true;\r\n            })\r\n        },\r\n    );\r\n\r\n    const {\r\n        getTableProps,\r\n        getTableBodyProps,\r\n        headerGroups,\r\n        rows,\r\n        totalColumnsWidth,\r\n        prepareRow,\r\n        disableMultiSort,\r\n        isMultiSortEvent = (e) => e.shiftKey,\r\n        state,\r\n        setGlobalFilter,\r\n        toggleHideAllColumns,\r\n        toggleGroupBy,\r\n        toggleExpanded,\r\n        expandedRows\r\n\r\n    } = reactTable;\r\n\r\n    const { globalFilter, expanded } = state;\r\n    const [panelFunctionVisible, setPanelFunctionVisible] = useState(false);\r\n    const [topPanelFunction, setTopPanelFunction] = useState(0);\r\n    const [leftPanelFunction, setLeftPanelFunction] = useState(0);\r\n\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        columnsHeaderSorted && columnsHeaderSorted.forEach(name => {\r\n            if (name !== 'Drawing Name' && name !== 'Drawing Number') {\r\n                toggleGroupBy(formatStringNameToId(name), true);\r\n            };\r\n        });\r\n    }, []);\r\n\r\n    const [maxRowExpand, setMaxRowExpand] = useState(0);\r\n    useEffect(() => {\r\n        setMaxRowExpand(Object.values(expanded).length);\r\n\r\n        if (Object.values(expanded).length >= maxRowExpand) {\r\n            expandedRows.forEach(row => {\r\n                toggleExpanded(row.id, true);\r\n            });\r\n        };\r\n    }, [expandedRows]);\r\n\r\n\r\n    const handleMouseDown = (e) => {\r\n        if (e.button === 0) setPanelFunctionVisible(false);\r\n    };\r\n    useEffect(() => {\r\n        document.addEventListener('mousedown', handleMouseDown);\r\n        return () => document.removeEventListener('mousedown', handleMouseDown);\r\n    }, []);\r\n\r\n    const panelFunction = (e, column) => {\r\n        setColumnActive(column);\r\n        setPanelFunctionVisible(true);\r\n        const clickX = e.clientX;\r\n        const clickY = e.clientY;\r\n        const screenW = window.innerWidth;\r\n        const screenH = window.innerHeight;\r\n\r\n        const right = (screenW - clickX) > 179;\r\n        const left = !right;\r\n        const top = (screenH - clickY) > 379;\r\n        const bottom = !top;\r\n\r\n        if (right) {\r\n            setLeftPanelFunction(`${clickX + 5}px`);\r\n        };\r\n        if (left) {\r\n            setLeftPanelFunction(`${clickX - 179 - 5}px`);\r\n        };\r\n        if (top) {\r\n            setTopPanelFunction(`${clickY + 5}px`);\r\n        };\r\n        if (bottom) {\r\n            setTopPanelFunction(`${clickY - 379 - 5}px`);\r\n        };\r\n    };\r\n\r\n    const [columnActive, setColumnActive] = useState(false);\r\n    const buttonPanelFunction = (btn) => {\r\n        if (btn === 'Hide this column') {\r\n            columnActive.toggleHidden(true);\r\n        } else if (btn === 'Unhide all') {\r\n            toggleHideAllColumns(false);\r\n        } else if (btn === 'Move to left') {\r\n            moveColumnLocation(-1, columnActive);\r\n        } else if (btn === 'Move to right') {\r\n            moveColumnLocation(1, columnActive);\r\n        } else if (btn === 'Move to ...') {\r\n            return;\r\n        };\r\n    };\r\n\r\n\r\n\r\n    const RenderRow = useCallback(args => {\r\n        const { index, style } = args;\r\n        const row = rows[index];\r\n        prepareRow(row);\r\n\r\n        return (\r\n            <div {...row.getRowProps({ style })} className='tr'>\r\n                {row.cells.map(cell => {\r\n                    return (\r\n                        <div {...cell.getCellProps(cellProps)} className='td'>\r\n                            {cell.isGrouped ? (\r\n                                <>\r\n                                    <span {...row.getExpandedToggleProps()}>\r\n                                        {row.isExpanded ? <IconTable type='up-circle' color='grey' /> : <IconTable type='down-circle' color='grey' />}\r\n                                    </span>{' '}\r\n                                    {cell.render('Cell')} ({row.subRows.length + ' nos'})\r\n                                </>\r\n                            ) : cell.isAggregated ? cell.render('Aggregated')\r\n                                    : cell.isPlaceholder ? null\r\n                                        : checkCellFix(cell) ? null\r\n                                            : cell.render('Cell')}\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n        );\r\n    }, [prepareRow, rows]);\r\n\r\n\r\n\r\n\r\n    return (\r\n        <>\r\n            <div style={{ display: 'flex', marginBottom: 15 }}>\r\n                <GlobalFilter filter={globalFilter} setFilter={setGlobalFilter} />\r\n\r\n                {title.type === 'Sorted table' && (\r\n                    <Button onClick={openAllColumnTable} style={{ marginLeft: 15, background: colorType.grey4 }}>View all drawings</Button>\r\n                )}\r\n\r\n            </div>\r\n\r\n\r\n            <Container>\r\n                <div {...getTableProps()} className='table'>\r\n                    <div className='thead'>\r\n                        {headerGroups.map(headerGroup => (\r\n                            <div className='tr' {...headerGroup.getHeaderGroupProps()}>\r\n                                {headerGroup.headers.map(column => {\r\n                                    return (\r\n                                        <div\r\n                                            className='th'\r\n                                            {...column.getHeaderProps(headerProps)}\r\n                                        >\r\n                                            {column.canResize && (\r\n                                                <div {...column.getResizerProps()}\r\n                                                    className={`resizer ${column.isResizing ? 'isResizing' : ''}`}\r\n                                                />\r\n                                            )}\r\n\r\n                                            <div style={{ fontWeight: 'bold', marginRight: 10 }}>\r\n                                                {column.render('Header')}\r\n                                            </div>\r\n\r\n                                            {column.canGroupBy && column.Header !== '' && (\r\n                                                <span {...column.getGroupByToggleProps()}>\r\n                                                    {headerWithNoGroupFunction(column.Header) ? null\r\n                                                        : column.isGrouped ? <IconTable type='stop' color='red' />\r\n                                                            : <IconTable type='plus-circle' />\r\n                                                    }\r\n                                                </span>\r\n                                            )}\r\n\r\n                                            <span {...column.getSortByToggleProps()}\r\n                                                onClick={\r\n                                                    column.canSort ? (e) => {\r\n                                                        e.persist();\r\n                                                        column.toggleSortBy(undefined, !disableMultiSort && isMultiSortEvent(e));\r\n                                                        listRef.current.scrollToItem(0);\r\n                                                    } : undefined\r\n                                                }\r\n                                            >\r\n                                                {column.isSorted\r\n                                                    ? (column.isSortedDesc\r\n                                                        ? <IconTable type='sort-ascending' color='green' />\r\n                                                        : <IconTable type='sort-descending' color='green' />)\r\n                                                    : <IconTable type='ordered-list' />}\r\n                                            </span>\r\n\r\n                                            <span>\r\n                                                {column.canFilter && column.Header !== ''\r\n                                                    ? column.render('Filter') : null\r\n                                                }\r\n                                            </span>\r\n\r\n\r\n                                        </div>\r\n                                    )\r\n                                })}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div {...getTableBodyProps()} className='tbody'>\r\n                        <FixedSizeList\r\n                            ref={listRef}\r\n                            height={500}\r\n                            itemCount={rows.length}\r\n                            itemSize={25}\r\n                            width={totalColumnsWidth}\r\n                            // width={3500}\r\n                            style={{ overflowX: 'hidden' }}\r\n                        >\r\n                            {RenderRow}\r\n                        </FixedSizeList>\r\n                    </div>\r\n\r\n                </div>\r\n            </Container>\r\n\r\n            {panelFunctionVisible && (\r\n                <PanelRightClick\r\n                    left={leftPanelFunction} top={topPanelFunction}\r\n                    buttonPanelFunction={buttonPanelFunction}\r\n                />\r\n            )}\r\n\r\n        </>\r\n    );\r\n};\r\n\r\nconst borderLine = `1px solid ${colorType.grey2}`\r\n\r\nconst Container = styled.div`\r\n\r\n    white-space: nowrap;\r\n    height: ${0.6 * window.innerHeight}px;\r\n    display: block;\r\n    overflow: scroll;\r\n    overflow-y: hidden;\r\n    border: ${borderLine};\r\n\r\n\r\n    .table {\r\n\r\n        border-spacing: 0;\r\n        position: relative;\r\n\r\n        .thead {\r\n            position: absolute;\r\n            z-index: 1000;\r\n            background-color: ${colorType.grey1};\r\n            top: 0;\r\n        }\r\n\r\n        .tbody {\r\n            padding-top: 36px;\r\n            overflow-y: auto;\r\n            overflow-x: hidden;\r\n            height: ${0.7 * window.innerHeight}px;\r\n            /* width: ${props => props.totalWidth}px; */\r\n            /* .tr:first-child {\r\n                padding-top: 100px; // shift down the first row of body\r\n            } */\r\n        }\r\n\r\n        .tr {\r\n            :last-child {\r\n                .td {\r\n                    /* border-bottom: 0; */\r\n                }\r\n            }\r\n        }\r\n\r\n    \r\n        /* .tr:nth-child(even) {\r\n            background-color: ${colorType.grey4};\r\n        } */\r\n        \r\n        .th, .td {\r\n            color: black;\r\n            margin: 0;\r\n            padding: 0.1rem;\r\n            padding-left: 0.3rem;\r\n            border-right: ${borderLine};\r\n            border-bottom: ${borderLine};\r\n            /* In this example we use an absolutely position resizer, so this is required. */\r\n            position: relative;\r\n\r\n            white-space: nowrap;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n\r\n            \r\n            :last-child {\r\n                border-right: 0;\r\n            }\r\n            .resizer {\r\n                right: 0;\r\n                background: ${colorType.grey1};\r\n                width: 5px;\r\n                height: 100%;\r\n                position: absolute;\r\n                top: 0;\r\n                z-index: 1;\r\n                /* prevents from scrolling while dragging on touch devices */\r\n                touch-action :none;\r\n                &.isResizing {\r\n                    background: ${colorType.grey2};\r\n                }\r\n            }\r\n        }\r\n\r\n        .th {\r\n            padding: 0.4rem;\r\n        }\r\n\r\n        \r\n    }\r\n`;\r\n\r\n\r\n\r\nconst IconTable = ({ type, color }) => {\r\n    return (\r\n        <IconStyle color={color || colorType.black} type={type} />\r\n    );\r\n};\r\n\r\nconst IconStyle = styled(Icon)`\r\n   font-size: 16px;\r\n   margin-right: 5px;\r\n   color: ${props => props.color};\r\n   padding: 2px;\r\n   border-radius: 3px;\r\n   border: 0.5px solid ${colorType.grey4};\r\n   :hover {\r\n      background: ${colorType.grey4}\r\n   }\r\n`;\r\n\r\n\r\n\r\n\r\n\r\n","D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartPieDrawing.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartProgress.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_FormPivot.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartBarDrawingLate.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\_ChartBarStack.jsx",[],"D:\\994 WOH HUP 2020\\Projects\\wh-spreadsheet-mern-rbt\\wh-spreadsheet-client\\src\\_dashboardComp\\componentsDashboard\\ChartBarStack.jsx",[],{"ruleId":"314","replacedBy":"315"},{"ruleId":"316","replacedBy":"317"},{"ruleId":"318","severity":1,"message":"319","line":69,"column":7,"nodeType":"320","endLine":69,"endColumn":9,"suggestions":"321"},{"ruleId":"318","severity":1,"message":"322","line":491,"column":7,"nodeType":"320","endLine":491,"endColumn":9,"suggestions":"323"},{"ruleId":"324","severity":1,"message":"325","line":504,"column":10,"nodeType":"326","messageId":"327","endLine":504,"endColumn":24},{"ruleId":"324","severity":1,"message":"328","line":523,"column":28,"nodeType":"326","messageId":"327","endLine":523,"endColumn":46},{"ruleId":"329","severity":1,"message":"330","line":972,"column":33,"nodeType":"331","messageId":"332","endLine":972,"endColumn":35},{"ruleId":"333","severity":1,"message":"334","line":4,"column":1,"nodeType":"335","endLine":23,"endColumn":3},{"ruleId":"324","severity":1,"message":"336","line":36,"column":29,"nodeType":"326","messageId":"327","endLine":36,"endColumn":41},{"ruleId":"318","severity":1,"message":"337","line":46,"column":7,"nodeType":"320","endLine":46,"endColumn":9,"suggestions":"338"},{"ruleId":"324","severity":1,"message":"339","line":325,"column":10,"nodeType":"326","messageId":"327","endLine":325,"endColumn":17},{"ruleId":"324","severity":1,"message":"340","line":329,"column":10,"nodeType":"326","messageId":"327","endLine":329,"endColumn":40},{"ruleId":"324","severity":1,"message":"341","line":341,"column":27,"nodeType":"326","messageId":"327","endLine":341,"endColumn":45},{"ruleId":"342","severity":1,"message":"343","line":707,"column":31,"nodeType":"344","messageId":"345","endLine":707,"endColumn":33},{"ruleId":"324","severity":1,"message":"346","line":726,"column":5,"nodeType":"326","messageId":"327","endLine":726,"endColumn":21},{"ruleId":"324","severity":1,"message":"347","line":785,"column":5,"nodeType":"326","messageId":"327","endLine":785,"endColumn":22},{"ruleId":"348","severity":1,"message":"349","line":822,"column":10,"nodeType":"331","messageId":"350","endLine":822,"endColumn":59},{"ruleId":"342","severity":1,"message":"343","line":822,"column":39,"nodeType":"344","messageId":"345","endLine":822,"endColumn":41},{"ruleId":"348","severity":1,"message":"349","line":849,"column":10,"nodeType":"331","messageId":"350","endLine":849,"endColumn":59},{"ruleId":"342","severity":1,"message":"343","line":849,"column":39,"nodeType":"344","messageId":"345","endLine":849,"endColumn":41},{"ruleId":"342","severity":1,"message":"351","line":861,"column":47,"nodeType":"344","messageId":"345","endLine":861,"endColumn":49},{"ruleId":"348","severity":1,"message":"349","line":883,"column":10,"nodeType":"331","messageId":"350","endLine":883,"endColumn":59},{"ruleId":"342","severity":1,"message":"343","line":883,"column":39,"nodeType":"344","messageId":"345","endLine":883,"endColumn":41},{"ruleId":"348","severity":1,"message":"349","line":913,"column":10,"nodeType":"331","messageId":"350","endLine":913,"endColumn":59},{"ruleId":"342","severity":1,"message":"343","line":913,"column":39,"nodeType":"344","messageId":"345","endLine":913,"endColumn":41},{"ruleId":"342","severity":1,"message":"351","line":927,"column":47,"nodeType":"344","messageId":"345","endLine":927,"endColumn":49},{"ruleId":"324","severity":1,"message":"352","line":6,"column":13,"nodeType":"326","messageId":"327","endLine":6,"endColumn":22},{"ruleId":"324","severity":1,"message":"353","line":6,"column":32,"nodeType":"326","messageId":"327","endLine":6,"endColumn":39},{"ruleId":"324","severity":1,"message":"354","line":6,"column":41,"nodeType":"326","messageId":"327","endLine":6,"endColumn":52},{"ruleId":"324","severity":1,"message":"355","line":6,"column":54,"nodeType":"326","messageId":"327","endLine":6,"endColumn":77},{"ruleId":"324","severity":1,"message":"356","line":6,"column":79,"nodeType":"326","messageId":"327","endLine":6,"endColumn":90},{"ruleId":"324","severity":1,"message":"357","line":6,"column":92,"nodeType":"326","messageId":"327","endLine":6,"endColumn":101},{"ruleId":"324","severity":1,"message":"358","line":16,"column":9,"nodeType":"326","messageId":"327","endLine":16,"endColumn":25},{"ruleId":"324","severity":1,"message":"359","line":44,"column":23,"nodeType":"326","messageId":"327","endLine":44,"endColumn":35},{"ruleId":"318","severity":1,"message":"360","line":61,"column":8,"nodeType":"320","endLine":61,"endColumn":30,"suggestions":"361"},{"ruleId":"324","severity":1,"message":"362","line":332,"column":7,"nodeType":"326","messageId":"327","endLine":332,"endColumn":20},{"ruleId":"324","severity":1,"message":"363","line":368,"column":7,"nodeType":"326","messageId":"327","endLine":368,"endColumn":21},{"ruleId":"324","severity":1,"message":"364","line":377,"column":7,"nodeType":"326","messageId":"327","endLine":377,"endColumn":36},{"ruleId":"342","severity":1,"message":"343","line":102,"column":33,"nodeType":"344","messageId":"345","endLine":102,"endColumn":35},{"ruleId":"342","severity":1,"message":"343","line":128,"column":19,"nodeType":"344","messageId":"345","endLine":128,"endColumn":21},{"ruleId":"324","severity":1,"message":"365","line":151,"column":7,"nodeType":"326","messageId":"327","endLine":151,"endColumn":17},{"ruleId":"324","severity":1,"message":"366","line":230,"column":7,"nodeType":"326","messageId":"327","endLine":230,"endColumn":20},{"ruleId":"324","severity":1,"message":"367","line":235,"column":7,"nodeType":"326","messageId":"327","endLine":235,"endColumn":19},{"ruleId":"342","severity":1,"message":"343","line":273,"column":26,"nodeType":"344","messageId":"345","endLine":273,"endColumn":28},{"ruleId":"342","severity":1,"message":"343","line":275,"column":26,"nodeType":"344","messageId":"345","endLine":275,"endColumn":28},{"ruleId":"348","severity":1,"message":"368","line":314,"column":33,"nodeType":"331","messageId":"350","endLine":314,"endColumn":88},{"ruleId":"342","severity":1,"message":"343","line":314,"column":62,"nodeType":"344","messageId":"345","endLine":314,"endColumn":64},{"ruleId":"348","severity":1,"message":"369","line":325,"column":25,"nodeType":"331","messageId":"350","endLine":325,"endColumn":80},{"ruleId":"342","severity":1,"message":"343","line":325,"column":54,"nodeType":"344","messageId":"345","endLine":325,"endColumn":56},{"ruleId":"348","severity":1,"message":"349","line":336,"column":17,"nodeType":"331","messageId":"350","endLine":336,"endColumn":66},{"ruleId":"342","severity":1,"message":"343","line":336,"column":46,"nodeType":"344","messageId":"345","endLine":336,"endColumn":48},{"ruleId":"324","severity":1,"message":"370","line":683,"column":7,"nodeType":"326","messageId":"327","endLine":683,"endColumn":23},{"ruleId":"324","severity":1,"message":"371","line":708,"column":7,"nodeType":"326","messageId":"327","endLine":708,"endColumn":29},{"ruleId":"324","severity":1,"message":"372","line":738,"column":7,"nodeType":"326","messageId":"327","endLine":738,"endColumn":28},{"ruleId":"348","severity":1,"message":"349","line":780,"column":45,"nodeType":"331","messageId":"350","endLine":780,"endColumn":92},{"ruleId":"342","severity":1,"message":"343","line":780,"column":72,"nodeType":"344","messageId":"345","endLine":780,"endColumn":74},{"ruleId":"324","severity":1,"message":"373","line":5,"column":9,"nodeType":"326","messageId":"327","endLine":5,"endColumn":14},{"ruleId":"324","severity":1,"message":"374","line":5,"column":16,"nodeType":"326","messageId":"327","endLine":5,"endColumn":22},{"ruleId":"318","severity":1,"message":"375","line":83,"column":8,"nodeType":"320","endLine":83,"endColumn":10,"suggestions":"376"},{"ruleId":"324","severity":1,"message":"377","line":20,"column":16,"nodeType":"326","messageId":"327","endLine":20,"endColumn":24},{"ruleId":"318","severity":1,"message":"378","line":43,"column":8,"nodeType":"320","endLine":43,"endColumn":10,"suggestions":"379"},{"ruleId":"318","severity":1,"message":"380","line":121,"column":8,"nodeType":"320","endLine":121,"endColumn":10,"suggestions":"381"},{"ruleId":"324","severity":1,"message":"382","line":241,"column":7,"nodeType":"326","messageId":"327","endLine":241,"endColumn":21},{"ruleId":"324","severity":1,"message":"383","line":247,"column":7,"nodeType":"326","messageId":"327","endLine":247,"endColumn":21},{"ruleId":"384","severity":1,"message":"385","line":25,"column":17,"nodeType":"386","messageId":"345","endLine":25,"endColumn":23},{"ruleId":"324","severity":1,"message":"387","line":99,"column":10,"nodeType":"326","messageId":"327","endLine":99,"endColumn":17},{"ruleId":"324","severity":1,"message":"388","line":279,"column":7,"nodeType":"326","messageId":"327","endLine":279,"endColumn":16},{"ruleId":"324","severity":1,"message":"389","line":329,"column":7,"nodeType":"326","messageId":"327","endLine":329,"endColumn":14},{"ruleId":"390","severity":1,"message":"391","line":335,"column":44,"nodeType":"344","messageId":"392","endLine":335,"endColumn":45},{"ruleId":"324","severity":1,"message":"377","line":20,"column":16,"nodeType":"326","messageId":"327","endLine":20,"endColumn":24},{"ruleId":"318","severity":1,"message":"393","line":38,"column":8,"nodeType":"320","endLine":38,"endColumn":10,"suggestions":"394"},{"ruleId":"342","severity":1,"message":"343","line":70,"column":64,"nodeType":"344","messageId":"345","endLine":70,"endColumn":66},{"ruleId":"324","severity":1,"message":"395","line":11,"column":5,"nodeType":"326","messageId":"327","endLine":11,"endColumn":20},{"ruleId":"324","severity":1,"message":"396","line":60,"column":18,"nodeType":"326","messageId":"327","endLine":60,"endColumn":26},{"ruleId":"318","severity":1,"message":"397","line":112,"column":8,"nodeType":"320","endLine":112,"endColumn":10,"suggestions":"398"},{"ruleId":"399","severity":1,"message":"400","line":135,"column":25,"nodeType":"401","endLine":135,"endColumn":124},{"ruleId":"399","severity":1,"message":"400","line":136,"column":25,"nodeType":"401","endLine":136,"endColumn":99},{"ruleId":"399","severity":1,"message":"402","line":137,"column":25,"nodeType":"401","endLine":137,"endColumn":80},{"ruleId":"399","severity":1,"message":"402","line":138,"column":25,"nodeType":"401","endLine":138,"endColumn":116},{"ruleId":"399","severity":1,"message":"403","line":153,"column":37,"nodeType":"401","endLine":158,"endColumn":39},{"ruleId":"399","severity":1,"message":"404","line":162,"column":37,"nodeType":"401","endLine":166,"endColumn":39},{"ruleId":"399","severity":1,"message":"405","line":170,"column":37,"nodeType":"401","endLine":174,"endColumn":39},{"ruleId":"399","severity":1,"message":"406","line":178,"column":37,"nodeType":"401","endLine":182,"endColumn":39},{"ruleId":"399","severity":1,"message":"407","line":218,"column":21,"nodeType":"401","endLine":221,"endColumn":23},{"ruleId":"324","severity":1,"message":"408","line":281,"column":7,"nodeType":"326","messageId":"327","endLine":281,"endColumn":21},{"ruleId":"324","severity":1,"message":"409","line":10,"column":7,"nodeType":"326","messageId":"327","endLine":10,"endColumn":28},{"ruleId":"324","severity":1,"message":"410","line":252,"column":11,"nodeType":"326","messageId":"327","endLine":252,"endColumn":24},{"ruleId":"318","severity":1,"message":"411","line":315,"column":8,"nodeType":"320","endLine":315,"endColumn":10,"suggestions":"412"},{"ruleId":"318","severity":1,"message":"413","line":326,"column":8,"nodeType":"320","endLine":326,"endColumn":22,"suggestions":"414"},{"ruleId":"324","severity":1,"message":"415","line":337,"column":11,"nodeType":"326","messageId":"327","endLine":337,"endColumn":24},"no-native-reassign",["416"],"no-negated-in-lhs",["417"],"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'EventKeyDown'. Either include it or remove the dependency array.","ArrayExpression",["418"],"React Hook useEffect has missing dependencies: 'email', 'fetchDataOneSheet', 'getSheetRows', 'projectId', 'projectName', 'role', and 'setUserData'. Either include them or remove the dependency array.",["419"],"no-unused-vars","'askBeforeClose' is assigned a value but never used.","Identifier","unusedVar","'setExpandColumnKey' is assigned a value but never used.","array-callback-return","Array.prototype.map() expects a value to be returned at the end of arrow function.","ArrowFunctionExpression","expectedAtEnd","import/no-anonymous-default-export","Assign arrow function to a variable before exporting as module default","ExportDefaultDeclaration","'getSheetRows' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'panelSettingType' and 'saveDataToServer'. Either include them or remove the dependency array.",["420"],"'rowsAll' is assigned a value but never used.","'rowsAllInitToCompareBeforeSave' is assigned a value but never used.","'userSettingsFromDB' is assigned a value but never used.","eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","'exampleInputRows' is assigned a value but never used.","'ttttttttttttttttt' is assigned a value but never used.","no-loop-func","Function declared in a loop contains unsafe references to variable(s) 'preRow'.","unsafeRefs","Expected '!==' and instead saw '!='.","'className' is assigned a value but never used.","'columns' is assigned a value but never used.","'columnIndex' is assigned a value but never used.","'onMouseDownColumnHeader' is assigned a value but never used.","'headerIndex' is assigned a value but never used.","'container' is assigned a value but never used.","'onRightClickCell' is assigned a value but never used.","'setInitValue' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'column.key', 'columnIndex', 'inputRender', 'rowIndex', 'showDrawingsOnly', and 'stateProject.allDataOneSheet.role'. Either include them or remove the dependency array.",["421"],"'colorizedRows' is assigned a value but never used.","'cellBackground' is assigned a value but never used.","'checkIfCellsRangeContainsCell' is assigned a value but never used.","'returnDate' is assigned a value but never used.","'getRndInteger' is assigned a value but never used.","'findHeaderId' is assigned a value but never used.","Function declared in a loop contains unsafe references to variable(s) 'preSubRowLv2'.","Function declared in a loop contains unsafe references to variable(s) 'preSubRowLv1'.","'getParentIdHandy' is assigned a value but never used.","'returnPreRowNullSumang' is assigned a value but never used.","'returnPreRowNullHandy' is assigned a value but never used.","'Group' is assigned a value but never used.","'Button' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'headers', 'rowData', 'stateProject.allDataOneSheet._id', and 'stateRow.rowsVersionsToSave'. Either include them or remove the dependency array.",["422"],"'stateRow' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'headerKey', 'projectId', and 'rowData.id'. Either include them or remove the dependency array.",["423"],"React Hook useEffect has missing dependencies: 'activityRecorded', 'dwgName', 'dwgNumber', 'headers', 'projectId', 'revKey', 'stateRow.rowsAll', and 'statusKey'. Either include them or remove the dependency array.",["424"],"'getHeadersText' is assigned a value but never used.","'getDrawingName' is assigned a value but never used.","no-dupe-keys","Duplicate key 'border'.","ObjectExpression","'fileAdd' is assigned a value but never used.","'InputComp' is assigned a value but never used.","'addZero' is assigned a value but never used.","no-useless-concat","Unexpected string concatenation of literals.","unexpectedConcat","React Hook useEffect has a missing dependency: 'projectId'. Either include it or remove the dependency array.",["425"],"'drawingTypeData' is assigned a value but never used.","'setInput' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'projectsArray'. Either include it or remove the dependency array. If 'setDataDB' needs the current value of 'projectsArray', you can also switch to useReducer instead of useState and read 'projectsArray' in the reducer.",["426"],"react/jsx-pascal-case","Imported JSX component _ChartBarDrawingLate must be in PascalCase or SCREAMING_SNAKE_CASE","JSXOpeningElement","Imported JSX component _ChartBarStack must be in PascalCase or SCREAMING_SNAKE_CASE","Imported JSX component _ChartProgress must be in PascalCase or SCREAMING_SNAKE_CASE","Imported JSX component _ChartPieDrawing must be in PascalCase or SCREAMING_SNAKE_CASE","Imported JSX component _ChartBarDrawing must be in PascalCase or SCREAMING_SNAKE_CASE","Imported JSX component _FormPivot must be in PascalCase or SCREAMING_SNAKE_CASE","Imported JSX component _TableDrawingList must be in PascalCase or SCREAMING_SNAKE_CASE","'getColumnWidth' is assigned a value but never used.","'getSubDrawingByStatus' is assigned a value but never used.","'scrollBarSize' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'columnsHeaderSorted' and 'toggleGroupBy'. Either include them or remove the dependency array.",["427"],"React Hook useEffect has missing dependencies: 'expanded', 'maxRowExpand', and 'toggleExpanded'. Either include them or remove the dependency array.",["428"],"'panelFunction' is assigned a value but never used.","no-global-assign","no-unsafe-negation",{"desc":"429","fix":"430"},{"desc":"431","fix":"432"},{"desc":"433","fix":"434"},{"desc":"435","fix":"436"},{"desc":"437","fix":"438"},{"desc":"439","fix":"440"},{"desc":"441","fix":"442"},{"desc":"443","fix":"444"},{"desc":"445","fix":"446"},{"desc":"447","fix":"448"},{"desc":"449","fix":"450"},"Update the dependencies array to be: [EventKeyDown]",{"range":"451","text":"452"},"Update the dependencies array to be: [email, fetchDataOneSheet, getSheetRows, projectId, projectName, role, setUserData]",{"range":"453","text":"454"},"Update the dependencies array to be: [panelSettingType, saveDataToServer]",{"range":"455","text":"456"},"Update the dependencies array to be: [column.key, columnIndex, inputRender, rowIndex, showDrawingsOnly, stateCell.cellActive, stateProject.allDataOneSheet.role]",{"range":"457","text":"458"},"Update the dependencies array to be: [headers, rowData, stateProject.allDataOneSheet._id, stateRow.rowsVersionsToSave]",{"range":"459","text":"460"},"Update the dependencies array to be: [headerKey, projectId, rowData.id]",{"range":"461","text":"462"},"Update the dependencies array to be: [activityRecorded, dwgName, dwgNumber, headers, projectId, revKey, stateRow.rowsAll, statusKey]",{"range":"463","text":"464"},"Update the dependencies array to be: [projectId]",{"range":"465","text":"466"},"Update the dependencies array to be: [projectsArray]",{"range":"467","text":"468"},"Update the dependencies array to be: [columnsHeaderSorted, toggleGroupBy]",{"range":"469","text":"470"},"Update the dependencies array to be: [expanded, expandedRows, maxRowExpand, toggleExpanded]",{"range":"471","text":"472"},[2336,2338],"[EventKeyDown]",[18761,18763],"[email, fetchDataOneSheet, getSheetRows, projectId, projectName, role, setUserData]",[1922,1924],"[panelSettingType, saveDataToServer]",[2168,2190],"[column.key, columnIndex, inputRender, rowIndex, showDrawingsOnly, stateCell.cellActive, stateProject.allDataOneSheet.role]",[2878,2880],"[headers, rowData, stateProject.allDataOneSheet._id, stateRow.rowsVersionsToSave]",[1246,1248],"[headerKey, projectId, rowData.id]",[4887,4889],"[activityRecorded, dwgName, dwgNumber, headers, projectId, revKey, stateRow.rowsAll, statusKey]",[1136,1138],"[projectId]",[3931,3933],"[projectsArray]",[9246,9248],"[columnsHeaderSorted, toggleGroupBy]",[9584,9598],"[expanded, expandedRows, maxRowExpand, toggleExpanded]"]